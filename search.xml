<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Kè¿‘é‚»ç®—æ³•</title>
    <url>/posts/1516846897/</url>
    <content><![CDATA[<p>ä»‹ç»Kè¿‘é‚»ç®—æ³•åŸºæœ¬åŸç†</p>
<span id="more"></span>
<h1 id="Kè¿‘é‚»ç®—æ³•"><a href="#Kè¿‘é‚»ç®—æ³•" class="headerlink" title="Kè¿‘é‚»ç®—æ³•"></a>Kè¿‘é‚»ç®—æ³•</h1><h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯kè¿‘é‚»ç®—æ³•"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯kè¿‘é‚»ç®—æ³•" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯kè¿‘é‚»ç®—æ³•"></a>ä¸€ã€ä»€ä¹ˆæ˜¯kè¿‘é‚»ç®—æ³•</h2><p>ç»™å®šä¸€ä¸ªè®­ç»ƒæ•°æ®é›†ã€å¯¹æ–°çš„è¾“å…¥å®ä¾‹ï¼Œåœ¨è®­ç»ƒé›†ä¸­æ‰¾åˆ°ä¸è¯¥å®ä¾‹<strong>æœ€é‚»è¿‘</strong>çš„kä¸ªå®ä¾‹ï¼Œ<strong>è¿™kä¸ª</strong>å®ä¾‹çš„å¤šæ•°å±äºæŸä¸ªç±»ï¼Œå°±æŠŠè¯¥è¾“å…¥å®ä¾‹åˆ†ä¸ºè¿™ä¸ªç±»ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šè¾“å…¥æ–°çš„â“ç‚¹åˆ¤æ–­å®ƒå±äºclassAè¿˜æ˜¯classB</p>
<img data-src="https://s2.loli.net/2023/06/05/3AXmkiRC6U9JyhV.png" alt="202306051337912" style="zoom:100%;">

<p>é‚£ä¹ˆé—®é¢˜æ¥äº†kè¿‘é‚»ç®—æ³•å¸‚<strong>æœ€è¿‘é‚»</strong>ï¼Œé‚£ä¹ˆè¿™ä¸ªæœ€è¿‘é‚»æ€ä¹ˆåˆ¤æ–­ï¼Ÿè®¡ç®—è·ç¦»ï¼æ€ä¹ˆè®¡ç®—è·ç¦»</p>
<h2 id="äºŒã€è·ç¦»åº¦é‡"><a href="#äºŒã€è·ç¦»åº¦é‡" class="headerlink" title="äºŒã€è·ç¦»åº¦é‡"></a>äºŒã€è·ç¦»åº¦é‡</h2><h3 id="1ã€æ¬§å‡ é‡Œå¾—è·ç¦»"><a href="#1ã€æ¬§å‡ é‡Œå¾—è·ç¦»" class="headerlink" title="1ã€æ¬§å‡ é‡Œå¾—è·ç¦»"></a>1ã€æ¬§å‡ é‡Œå¾—è·ç¦»</h3><p>$$</p>
<p>d(x,y)&#x3D;\sqrt{\displaystyle\sum_{i&#x3D;1}^{n}(y_i-x_i)^2}</p>
<p>$$</p>
<h3 id="3ã€æ›¼å“ˆé¡¿è·ç¦»"><a href="#3ã€æ›¼å“ˆé¡¿è·ç¦»" class="headerlink" title="3ã€æ›¼å“ˆé¡¿è·ç¦»"></a>3ã€æ›¼å“ˆé¡¿è·ç¦»</h3><p>$$</p>
<p>d(x,y)&#x3D;(\displaystyle\sum_{i&#x3D;0}^{n}{|y_i-x_i|})</p>
<p>$$</p>
<h3 id="4ã€é—µå¯å¤«æ–¯åŸºè·ç¦»"><a href="#4ã€é—µå¯å¤«æ–¯åŸºè·ç¦»" class="headerlink" title="4ã€é—µå¯å¤«æ–¯åŸºè·ç¦»"></a>4ã€é—µå¯å¤«æ–¯åŸºè·ç¦»</h3><p>$$<br>Minkowski Distance&#x3D;(\displaystyle\sum_{i&#x3D;0}^{n}{|y_i-x_i|})^\frac{1}{p}<br>$$</p>
<p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•ç¡®å®šè·ç¦»ï¼Œä½†æ˜¯é—®é¢˜åˆæ¥äº†ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆå»å®šä¹‰æˆ‘ä»¬çš„Kå€¼å‘¢ï¼Ÿ</p>
<h2 id="ä¸‰ã€Kå€¼é€‰æ‹©"><a href="#ä¸‰ã€Kå€¼é€‰æ‹©" class="headerlink" title="ä¸‰ã€Kå€¼é€‰æ‹©"></a>ä¸‰ã€Kå€¼é€‰æ‹©</h2><p>å¦‚æœé€‰æ‹©è¾ƒå°çš„ k å€¼ï¼Œå°±ç›¸å½“äºç”¨è¾ƒå°çš„é‚»åŸŸä¸­çš„è®­ç»ƒå®ä¾‹è¿›è¡Œé¢„æµ‹ï¼Œâ€œå­¦ä¹ â€çš„è¿‘ä¼¼è¯¯å·®(approximation error)ä¼šå‡å°ï¼Œåªæœ‰ä¸è¾“å…¥å®ä¾‹è¾ƒè¿‘çš„(ç›¸ä¼¼çš„)è®­ç»ƒå®ä¾‹æ‰ä¼šå¯¹é¢„æµ‹ç»“æœèµ·ä½œç”¨ã€‚ä½†ç¼ºç‚¹æ˜¯â€œå­¦ä¹ â€çš„ä¼°è®¡è¯¯å·®(estimation error)ä¼šå¢å¤§ï¼Œé¢„æµ‹ç»“æœä¼šå¯¹è¿‘é‚»çš„å®ä¾‹ç‚¹éå¸¸æ•æ„Ÿ ã€‚å¦‚æœé‚»è¿‘çš„å®ä¾‹ç‚¹æ°å·§æ˜¯å™ªå£°ï¼Œé¢„æµ‹å°±ä¼šå‡ºé”™ã€‚æ¢å¥è¯è¯´ï¼Œk å€¼çš„å‡å°å°±æ„å‘³ç€æ•´ä½“æ¨¡å‹å˜å¾—å¤æ‚ï¼Œå®¹æ˜“å‘ç”Ÿè¿‡æ‹Ÿåˆã€‚</p>
<p>å¦‚æœé€‰æ‹©è¾ƒå¤§çš„ k å€¼ï¼Œå°±ç›¸å½“äºç”¨è¾ƒå¤§é‚»åŸŸä¸­çš„è®­ç»ƒå®ä¾‹è¿›è¡Œé¢„æµ‹ã€‚å…¶ä¼˜ç‚¹æ˜¯å¯ä»¥å‡å°‘å­¦ä¹ çš„ä¼°è®¡è¯¯å·®ï¼Œä½†ç¼ºç‚¹æ˜¯å­¦ä¹ çš„è¿‘ä¼¼è¯¯å·®ä¼šå¢å¤§ã€‚è¿™æ—¶ä¸è¾“å…¥å®ä¾‹è¾ƒè¿œçš„(ä¸ç›¸ä¼¼çš„)è®­ç»ƒå®ä¾‹ä¹Ÿä¼šå¯¹é¢„æµ‹èµ·ä½œç”¨ï¼Œä½¿é¢„æµ‹å‘ç”Ÿé”™è¯¯ã€‚k å€¼çš„å¢å¤§å°±æ„å‘³ç€æ•´ä½“çš„æ¨¡å‹å˜å¾—ç®€å•ã€‚</p>
<p>å¦‚æœk &#x3D;Nï¼Œé‚£ä¹ˆæ— è®ºè¾“å…¥å®ä¾‹æ˜¯ä»€ä¹ˆï¼Œéƒ½å°†ç®€å•åœ°é¢„æµ‹å®ƒå±äºåœ¨è®­ç»ƒå®ä¾‹ä¸­æœ€å¤šçš„ç±»ã€‚è¿™æ—¶ï¼Œæ¨¡å‹è¿‡äºç®€å•ï¼Œå®Œå…¨å¿½ç•¥è®­ç»ƒå®ä¾‹ä¸­çš„å¤§é‡æœ‰ç”¨ä¿¡æ¯ï¼Œæ˜¯ä¸å¯å–çš„ã€‚åœ¨åº”ç”¨ä¸­ï¼Œk å€¼ä¸€èˆ¬å–ä¸€ä¸ªæ¯”è¾ƒå°çš„æ•°å€¼ã€‚é€šå¸¸é‡‡ç”¨<strong>äº¤å‰éªŒè¯æ³•</strong>æ¥é€‰å–æœ€ä¼˜çš„kå€¼ã€‚</p>
<h2 id="å››ã€ç®—æ³•æµç¨‹-python"><a href="#å››ã€ç®—æ³•æµç¨‹-python" class="headerlink" title="å››ã€ç®—æ³•æµç¨‹(python)"></a>å››ã€ç®—æ³•æµç¨‹(python)</h2><p>ç¬¬ä¸€æ­¥ï¼šç¡®å®šKNNç®—æ³•éœ€è¦ç¡®å®šçš„å‚æ•°ï¼š1ã€è¾“å…¥çš„å¾…åˆ†ç±»å˜é‡(è®­ç»ƒé›†)ï¼›2ã€kå€¼ï¼›3ã€è®¡ç®—è·ç¦»çš„æ–¹æ³•ï¼›4ã€è®­ç»ƒé›†æ•°æ®ï¼›4ã€è®­ç»ƒé›†æ ‡ç­¾<br>ç¬¬äºŒæ­¥ï¼šè®¡ç®—è·ç¦»ï¼ŒKNNç®—æ³•çš„æ ¸å¿ƒå°±æ˜¯è®¡ç®—ä¸æ¯ä¸€ä¸ªå˜é‡çš„è·ç¦»ï¼Œè€ŒåæŒ‘é€‰å‰Kä¸ªã€‚<strong>æ‰€ä»¥æˆ‘ä»¬æœ‰æ—¶å€™éœ€è¦å¯¹è¾“å…¥æ•°æ®ç»´åº¦æ‹“å±•ï¼Œä½¿å…¶è¾¾åˆ°å’Œæµ‹è¯•é›†å½¢çŠ¶ç›¸åŒã€‚</strong><br>ç¬¬ä¸‰æ­¥ï¼šåˆ¤æ–­KNNçš„å‡†ç¡®ç‡</p>
<h2 id="äº”ã€KNNè¯„ä»·"><a href="#äº”ã€KNNè¯„ä»·" class="headerlink" title="äº”ã€KNNè¯„ä»·"></a>äº”ã€KNNè¯„ä»·</h2><p><strong>ä¼˜åŠ¿</strong><br>æ˜“äºå®ç°ï¼šé‰´äºç®—æ³•çš„ç®€å•æ€§å’Œå‡†ç¡®æ€§ï¼Œå®ƒæ˜¯æ–°æ•°æ®ç§‘å­¦å®¶å°†å­¦ä¹ çš„é¦–æ‰¹åˆ†ç±»å™¨ä¹‹ä¸€<br>è½»æ¾é€‚åº”ï¼šéšç€æ–°è®­ç»ƒæ ·æœ¬çš„å¢åŠ ï¼Œç®—æ³•ä¼šæ ¹æ®ä»»ä½•æ–°æ•°æ®è¿›è¡Œè°ƒæ•´ï¼Œå› ä¸ºæ‰€æœ‰è®­ç»ƒæ•°æ®éƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­<br>å¾ˆå°‘çš„è¶…å‚æ•°ï¼šKNN åªéœ€è¦ kå€¼å’Œè·ç¦»åº¦é‡ï¼Œä¸å…¶ä»–æœºå™¨å­¦ä¹ ç®—æ³•ç›¸æ¯”ï¼Œæ‰€éœ€çš„è¶…å‚æ•°å¾ˆå°‘<br><strong>ç¼ºç‚¹</strong><br>ä¸èƒ½å¾ˆå¥½åœ°æ‰©å±•ï¼šç”±äº KNN æ˜¯ä¸€ç§æƒ°æ€§ç®—æ³•ï¼Œå› æ­¤ä¸å…¶ä»–åˆ†ç±»å™¨ç›¸æ¯”ï¼Œå®ƒå ç”¨äº†æ›´å¤šçš„å†…å­˜å’Œæ•°æ®å­˜å‚¨ã€‚ ä»æ—¶é—´å’Œé‡‘é’±çš„è§’åº¦æ¥çœ‹ï¼Œè¿™å¯èƒ½æ˜¯æ˜‚è´µçš„ã€‚ æ›´å¤šçš„å†…å­˜å’Œå­˜å‚¨å°†å¢åŠ ä¸šåŠ¡å¼€æ”¯ï¼Œè€Œæ›´å¤šçš„æ•°æ®å¯èƒ½éœ€è¦æ›´é•¿çš„æ—¶é—´æ¥è®¡ç®—ã€‚ è™½ç„¶å·²ç»åˆ›å»ºäº†ä¸åŒçš„æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚ Ball-Treeï¼‰æ¥è§£å†³è®¡ç®—æ•ˆç‡ä½ä¸‹çš„é—®é¢˜ï¼Œä½†åˆ†ç±»å™¨æ˜¯å¦ç†æƒ³å¯èƒ½å–å†³äºä¸šåŠ¡é—®é¢˜<br>ç»´åº¦çš„è¯…å’’ï¼šKNN ç®—æ³•å®¹æ˜“æˆä¸ºç»´åº¦è¯…å’’çš„å—å®³è€…ï¼Œè¿™æ„å‘³ç€å®ƒåœ¨é«˜ç»´æ•°æ®è¾“å…¥æ—¶è¡¨ç°ä¸ä½³ã€‚ è¿™æœ‰æ—¶ä¹Ÿç§°ä¸ºå³°å€¼ç°è±¡ï¼Œåœ¨ç®—æ³•è¾¾åˆ°æœ€ä½³ç‰¹å¾æ•°é‡åï¼Œé¢å¤–çš„ç‰¹å¾ä¼šå¢åŠ åˆ†ç±»é”™è¯¯çš„æ•°é‡ï¼Œå°¤å…¶æ˜¯å½“æ ·æœ¬å°ºå¯¸è¾ƒå°æ—¶<br>å®¹æ˜“è¿‡æ‹Ÿåˆï¼šç”±äºâ€ç»´åº¦çš„è¯…å’’â€ï¼ŒKNN ä¹Ÿæ›´å®¹æ˜“è¿‡æ‹Ÿåˆã€‚ è™½ç„¶åˆ©ç”¨ç‰¹å¾é€‰æ‹©å’Œé™ç»´æŠ€æœ¯æ¥é˜²æ­¢è¿™ç§æƒ…å†µå‘ç”Ÿ</p>
<h2 id="å…­ã€pythonä»£ç å®ç°-æ‰‹å†™å­—ä½“è¯†åˆ«"><a href="#å…­ã€pythonä»£ç å®ç°-æ‰‹å†™å­—ä½“è¯†åˆ«" class="headerlink" title="å…­ã€pythonä»£ç å®ç°(æ‰‹å†™å­—ä½“è¯†åˆ«)"></a>å…­ã€pythonä»£ç å®ç°(æ‰‹å†™å­—ä½“è¯†åˆ«)</h2><p>éœ€è¦è°ƒç”¨çš„åŒ…(å¯ä»¥å°è¯•åˆ©ç”¨pytorchå»æé«˜è®¡ç®—é€Ÿåº¦ã€åŸç†ä¹Ÿå¾ˆç®€å•pytorchå¯ä»¥å’Œnumpyå‡ ä¹æ— ç¼è¡”æ¥)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> operator</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> listdir</span><br></pre></td></tr></table></figure>
<p>æ ¸å¿ƒä»£ç </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">KNN</span>(<span class="params">inx,dataset,labels,k,distances_way</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    inx:è¾“å…¥éœ€è¦åˆ†ç±»çš„æ•°å­—</span></span><br><span class="line"><span class="string">    datset:è¾“å…¥æ ·æœ¬è®­ç»ƒé›†</span></span><br><span class="line"><span class="string">    labels:æ ‡ç­¾å‘é‡</span></span><br><span class="line"><span class="string">    k:é€‰æ‹©æœ€è¿‘é‚»çš„æ•°ç›®,å…¶ä¸­æ ‡ç­¾æ•°é‡å’ŒçŸ©é˜µdatasetçš„è¡Œæ•°ç›¸åŒ</span></span><br><span class="line"><span class="string">    distance:è®¡ç®—è·ç¦»çš„æ–¹å¼</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment">#è®¡ç®—è·ç¦»</span></span><br><span class="line">    datasize_h = dataset.shape[<span class="number">0</span>]</span><br><span class="line">    inx = np.tile(inx,(datasize_h,<span class="number">1</span>)) <span class="comment">#å°†inxç»´åº¦æ‹“å±•æˆå’Œdatasetå½¢çŠ¶ç›¸åŒçš„çš„çŸ©é˜µ</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> distances_way == <span class="built_in">str</span>(<span class="string">&#x27;o&#x27;</span>):<span class="comment">#æ¬§å‡ é‡Œå¾—è·ç¦»</span></span><br><span class="line">        diffmat = inx - dataset</span><br><span class="line">        sq_diffmat = diffmat**<span class="number">2</span></span><br><span class="line">        sq_distances = sq_diffmat.<span class="built_in">sum</span>(axis=<span class="number">1</span>)</span><br><span class="line">        distance = sq_distances**<span class="number">0.5</span></span><br><span class="line">    <span class="keyword">elif</span> distances_way == <span class="built_in">str</span>(<span class="string">&#x27;man&#x27;</span>):<span class="comment">#æ›¼å“ˆé¡¿è·ç¦»</span></span><br><span class="line">        diffmat =  inx - dataset</span><br><span class="line">        abs_diffmat = <span class="built_in">abs</span>(diffmat)</span><br><span class="line">        distance = abs_diffmat.<span class="built_in">sum</span>(axis=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">elif</span> distances_way == <span class="built_in">str</span>(<span class="string">&#x27;min&#x27;</span>):<span class="comment">#é—µå¯å¤«æ–¯åŸºè·ç¦»</span></span><br><span class="line">        p = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;è¾“å…¥på€¼:&#x27;</span>))</span><br><span class="line">        diffmat = inx - dataset</span><br><span class="line">        sq_diffmat = diffmat**<span class="number">2</span></span><br><span class="line">        sq_distances = sq_diffmat.<span class="built_in">sum</span>(axis=<span class="number">1</span>)</span><br><span class="line">        distance = sq_distances**(<span class="number">1</span>/p)</span><br><span class="line">    distance_sort = distance.argsort() <span class="comment">#æŒ‰è·ç¦»æœ‰å°åˆ°å¤§æ’åº</span></span><br><span class="line">    <span class="comment">#return distance_sort</span></span><br><span class="line">    <span class="comment">#å°†æ’åºå¾—åˆ°çš„è·ç¦»å’Œæˆ‘ä»¬çš„æ ‡ç­¾è¿›è¡Œå¯¹åº”èµ·æ¥ï¼Œåˆ©ç”¨å“ˆå¸Œè¡¨</span></span><br><span class="line">    dic = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        diff_label = labels[distance_sort[i]]</span><br><span class="line">        dic[diff_label] = dic.get(diff_label,<span class="number">0</span>)+<span class="number">1</span></span><br><span class="line">    dic_sort = <span class="built_in">sorted</span>(dic.items(), key=operator.itemgetter(<span class="number">1</span>),reverse=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> dic_sort[<span class="number">0</span>][<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<p>æ‰‹å†™å­—ä½“è¯†åˆ«(åˆ—å­æ¥æºäºã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹è‡ªå·±åšäº†éƒ¨åˆ†æ”¹å˜)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å°†32*32åŒ–æˆ1*1024çš„çŸ©é˜µï¼Œä¹Ÿå¯ä»¥åŒ–æˆ32*32çš„çŸ©é˜µ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">data_read</span>(<span class="params">path</span>):</span><br><span class="line">    data = <span class="built_in">open</span>(path)</span><br><span class="line">    data_use = np.zeros((<span class="number">1</span>,<span class="number">1024</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        data_line = data.readline() <span class="comment">#è¯»å–æ¯ä¸€è¡Œ</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            data_use[<span class="number">0</span>,<span class="number">32</span>*i+j] = <span class="built_in">int</span>(data_line[j])</span><br><span class="line">    <span class="keyword">return</span> data_use</span><br><span class="line"></span><br><span class="line"><span class="comment">#å°†32*32çš„textæ–‡ä»¶åŒ–æˆ32*32çš„çŸ©é˜µ</span></span><br><span class="line"><span class="comment"># def data_read(path):</span></span><br><span class="line"><span class="comment">#     data = open(path)</span></span><br><span class="line"><span class="comment">#     data_use = np.zeros([32,32])</span></span><br><span class="line"><span class="comment">#     data_narry = np.array(data)</span></span><br><span class="line"><span class="comment">#     for j in range(len(a)):</span></span><br><span class="line"><span class="comment">#         for i in range(len(a)):</span></span><br><span class="line"><span class="comment">#             data_use[i][j] = a[i][j]</span></span><br><span class="line"><span class="comment">#     return data_use</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">handwritingClassTest</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    hwLabels:æ‰‹å†™æ•°å­—çœŸå®å€¼</span></span><br><span class="line"><span class="string">    m:è®­ç»ƒé›†æ–‡ä»¶ä¸ªæ•° mTset:æµ‹è¯•é›†çš„æ–‡ä»¶ä¸ªæ•°</span></span><br><span class="line"><span class="string">    trainingMat:å­˜å‚¨è®­ç»ƒé›†çš„å…¨éƒ¨ä¸€ç»´åŒ–çš„æ•°æ®</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    hwLabels = []</span><br><span class="line">    trainingFileList = listdir(<span class="string">&#x27;D:/Github-code/python-gogogo/æœºå™¨å­¦ä¹ /åˆ†ç±»é—®é¢˜/Kè¿‘é‚»ç®—æ³•/æ‰‹å†™æ•°æ®æ–‡ä»¶/training_handwriting&#x27;</span>)</span><br><span class="line">    m = <span class="built_in">len</span>(trainingFileList) <span class="comment"># m=1934</span></span><br><span class="line">    trainingMat = np.zeros((m, <span class="number">1024</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="comment"># å¯¹æ–‡ä»¶åè¿›è¡Œæ‹†åˆ† ---&gt;å¼€å§‹ åªå–æ–‡ä»¶åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦(å¯¹åº”çœŸå®æ•°å­—)</span></span><br><span class="line">        fileNameStr = trainingFileList[i] <span class="comment"># å¾—åˆ°çš„éƒ½æ˜¯æ–‡ä»¶åçš„å­—ç¬¦ä¸²</span></span><br><span class="line">        fileStr = fileNameStr.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        classNumStr = <span class="built_in">int</span>(fileStr.split(<span class="string">&#x27;_&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">        hwLabels.append(classNumStr)</span><br><span class="line">        <span class="comment"># å¯¹æ–‡ä»¶åè¿›è¡Œæ‹†åˆ† ---&gt;ç»“æŸ </span></span><br><span class="line">        trainingMat[i,:] = data_read(<span class="string">&#x27;D:/Github-code/python-gogogo/æœºå™¨å­¦ä¹ /åˆ†ç±»é—®é¢˜/Kè¿‘é‚»ç®—æ³•/æ‰‹å†™æ•°æ®æ–‡ä»¶/training_handwriting/%s&#x27;</span>% fileNameStr)</span><br><span class="line">    <span class="comment">#return trainingMat</span></span><br><span class="line"></span><br><span class="line">    testFileList = listdir(<span class="string">&#x27;D:/Github-code/python-gogogo/æœºå™¨å­¦ä¹ /åˆ†ç±»é—®é¢˜/Kè¿‘é‚»ç®—æ³•/æ‰‹å†™æ•°æ®æ–‡ä»¶/test_handwriting&#x27;</span>)</span><br><span class="line">    errorCount = <span class="number">0.0</span></span><br><span class="line">    mTest = <span class="built_in">len</span>(testFileList)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(mTest):</span><br><span class="line">        fileNameStr = testFileList[i]</span><br><span class="line">        fileStr = fileNameStr.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]     </span><br><span class="line">        classNumStr = <span class="built_in">int</span>(fileStr.split(<span class="string">&#x27;_&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        vectorUnderTest = data_read(<span class="string">&#x27;D:/Github-code/python-gogogo/æœºå™¨å­¦ä¹ /åˆ†ç±»é—®é¢˜/Kè¿‘é‚»ç®—æ³•/æ‰‹å†™æ•°æ®æ–‡ä»¶/test_handwriting/%s&#x27;</span> % fileNameStr)</span><br><span class="line">        <span class="built_in">print</span>(vectorUnderTest.shape)</span><br><span class="line">        classifierResult = KNN(vectorUnderTest, trainingMat, hwLabels, <span class="number">3</span>,<span class="string">&#x27;o&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;KNNåˆ†ç±»ç»“æœ: %d, å®é™…ç»“æœ: %d&quot;</span> % (classifierResult, classNumStr))</span><br><span class="line">        <span class="keyword">if</span> (classifierResult != classNumStr): errorCount += <span class="number">1.0</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;\né”™è¯¯æ•°å­—æ•°é‡: %d&quot;</span> % errorCount)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;\né”™è¯¯æ¯”ç‡: %f&quot;</span> % (errorCount/<span class="built_in">float</span>(mTest)))</span><br></pre></td></tr></table></figure>
<h2 id="ä¸ƒã€ä¸ªäººæ€è€ƒ"><a href="#ä¸ƒã€ä¸ªäººæ€è€ƒ" class="headerlink" title="ä¸ƒã€ä¸ªäººæ€è€ƒ"></a>ä¸ƒã€ä¸ªäººæ€è€ƒ</h2><p>æ—¢ç„¶è¿‡ç¨‹ä¸­æ¶‰åŠåˆ°äº†pytorchï¼Œå¹¶ä¸”åšçš„æ˜¯â€æ‰‹å†™å­—ä½“è¯†åˆ«â€œï¼Œé‚£ä¹ˆçš„è¯æˆ‘ä»¬ä¸å¦¨è‡ªå·±å°è¯•ä½¿ç”¨è‡ªå·±éšä¾¿æ‹ä¸€å¼ ç…§ç‰‡ï¼Œè€Œåå»è¯†åˆ«è‡ªå·±æ‰‹å†™å­—ä½“(å°†å›¾ç‰‡äºŒå€¼åŒ–ï¼Œæˆ‘æš‚æ—¶æƒ³åˆ°è¿™æ ·ï¼Œå› ä¸ºæ·±åº¦å­¦ä¹ è‡ªå·±ä¹Ÿä¸æ˜¯å¤ªè¿‡äº†äº†è§£)ï¼Œå¦‚æœåˆ©ç”¨KNNç®—æ³•å¯èƒ½æ•ˆç‡æ²¡æœ‰ä½¿ç”¨CNNç®—æ³•æ•ˆç‡é‚£ä¹ˆé«˜ï¼Œå…¶ä¸­å¯èƒ½è¿˜ä¼šæ¶‰åŠåˆ°opencvåº“çš„ä½¿ç”¨ã€‚<br>è¯„è®ºåŒºå¤§ä½¬æœ‰æƒ³æ³•ä¸å¦¨è¸¢æˆ‘å“ˆå“ˆå“ˆå“ˆå“ˆã€‚ğŸ˜€ğŸ˜€æ–‡ç« æœ‰ä»€ä¹ˆä¸è¶³æ¬¢è¿ç•™è¨€ã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><blockquote>
<p>1ã€<a href="https://www.ibm.com/cn-zh/topics/knn#:~:text=k%2D%E6%9C%80%E8%BF%91%E9%82%BB%E7%AE%97%E6%B3%95%EF%BC%8C%E4%B9%9F,%E6%9C%80%E5%B8%B8%E8%A1%A8%E7%A4%BA%E7%9A%84%E6%A0%87%E7%AD%BE%E3%80%82">https://www.ibm.com/cn-zh/topics/knn#:~:text=k%2D%E6%9C%80%E8%BF%91%E9%82%BB%E7%AE%97%E6%B3%95%EF%BC%8C%E4%B9%9F,%E6%9C%80%E5%B8%B8%E8%A1%A8%E7%A4%BA%E7%9A%84%E6%A0%87%E7%AD%BE%E3%80%82</a><br>2ã€æèˆªã€Šç»Ÿè®¡å­¦å­¦ä¹ æ–¹æ³•ç¬¬äºŒç‰ˆã€‹</p>
</blockquote>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>åˆ†ç±»ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>è‡ªåŠ¨å¤‡ä»½Hexoåšå®¢æºæ–‡ä»¶</title>
    <url>/posts/b6b5a9dd/</url>
    <content><![CDATA[<p>ç”±äºè‡ªå·±ç»å¸¸é€šè¿‡hexoæ¥å†™è‡ªå·±çš„blogé‚£ä¹ˆä¸‡ä¸€é‚£ä¸€å¤©æ ‘è“æ´¾åäº†ï¼ˆè‡ªå·±ç”¨æ ‘è“æ´¾åšæœåŠ¡å™¨ï¼‰ï¼Œé‚£ä¹ˆé‡Œé¢æ‰€æœ‰çš„ä¸œè¥¿éƒ½éœ€è¦é‡æ–°å†™é‚£å¤ªé­ç½ªäº†ï¼Œæ‰€ä»¥å»ç½‘ä¸Šæ‰¾äº†å°†hexoè¿›è¡Œå¤‡ä»½çš„æ“ä½œã€‚<br>â­ä»¥ä¸‹æ“ä½œåœ¨â±ï¸2023.6.4â±ï¸å¯ä»¥å®Œç¾å®ç°.</p>
<span id="more"></span>

<h1 id="hexoå¤‡ä»½æ“ä½œ"><a href="#hexoå¤‡ä»½æ“ä½œ" class="headerlink" title="hexoå¤‡ä»½æ“ä½œ"></a>hexoå¤‡ä»½æ“ä½œ</h1><h2 id="hexoéœ€è¦å¤‡ä»½ä»€ä¹ˆä¸œè¥¿ï¼Ÿ"><a href="#hexoéœ€è¦å¤‡ä»½ä»€ä¹ˆä¸œè¥¿ï¼Ÿ" class="headerlink" title="hexoéœ€è¦å¤‡ä»½ä»€ä¹ˆä¸œè¥¿ï¼Ÿ"></a>hexoéœ€è¦å¤‡ä»½ä»€ä¹ˆä¸œè¥¿ï¼Ÿ</h2><p>æˆ‘ä»¬åœ¨<strong>æ–°ç”µè„‘</strong>é€šè¿‡hexoé‡æ–°æ­å»ºåšå®¢çš„æ—¶å€™ï¼ˆè·³è¿‡hexoå®‰è£…ï¼‰<code>hexo init</code>é‚£ä¹ˆåœ¨ç›®æ ‡ç›®å½•ä¸‹ä¼šç”Ÿæˆä¸€éƒ¨åˆ†æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸å¯èƒ½é‡æ–°åœ¨<strong>æ–°ç”µè„‘</strong>é‡Œé¢æŠŠä¹‹å‰çš„ä¸œè¥¿åœ¨å†™ä¸€éï¼Œæ­¤æ—¶éœ€è¦å°†<strong>æ—§ç”µè„‘</strong>å†™çš„ä¸œè¥¿è¿ç§»åˆ°æ–°ç”µè„‘ã€‚æ­¤æ—¶åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š</p>
<h3 id="1ã€æ—§ç”µè„‘è¿˜æ´»ç€"><a href="#1ã€æ—§ç”µè„‘è¿˜æ´»ç€" class="headerlink" title="1ã€æ—§ç”µè„‘è¿˜æ´»ç€"></a>1ã€æ—§ç”µè„‘è¿˜æ´»ç€</h3><p>æˆ‘ä»¬åªéœ€è¦æŠŠ<strong>æ—§ç”µè„‘</strong>ä¸Šåšå®¢ç›®å½•ä¸‹çš„ <code>sourceã€themesã€_config.yml</code>è¦†ç›–åˆ° blog çš„é‚£ä¸ªæ–‡ä»¶å¤¹å³å¯ï¼Œåªè¦hexoç¯å¢ƒæ²¡é—®é¢˜ï¼Œhexoçš„ä¸€ç³»åˆ—æ“ä½œéƒ½æ²¡é—®é¢˜ï¼ˆåœ¨ç¬¬ä¸€æ¬¡ <code>hexo d</code>å¯èƒ½ä¼šæœ‰äº›æ…¢ï¼Œè€å¿ƒç­‰å¾…ï¼‰ã€‚åŒæ ·ï¼Œåœ¨æ–°ç”µè„‘ä¸Šåªè¦æŠŠç¯å¢ƒæ­å»ºå¥½ï¼Œåªè¦æŠŠä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸€ä¸ªé…ç½®æ–‡ä»¶è¦†ç›–è¿‡å»ï¼Œéƒ½æ²¡é—®é¢˜ã€‚åŒ…æ‹¬åœ¨å¤‡ä»½æ—¶ä¹Ÿåªéœ€è¦æŠŠè¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹ä¸€ä¸ªé…ç½®æ–‡ä»¶å¤‡ä»½å¥½ï¼Œå…¶ä»–çš„éƒ½ä¸ç”¨ç®¡äº†ã€‚</p>
<h3 id="2ã€æ—§ç”µè„‘æ­»äº†"><a href="#2ã€æ—§ç”µè„‘æ­»äº†" class="headerlink" title="2ã€æ—§ç”µè„‘æ­»äº†"></a>2ã€æ—§ç”µè„‘æ­»äº†</h3><p>æ­¤ç§æƒ…å†µå°±éœ€è¦æˆ‘ä»¬é‡æ–°å†™blogäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é¿å…è¿™ç§æƒ…å†µï¼ï¼ï¼æ“ä½œå¦‚ä¸‹ï¼š<br><strong>ç¬¬ä¸€æ­¥</strong>ï¼Œæˆ‘ä»¬å…ˆåœ¨githubä¸Šåˆ›å»ºä¸€ä¸ªä»“åº“ä½œä¸ºæˆ‘ä»¬çš„åšå®¢å­˜å‚¨ã€‚<br><strong>ç¬¬äºŒæ­¥</strong>ï¼Œæˆ‘ä»¬éœ€è¦åœ¨<strong>æ—§ç”µè„‘</strong>ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git init</span><br><span class="line">git remote add origin git@github.com:yourname/hexo.git</span><br><span class="line">git pull origin master</span><br></pre></td></tr></table></figure>

<p>æ­£å¦‚æˆ‘ä»¬ä¸Šé¢<strong>ç¬¬ä¸€ç§æƒ…å†µ</strong>æˆ‘ä»¬ä¸éœ€è¦å¯¹æ‰€æœ‰çš„æ–‡ä»¶è¿›è¡Œæ“ä½œï¼Œé‚£ä¹ˆçš„è¯æˆ‘ä»¬åœ¨<strong>æ ¹ç›®å½•</strong>ä¸‹æ–°å»ºæ–‡ä»¶ <code>.gitignore </code>åœ¨æ­¤æ–‡ä»¶ä¸‹è¾“å…¥æˆ‘ä»¬ä¸éœ€è¦å¤‡ä»½çš„æ–‡ä»¶ï¼Œæˆ‘çš„é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.DS_Store</span><br><span class="line">Thumbs.db</span><br><span class="line">db.json</span><br><span class="line">*.log</span><br><span class="line">node_modules/</span><br><span class="line">public/</span><br><span class="line">.deploy*/</span><br></pre></td></tr></table></figure>

<p><strong>ç¬¬ä¸‰æ­¥</strong>ï¼šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m &quot;å¤‡ä»½hexoæºç æ–‡ä»¶&quot;</span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•</strong>ï¼š<br><code>&lt;img src=&quot;https://s2.loli.net/2023/06/04/WSO4JgRDtdGmsiE.png&quot; alt=&quot;å¤‡ä»½æ“ä½œ1&quot; style=&quot;zoom:100%;&quot;/&gt;</code><br>ä¸è¿‡ï¼ï¼ï¼ï¼ä¸‡ä¸€å“ªä¸€å¤©å¿˜è®° <code>git push </code>æ€ä¹ˆåŠï¼Ÿ</p>
<h3 id="å¤‡ä»½æ–¹æ³•äºŒ"><a href="#å¤‡ä»½æ–¹æ³•äºŒ" class="headerlink" title="å¤‡ä»½æ–¹æ³•äºŒ"></a>å¤‡ä»½æ–¹æ³•äºŒ</h3><p>æˆ‘ä»¬éœ€è¦è‡ªåŠ¨å¤‡ä»½æ€ä¹ˆåŠï¼Ÿè¦å®ç°è¿™ä¸ªè‡ªåŠ¨å¤‡ä»½åŠŸèƒ½ï¼Œéœ€è¦ä¾èµ–NodeJsçš„ä¸€ä¸ªshelljsæ¨¡å—,è¯¥æ¨¡å—é‡æ–°åŒ…è£…äº†child_process,è°ƒç”¨ç³»ç»Ÿå‘½ä»¤æ›´åŠ çš„æ–¹ä¾¿ï¼Œè¯¥æ¨¡å—éœ€è¦å®‰è£…åä½¿ç”¨ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install --save shelljs</span><br></pre></td></tr></table></figure>

<p><strong>ç¼–å†™è‡ªåŠ¨åŒ–è„šæœ¬</strong></p>
<blockquote>
<p>æ³¨æ„â­ï¼šå¦‚ä¸‹æ“ä½œåªæ˜¯å¸®åŠ©ä½ å‡å°‘ä¸Šé¢æ“ä½œï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œ <code> hexo d</code>çš„æ—¶å€™è‡ªåŠ¨å¸®ä½ æŠŠ <code>git push</code>æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯éœ€åœ¨githubå»ºç«‹ä»“åº“ï¼ï¼ï¼<br>shelljsæ¨¡å—å®‰è£…å®Œæˆåï¼Œåœ¨Hexoæ ¹ç›®å½•çš„scriptsæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªjsæ–‡ä»¶ï¼Œæ–‡ä»¶åéšæ„å–(æˆ‘çš„æ–‡ä»¶åä¸º:auto.js)ã€‚å¦‚æœæ²¡æœ‰scriptsç›®å½•ï¼Œè¯·æ–°å»ºä¸€ä¸ªã€‚ç„¶ååœ¨è„šæœ¬ä¸­ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">require(&#x27;shelljs/global&#x27;);</span><br><span class="line">try &#123;</span><br><span class="line">    hexo.on(&#x27;deployAfter&#x27;, function() &#123;//å½“deployå®Œæˆåæ‰§è¡Œå¤‡ä»½</span><br><span class="line">        run();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125; catch (e) &#123;</span><br><span class="line">    console.log(&quot;äº§ç”Ÿäº†ä¸€ä¸ªé”™è¯¯å•Š&lt;(ï¿£3ï¿£)&gt; !ï¼Œé”™è¯¯è¯¦æƒ…ä¸ºï¼š&quot; + e.toString());</span><br><span class="line">&#125;</span><br><span class="line">function run() &#123;</span><br><span class="line">    if (!which(&#x27;git&#x27;)) &#123;</span><br><span class="line">        echo(&#x27;Sorry, this script requires git&#x27;);</span><br><span class="line">        exit(1);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo(&quot;======================Auto Backup Begin===========================&quot;);</span><br><span class="line">        cd(&#x27;/home/pi/blog&#x27;);    //æ­¤å¤„ä¿®æ”¹ä¸ºHexoæ ¹ç›®å½•è·¯å¾„</span><br><span class="line">        if (exec(&#x27;git add --all&#x27;).code !== 0) &#123;</span><br><span class="line">            echo(&#x27;Error: Git add failed&#x27;);</span><br><span class="line">            exit(1);</span><br><span class="line">        &#125;</span><br><span class="line">        if (exec(&#x27;git commit -am &quot;blog auto backup script\&#x27;s commit&quot;&#x27;).code !== 0) &#123;</span><br><span class="line">            echo(&#x27;Error: Git commit failed&#x27;);</span><br><span class="line">            exit(1);</span><br><span class="line">        &#125;</span><br><span class="line">        // ä¸‹é¢ifå†…å®¹ï¼Œå¦‚æœä½ çš„Gitè¿œç¨‹ä»“åº“åç§°ä¸ä¸ºoriginçš„è¯ï¼Œè¿˜éœ€è¦ä¿®æ”¹pushå‘½ä»¤ï¼Œä¿®æ”¹æˆè‡ªå·±çš„è¿œç¨‹ä»“åº“åå’Œç›¸åº”çš„åˆ†æ”¯å</span><br><span class="line">        if (exec(&#x27;git push origin main&#x27;).code !== 0) &#123;</span><br><span class="line">            echo(&#x27;Error: Git push failed&#x27;);</span><br><span class="line">            exit(1);</span><br><span class="line">        &#125;</span><br><span class="line">        echo(&quot;==================Auto Backup Complete============================&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>ä¸Šè¿°æœ‰ä¸¤å¤„éœ€è¦æ›´æ”¹ï¼Œå·²ç»æ ‡æ³¨</li>
</ul>
<p>æµ‹è¯•ï¼š&#96;&#96; heox d&#96;&#96;&#96;<br>ç»“æœå¦‚ä¸‹ï¼š<br><code>&lt;img src=&quot;https://s2.loli.net/2023/06/04/tjhMsOceK6olzAy.png&quot; alt=&quot;202306042002321&quot; style=&quot;zoom:100%;&quot;/&gt;</code></p>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexoå¤‡ä»½</tag>
      </tags>
  </entry>
  <entry>
    <title>æ·±åº¦å­¦ä¹ â€”â€”pytorchå­¦ä¹ </title>
    <url>/posts/1867073817/</url>
    <content><![CDATA[<h1 id="Pytorchå­¦ä¹ "><a href="#Pytorchå­¦ä¹ " class="headerlink" title="Pytorchå­¦ä¹ "></a>Pytorchå­¦ä¹ </h1><span id="more"></span>
<p>[toc]</p>
<h2 id="pytorchåŸºæœ¬æ“ä½œ"><a href="#pytorchåŸºæœ¬æ“ä½œ" class="headerlink" title="pytorchåŸºæœ¬æ“ä½œ"></a>pytorchåŸºæœ¬æ“ä½œ</h2><p>pytorchä½¿ç”¨å‰é¦–å…ˆäº†è§£ä¸€ä¸ªä¸€ä¸ªæ¦‚å¿µï¼šå¼ é‡ã€‚ä¸ªäººè§‰å¾—æ²¡å¿…è¦å»äº†è§£ä»–åˆ°åº•æ˜¯ä¸€ç§ä»€ä¹ˆä¸œè¥¿ï¼Œå¯ä»¥å°†å…¶ä¸æˆ‘ä»¬numpyä¸­æ•°ç»„ä¸€èµ·è¿›è¡Œäº†è§£</p>
<blockquote>
<p>å¼ é‡å¯ä»¥çœ‹ä½œæ˜¯â¼€ä¸ªå¤šç»´æ•°ç»„ã€‚æ ‡é‡å¯ä»¥çœ‹ä½œæ˜¯0ç»´å¼ é‡ï¼Œå‘é‡å¯ä»¥çœ‹ä½œ1ç»´å¼ é‡ï¼ŒçŸ©é˜µå¯ä»¥çœ‹ä½œæ˜¯â¼†ç»´å¼ é‡</p>
</blockquote>
<p>é‚£ä¹ˆæˆ‘ä»¬åç»­ä¹Ÿéƒ½æ˜¯å›´ç»•å¼ é‡è¿›è¡Œå±•å¼€äº†è§£</p>
<h3 id="æ•°æ®æ“ä½œ"><a href="#æ•°æ®æ“ä½œ" class="headerlink" title="æ•°æ®æ“ä½œ"></a>æ•°æ®æ“ä½œ</h3><h4 id="åˆ›å»ºå¼ é‡"><a href="#åˆ›å»ºå¼ é‡" class="headerlink" title="åˆ›å»ºå¼ é‡"></a>åˆ›å»ºå¼ é‡</h4><p><img data-src="/pytorch%E5%AD%A6%E4%B9%A0/1680163291680.png" alt="1680163291680"></p>
<blockquote>
<p>æ³¨æ„ä½¿ç”¨pytorchå°±ä¸å¾—ä¸äº†è§£ä¸€å¤§ç‰¹ç‚¹ï¼šåˆ©ç”¨GPUè®¡ç®—ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&gt;&gt;a = torch.ones(<span class="number">5</span>,<span class="number">3</span>,device=<span class="string">&#x27;cuda&#x27;</span>,dtype=torch.float64)<span class="comment">#è®¾ç½®ç±»å‹ï¼Œgpu</span></span><br><span class="line">&gt;&gt;a</span><br><span class="line">tensor([[<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>]], device=<span class="string">&#x27;cuda:0&#x27;</span>, dtype=torch.float64)</span><br><span class="line">&gt;&gt;<span class="built_in">print</span>(a.size(),a.shape)</span><br><span class="line">torch.Size([<span class="number">5</span>, <span class="number">3</span>]) torch.Size([<span class="number">5</span>, <span class="number">3</span>])</span><br></pre></td></tr></table></figure>

<h4 id="æ“ä½œ"><a href="#æ“ä½œ" class="headerlink" title="æ“ä½œ"></a>æ“ä½œ</h4><ul>
<li><strong>åŠ æ³•è¿ç®—</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(x+y)</span><br><span class="line"><span class="built_in">print</span>(torch.add(x,y))</span><br><span class="line"><span class="built_in">print</span>(y.add(x))</span><br><span class="line">-&gt;tensor([[<span class="number">0.9841</span>, <span class="number">1.1514</span>, <span class="number">1.0982</span>],</span><br><span class="line">        [<span class="number">0.9974</span>, <span class="number">0.4662</span>, <span class="number">1.5250</span>],</span><br><span class="line">        [<span class="number">0.5120</span>, <span class="number">0.3424</span>, <span class="number">1.6973</span>],</span><br><span class="line">        [<span class="number">1.1808</span>, <span class="number">1.1172</span>, <span class="number">1.6786</span>],</span><br><span class="line">        [<span class="number">1.9113</span>, <span class="number">1.3679</span>, <span class="number">1.3846</span>]])</span><br><span class="line">ä¸‰ä¸ªç»“æœéƒ½ä¸€æ ·</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>ç´¢å¼•</strong><br>ç´¢å¼•å‡ºæ¥çš„ç»“æœä¸åŸæ•°æ®å…±äº«å†…å­˜ï¼Œä¹Ÿå³ä¿®æ”¹â¼€ä¸ªï¼Œå¦â¼€ä¸ªä¼šè·Ÿç€ä¿®æ”¹ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">b = x[<span class="number">0</span>:<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line">-&gt;tensor([[<span class="number">0.6847</span>, <span class="number">0.9743</span>, <span class="number">0.9259</span>]])</span><br><span class="line">b +=<span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(x[<span class="number">0</span>,:])</span><br><span class="line">-&gt;tensor([<span class="number">2.6847</span>, <span class="number">2.9743</span>, <span class="number">2.9259</span>])</span><br></pre></td></tr></table></figure>

<p><img data-src="/pytorch%E5%AD%A6%E4%B9%A0/1680164219080.png" alt="1680164219080"></p>
</li>
<li><p><strong>æ”¹å˜å½¢çŠ¶</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = x.view(<span class="number">15</span>)</span><br><span class="line">c</span><br><span class="line">-&gt;tensor([<span class="number">2.6847</span>, <span class="number">2.9743</span>, <span class="number">2.9259</span>, <span class="number">0.7470</span>, <span class="number">0.2349</span>, <span class="number">0.6642</span>, <span class="number">0.3026</span>, <span class="number">0.1884</span>, <span class="number">0.9414</span>,</span><br><span class="line">        <span class="number">0.4747</span>, <span class="number">0.8469</span>, <span class="number">0.7788</span>, <span class="number">0.9762</span>, <span class="number">0.4373</span>, <span class="number">0.6214</span>])</span><br><span class="line">c +=<span class="number">1</span></span><br><span class="line">x</span><br><span class="line">-&gt;tensor([[<span class="number">3.6847</span>, <span class="number">3.9743</span>, <span class="number">3.9259</span>],</span><br><span class="line">        [<span class="number">1.7470</span>, <span class="number">1.2349</span>, <span class="number">1.6642</span>],</span><br><span class="line">        [<span class="number">1.3026</span>, <span class="number">1.1884</span>, <span class="number">1.9414</span>],</span><br><span class="line">        [<span class="number">1.4747</span>, <span class="number">1.8469</span>, <span class="number">1.7788</span>],</span><br><span class="line">        [<span class="number">1.9762</span>, <span class="number">1.4373</span>, <span class="number">1.6214</span>]])</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨view()å‡½æ•°è¿”å›çš„æ–°tensorä¸æºtensorå…±äº«å†…å­˜ï¼ˆå…¶å®æ˜¯åŒâ¼€ä¸ªtensorï¼‰ï¼Œä¹Ÿå³æ›´æ”¹å…¶ä¸­çš„â¼€ä¸ªï¼Œå¦<br>å¤–â¼€ä¸ªä¹Ÿä¼šè·Ÿç€æ”¹å˜ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³è¿”å›â¼€ä¸ªçœŸæ­£æ–°çš„å‰¯æœ¬ï¼ˆå³ä¸å…±äº«å†…å­˜ï¼‰è¯¥æ€ä¹ˆåŠå‘¢ï¼ŸPytorchè¿˜æä¾›äº†â¼€ä¸ªreshape()å¯ä»¥æ”¹å˜å½¢çŠ¶ï¼Œä½†æ˜¯æ­¤å‡½æ•°å¹¶ä¸èƒ½ä¿è¯è¿”å›çš„æ˜¯å…¶æ‹·â»‰ï¼Œæ‰€ä»¥ä¸æ¨èä½¿â½¤ã€‚æ¨èå…ˆ<br>â½¤ clone åˆ›é€ â¼€ä¸ªå‰¯æœ¬ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x_clone = x.clone()</span><br><span class="line">x_clone +=<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(x_clone, <span class="string">&#x27;\n&#x27;</span>, x)</span><br><span class="line">-&gt;tensor([[<span class="number">4.6847</span>, <span class="number">4.9743</span>, <span class="number">4.9259</span>],</span><br><span class="line">        [<span class="number">2.7470</span>, <span class="number">2.2349</span>, <span class="number">2.6642</span>],</span><br><span class="line">        [<span class="number">2.3026</span>, <span class="number">2.1884</span>, <span class="number">2.9414</span>],</span><br><span class="line">        [<span class="number">2.4747</span>, <span class="number">2.8469</span>, <span class="number">2.7788</span>],</span><br><span class="line">        [<span class="number">2.9762</span>, <span class="number">2.4373</span>, <span class="number">2.6214</span>]]) </span><br><span class="line"> tensor([[<span class="number">3.6847</span>, <span class="number">3.9743</span>, <span class="number">3.9259</span>],</span><br><span class="line">        [<span class="number">1.7470</span>, <span class="number">1.2349</span>, <span class="number">1.6642</span>],</span><br><span class="line">        [<span class="number">1.3026</span>, <span class="number">1.1884</span>, <span class="number">1.9414</span>],</span><br><span class="line">        [<span class="number">1.4747</span>, <span class="number">1.8469</span>, <span class="number">1.7788</span>],</span><br><span class="line">        [<span class="number">1.9762</span>, <span class="number">1.4373</span>, <span class="number">1.6214</span>]])</span><br></pre></td></tr></table></figure></li>
<li><p><strong>çº¿æ€§ä»£æ•°</strong></p>
<p><img data-src="/pytorch%E5%AD%A6%E4%B9%A0/1680164657109.png" alt="1680164657109"></p>
<blockquote>
<p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://pytorch.org/docs/stable/tensors.html">torch.Tensor â€” PyTorch 2.0 documentation</a></p>
</blockquote>
</li>
<li><p><strong>å¹¿æ’­æœºåˆ¶</strong><br>çº¿æ€§ä»£æ•°å‘Šè¯‰æˆ‘ä»¬ï¼Œè¦æ˜¯ä¸¤ä¸ªçŸ©é˜µå½¢çŠ¶ä¸åŒæ˜¯ä¸å¯ä»¥ç›´æ¥ç›¸åŠ çš„ï¼Œä½†æ˜¯pytorchçš„å¹¿æ’­æœºåˆ¶å¯ä»¥å®ç°æ­¤ç±»è®¡ç®—ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = torch.arange(<span class="number">1</span>, <span class="number">3</span>).view(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line">y = torch.arange(<span class="number">1</span>, <span class="number">4</span>).view(<span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="built_in">print</span>(x + y)</span><br><span class="line">-&gt;tensor([[<span class="number">1</span>, <span class="number">2</span>]])</span><br><span class="line">tensor([[<span class="number">1</span>],</span><br><span class="line">        [<span class="number">2</span>],</span><br><span class="line">        [<span class="number">3</span>]])</span><br><span class="line">tensor([[<span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">        [<span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">5</span>]])</span><br></pre></td></tr></table></figure>

<p>è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œç”±äºxï¼Œyçš„å½¢çŠ¶æ˜¯ä¸ç›¸åŒçš„ï¼Œé€šè¿‡å¹¿æ’­æœºåˆ¶ï¼Œä¼šå°†xè¿›è¡Œæ‹“å±•ï¼Œä¹Ÿå°±æ˜¯å°†xå˜æˆ3x2ï¼Œyå˜æˆ3x2è€Œåå†è¿›è¡Œè®¡ç®—ã€‚</p>
</li>
</ul>
<h3 id="tensorå’Œnumpyç›¸äº’è½¬æ¢"><a href="#tensorå’Œnumpyç›¸äº’è½¬æ¢" class="headerlink" title="tensorå’Œnumpyç›¸äº’è½¬æ¢"></a>tensorå’Œnumpyç›¸äº’è½¬æ¢</h3><p>æˆ‘ä»¬å¾ˆå®¹æ˜“â½¤ numpy() å’Œ from_numpy() å°† Tensor å’ŒNumPyä¸­çš„æ•°ç»„ç›¸äº’è½¬æ¢ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„â¼€<br>ç‚¹æ˜¯ï¼š <strong>è¿™ä¸¤ä¸ªå‡½æ•°æ‰€äº§â½£çš„çš„ Tensor å’ŒNumPyä¸­çš„æ•°ç»„å…±äº«ç›¸åŒçš„å†…å­˜ï¼ˆæ‰€ä»¥ä»–ä»¬ä¹‹é—´çš„è½¬æ¢å¾ˆ<br>å¿«ï¼‰ï¼Œæ”¹å˜å…¶ä¸­â¼€ä¸ªæ—¶å¦â¼€ä¸ªä¹Ÿä¼šæ”¹å˜ï¼ï¼ï¼</strong></p>
<blockquote>
<p>è¿˜æœ‰â¼€ä¸ªå¸¸â½¤çš„å°†NumPyä¸­çš„arrayè½¬æ¢æˆ Tensor çš„â½…æ³•å°±æ˜¯ torch.tensor() , éœ€è¦æ³¨æ„çš„<br>æ˜¯ï¼Œæ­¤â½…æ³•æ€»æ˜¯ä¼šè¿›â¾æ•°æ®æ‹·â»‰ï¼ˆå°±ä¼šæ¶ˆè€—æ›´å¤šçš„æ—¶é—´å’Œç©ºé—´ï¼‰ï¼Œæ‰€ä»¥è¿”å›çš„ Tensor å’ŒåŸæ¥çš„æ•°<br>æ®ä¸å†å…±äº«å†…</p>
</blockquote>
<ul>
<li>numpy()<br>å°†tensorè½¬æ¢ä¸ºnumpyå½¢å¼</li>
<li>torch.from_numpy()<br>å°†numpyè½¬æ¢ä¸ºtensor</li>
</ul>
<h2 id="è‡ªåŠ¨æ±‚æ¢¯åº¦"><a href="#è‡ªåŠ¨æ±‚æ¢¯åº¦" class="headerlink" title="è‡ªåŠ¨æ±‚æ¢¯åº¦"></a>è‡ªåŠ¨æ±‚æ¢¯åº¦</h2><blockquote>
<p><a href="https://pytorch.org/tutorials/beginner/blitz/autograd_tutorial.html#sphx-glr-beginner-blitz-autograd-tutorial-py">A Gentle Introduction to torch.autograd â€” PyTorch Tutorials 2.0.0+cu117 documentation</a></p>
</blockquote>
<p>åœ¨ç”Ÿæˆtensoræ—¶å€™æˆ‘ä»¬æ·»åŠ å±æ€§ (requires_grad&#x3D;True )ï¼Œå®ƒå°†å¼€å§‹è¿½è¸ª(track)åœ¨å…¶ä¸Šçš„æ‰€æœ‰æ“ä½œï¼ˆè¿™æ ·å°±å¯ä»¥åˆ©â½¤é“¾å¼æ³•åˆ™è¿›â¾æ¢¯åº¦ä¼ æ’­äº†ï¼‰ã€‚å®Œæˆè®¡ç®—åï¼Œå¯ä»¥è°ƒâ½¤.backward() æ¥å®Œæˆæ‰€æœ‰æ¢¯åº¦è®¡ç®—ã€‚æ­¤Tensorçš„æ¢¯åº¦å°†ç´¯ç§¯åˆ°.grad å±æ€§ä¸­ã€‚</p>
<p>å¦‚æœä¸æƒ³è¦è¢«ç»§ç»­è¿½è¸ªï¼Œå¯ä»¥è°ƒâ½¤ .detach() å°†å…¶ä»è¿½è¸ªè®°å½•ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œè¿™æ ·å°±å¯ä»¥é˜²â½Œå°†æ¥çš„è®¡ç®—è¢«è¿½è¸ªï¼Œè¿™æ ·æ¢¯åº¦å°±ä¼ ä¸è¿‡å»äº†ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥â½¤ with torch.no_grad() å°†ä¸æƒ³è¢«è¿½è¸ªçš„æ“ä½œä»£ç å—åŒ…è£¹èµ·æ¥ï¼Œè¿™ç§â½…æ³•åœ¨è¯„ä¼°æ¨¡å‹çš„æ—¶å€™å¾ˆå¸¸â½¤ï¼Œå› ä¸ºåœ¨è¯„ä¼°æ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦è®¡ç®—å¯è®­ç»ƒå‚æ•°ï¼ˆrequires_grad&#x3D;Trueï¼‰çš„æ¢¯åº¦ã€‚</p>
<blockquote>
<p>é€šä¿—çš„æ¥è®²å°±æ˜¯æˆ‘ä»¬æ·»åŠ  requires_grad å¯ä»¥è®°å½•åœ¨å¼ é‡ä¸Šæ‰€è¿›è¡Œçš„æ‰€æœ‰çš„æ“ä½œ</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = torch.ones(<span class="number">2</span>,<span class="number">2</span>,requires_grad=<span class="literal">True</span>)</span><br><span class="line">y = x+ <span class="number">2</span></span><br><span class="line">z = y*y*<span class="number">3</span></span><br><span class="line">p = z.mean()</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line">-&gt;tensor(<span class="number">27.</span>, grad_fn=&lt;MeanBackward0&gt;)</span><br><span class="line">p.backward()</span><br><span class="line"><span class="built_in">print</span>(x.grad)</span><br><span class="line">-&gt;tensor([[<span class="number">4.5000</span>, <span class="number">4.5000</span>],</span><br><span class="line">        [<span class="number">4.5000</span>, <span class="number">4.5000</span>]])</span><br></pre></td></tr></table></figure>

<p>è®¡ç®—ç»“æœæ€ä¹ˆæ¥çš„å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬çŸ¥é“pæ‰€è¿›è¡Œçš„è®¡ç®—å¦‚ä¸‹</p>
<p>$$<br>p&#x3D;\frac{1}{4}\sum3(x_i+2)^2<br>$$</p>
<p>$$<br>\dfrac{\partial p}{\partial x}|_{x_i&#x3D;1}&#x3D;\frac{9}{2}&#x3D;4.5<br>$$</p>
<p>ä¸è¿‡åœ¨æ­¤å¤„éœ€è¦ä¸€ä¸ª<strong>æ³¨æ„äº‹é¡¹</strong>ï¼Œæˆ‘ä»¬çš„på¿…é¡»æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œä¹Ÿå°±æ˜¯è¯´på¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œä¸ç„¶ç»“æœä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">x = torch.tensor([<span class="number">2.</span>, <span class="number">1.</span>], requires_grad=<span class="literal">True</span>)</span><br><span class="line">y = torch.tensor([[<span class="number">1.</span>, <span class="number">2.</span>], [<span class="number">3.</span>, <span class="number">4.</span>]], requires_grad=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">z = torch.mm(x.view(<span class="number">1</span>, <span class="number">2</span>), y)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;z:<span class="subst">&#123;z&#125;</span>&quot;</span>)</span><br><span class="line">z.backward(torch.Tensor([[<span class="number">1.</span>, <span class="number">0</span>]]), retain_graph=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x.grad: <span class="subst">&#123;x.grad&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;y.grad: <span class="subst">&#123;y.grad&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">--&gt;z:tensor([[<span class="number">5.</span>, <span class="number">8.</span>]], grad_fn=&lt;MmBackward&gt;)</span><br><span class="line">x.grad: tensor([[<span class="number">1.</span>, <span class="number">3.</span>]])</span><br><span class="line">y.grad: tensor([[<span class="number">2.</span>, <span class="number">0.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">0.</span>]])</span><br></pre></td></tr></table></figure>

<p>ç®—æ³•è§£é‡Šå¦‚ä¸‹ï¼š<br><img data-src="/pytorch%E5%AD%A6%E4%B9%A0/1680176521877.png" alt="1680176521877"><br>æˆ‘ä»¬åœ¨å¯¹zè¿›è¡Œæ±‚æ¢¯åº¦çš„æ—¶å€™ï¼ŒæŒ‡å®šäº†å‚æ•°[1,0]ä¹Ÿå°±æ˜¯ç›¸å¯¹äºè¿›è¡Œäº†åŠ æƒæ“ä½œ</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.w3cschool.cn/article/9034837.html">https://www.w3cschool.cn/article/9034837.html</a></p>
<p><a href="https://blog.csdn.net/qq_39208832/article/details/117415229">https://blog.csdn.net/qq_39208832/article/details/117415229</a></p>
<p><a href="https://pytorch.org/tutorials/beginner/blitz/autograd_tutorial.html#sphx-glr-beginner-blitz-autograd-tutorial-py">https://pytorch.org/tutorials/beginner/blitz/autograd_tutorial.html#sphx-glr-beginner-blitz-autograd-tutorial-py</a></p>
]]></content>
      <categories>
        <category>æ·±åº¦å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æ·±åº¦å­¦ä¹ </tag>
        <tag>Pytorch</tag>
      </tags>
  </entry>
  <entry>
    <title>pytorchå®ç°CNN</title>
    <url>/posts/3220359105/</url>
    <content><![CDATA[<h1 id="pytorchå®ç°CNN"><a href="#pytorchå®ç°CNN" class="headerlink" title="pytorchå®ç°CNN"></a>pytorchå®ç°CNN</h1><span id="more"></span>
<p>nn.Conv2d<br>torch.nn.Conv2d(in_channels, out_channels, kernel_size, stride&#x3D;1, padding&#x3D;0, dilation&#x3D;1, groups&#x3D;1, bias&#x3D;True, padding_mode&#x3D;â€™zerosâ€™, device&#x3D;None, dtype&#x3D;None)<br><strong>å‚æ•°è§£é‡Š</strong><br>1ã€in_channels (int) â€“ è¾“å…¥å›¾åƒä¸­çš„é€šé“æ•°<br>2ã€out_channels (int) â€“ å·ç§¯äº§ç”Ÿçš„é€šé“æ•°<br>3ã€kernel_size (int or tuple) â€“ å·ç§¯æ ¸çš„å¤§å°<br>4ã€stride (int or tuple, optional) â€“ å·ç§¯çš„æ­¥å¹…ï¼Œé»˜è®¤å€¼ï¼š1<br>5ã€padding (int, tuple or str, optional) â€“ æ·»åŠ åˆ°è¾“å…¥çš„æ‰€æœ‰å››ä¸ªè¾¹çš„å¡«å……ï¼Œé»˜è®¤å€¼ï¼š0<br>6ã€padding_mode (str, optional) â€“ â€˜zerosâ€™, â€˜reflectâ€™, â€˜replicateâ€™ or â€˜circularâ€™ï¼Œé»˜è®¤: â€˜zerosâ€™<br>6ã€dilation (int or tuple, optional) â€“ å†…æ ¸å…ƒç´ ä¹‹é—´çš„é—´è·ï¼Œé»˜è®¤å€¼ï¼š1<br>7ã€groups (int, optional) â€“ ä»è¾“å…¥é€šé“åˆ°è¾“å‡ºé€šé“çš„é˜»å¡è¿æ¥æ•°ï¼Œé»˜è®¤å€¼ï¼š1<br>8ã€bias (bool, optional) â€“ å¦‚æœæ˜¯ â€œçœŸâ€ï¼Œåˆ™åœ¨è¾“å‡ºä¸­å¢åŠ ä¸€ä¸ªå¯å­¦ä¹ çš„åç½®ï¼Œé»˜è®¤å€¼ï¼š çœŸ  </p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"></span><br><span class="line">torch.set_printoptions(edgeitems=<span class="number">2</span>)</span><br><span class="line">torch.manual_seed(<span class="number">123</span>)</span><br><span class="line">class_names = [<span class="string">&#x27;airplane&#x27;</span>,<span class="string">&#x27;automobile&#x27;</span>,<span class="string">&#x27;bird&#x27;</span>,<span class="string">&#x27;cat&#x27;</span>,<span class="string">&#x27;deer&#x27;</span>,<span class="string">&#x27;dog&#x27;</span>,<span class="string">&#x27;frog&#x27;</span>,<span class="string">&#x27;horse&#x27;</span>,<span class="string">&#x27;ship&#x27;</span>,<span class="string">&#x27;truck&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¸‹è½½æ•°æ®</span></span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> datasets, transforms</span><br><span class="line">data_path = <span class="string">&#x27;E:/CIFAR-10/&#x27;</span> </span><br><span class="line">cifar10 = datasets.CIFAR10(</span><br><span class="line">    data_path, train=<span class="literal">True</span>, download=<span class="literal">True</span>,</span><br><span class="line">    transform=transforms.Compose([</span><br><span class="line">        transforms.ToTensor(),</span><br><span class="line">        transforms.Normalize((<span class="number">0.4915</span>, <span class="number">0.4823</span>, <span class="number">0.4468</span>),</span><br><span class="line">                             (<span class="number">0.2470</span>, <span class="number">0.2435</span>, <span class="number">0.2616</span>))</span><br><span class="line">    ]))</span><br><span class="line">cifar10_val = datasets.CIFAR10(</span><br><span class="line">    data_path, train=<span class="literal">False</span>, download=<span class="literal">True</span>,</span><br><span class="line">    transform=transforms.Compose([</span><br><span class="line">        transforms.ToTensor(),</span><br><span class="line">        transforms.Normalize((<span class="number">0.4915</span>, <span class="number">0.4823</span>, <span class="number">0.4468</span>),</span><br><span class="line">                             (<span class="number">0.2470</span>, <span class="number">0.2435</span>, <span class="number">0.2616</span>))</span><br><span class="line">    ]))</span><br><span class="line"><span class="comment">#è¯†åˆ«é¸Ÿå’Œé£æœº</span></span><br><span class="line">label_map = &#123;<span class="number">0</span>: <span class="number">0</span>, <span class="number">2</span>: <span class="number">1</span>&#125;</span><br><span class="line">class_names = [<span class="string">&#x27;airplane&#x27;</span>, <span class="string">&#x27;bird&#x27;</span>]</span><br><span class="line">cifar2 = [(img, label_map[label]) <span class="keyword">for</span> img, label <span class="keyword">in</span> cifar10 <span class="keyword">if</span> label <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">2</span>]]</span><br><span class="line">cifar2_val = [(img, label_map[label]) <span class="keyword">for</span> img, label <span class="keyword">in</span> cifar10_val <span class="keyword">if</span> label <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">2</span>]]</span><br><span class="line"><span class="comment">#å®šä¹‰ç¥ç»ç½‘ç»œæ¨¡å‹</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Net</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.conv1 = nn.Conv2d(<span class="number">3</span>, <span class="number">16</span>, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>)</span><br><span class="line">        self.act1 = nn.Tanh()</span><br><span class="line">        self.pool1 = nn.MaxPool2d(<span class="number">2</span>)</span><br><span class="line">        self.conv2 = nn.Conv2d(<span class="number">16</span>, <span class="number">8</span>, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>)</span><br><span class="line">        self.act2 = nn.Tanh()</span><br><span class="line">        self.pool2 = nn.MaxPool2d(<span class="number">2</span>)</span><br><span class="line">        self.fc1 = nn.Linear(<span class="number">8</span> * <span class="number">8</span> * <span class="number">8</span>, <span class="number">32</span>)</span><br><span class="line">        self.act3 = nn.Tanh()</span><br><span class="line">        self.fc2 = nn.Linear(<span class="number">32</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        out = self.pool1(self.act1(self.conv1(x)))</span><br><span class="line">        out = self.pool2(self.act2(self.conv2(out)))</span><br><span class="line">        out = out.view(-<span class="number">1</span>, <span class="number">8</span> * <span class="number">8</span> * <span class="number">8</span>)</span><br><span class="line">        out = self.act3(self.fc1(out))</span><br><span class="line">        out = self.fc2(out)</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> datetime  </span><br><span class="line"><span class="comment">#å®šä¹‰æŸå¤±å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">training_loop</span>(<span class="params">n_epochs, optimizer, model, loss_fn, train_loader</span>):</span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n_epochs + <span class="number">1</span>): </span><br><span class="line">        loss_train = <span class="number">0.0</span></span><br><span class="line">        <span class="keyword">for</span> imgs, labels <span class="keyword">in</span> train_loader:</span><br><span class="line">            <span class="comment">#åˆ©ç”¨GPUè®¡ç®—</span></span><br><span class="line">            imgs = imgs.to(<span class="string">&quot;cuda:0&quot;</span>)</span><br><span class="line">            labels = labels.to(<span class="string">&quot;cuda:0&quot;</span>)</span><br><span class="line">            <span class="comment">#è®¡ç®—æŸå¤±å‡½æ•°</span></span><br><span class="line">            outputs = model(imgs)</span><br><span class="line">            loss = loss_fn(outputs, labels)</span><br><span class="line">            <span class="comment">#éšæœºæ¢¯åº¦ä¸‹é™æ›´æ–°å‚æ•°</span></span><br><span class="line">            optimizer.zero_grad()</span><br><span class="line">            loss.backward()</span><br><span class="line">            optimizer.step()</span><br><span class="line">            loss_train += loss.item()</span><br><span class="line">        <span class="keyword">if</span> epoch == <span class="number">1</span> <span class="keyword">or</span> epoch % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;&#123;&#125; Epoch &#123;&#125;, è®­ç»ƒæŸå¤±&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(datetime.datetime.now(), epoch,</span><br><span class="line">                loss_train / <span class="built_in">len</span>(train_loader))) </span><br></pre></td></tr></table></figure>

<p>è¿è¡Œ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">train_loader = torch.utils.data.DataLoader(cifar2, batch_size=<span class="number">64</span>,</span><br><span class="line">                                           shuffle=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">model = Net()</span><br><span class="line">model = model.to(<span class="string">&quot;cuda:0&quot;</span>)</span><br><span class="line">optimizer = optim.SGD(model.parameters(), lr=<span class="number">1e-2</span>)</span><br><span class="line">loss_fn = nn.CrossEntropyLoss()</span><br><span class="line"></span><br><span class="line">training_loop(</span><br><span class="line">    n_epochs = <span class="number">100</span>,</span><br><span class="line">    optimizer = optimizer,</span><br><span class="line">    model = model,</span><br><span class="line">    loss_fn = loss_fn,</span><br><span class="line">    train_loader = train_loader,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æ·±åº¦å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æ·±åº¦å­¦ä¹ </tag>
        <tag>CNN</tag>
      </tags>
  </entry>
  <entry>
    <title>å†³ç­–æ ‘ç®—æ³•</title>
    <url>/posts/4012468743/</url>
    <content><![CDATA[<p><strong>å†³ç­–æ ‘</strong>æ˜¯ä¸€ä¸ªé¢„æµ‹æ¨¡å‹ï¼›ä»–ä»£è¡¨çš„æ˜¯å¯¹è±¡å±æ€§ä¸å¯¹è±¡å€¼ä¹‹é—´çš„ä¸€ç§æ˜ å°„å…³ç³»ã€‚æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹è¡¨ç¤ºæŸä¸ªå¯¹è±¡ï¼Œè€Œæ¯ä¸ªåˆ†å‰è·¯å¾„åˆ™ä»£è¡¨æŸä¸ªå¯èƒ½çš„å±æ€§å€¼ï¼Œè€Œæ¯ä¸ªå¶èŠ‚ç‚¹åˆ™å¯¹åº”ä»æ ¹èŠ‚ç‚¹åˆ°è¯¥å¶èŠ‚ç‚¹æ‰€ç»å†çš„è·¯å¾„æ‰€è¡¨ç¤ºçš„å¯¹è±¡çš„å€¼ã€‚å†³ç­–æ ‘ä»…æœ‰å•ä¸€è¾“å‡ºï¼Œè‹¥æ¬²æœ‰å¤æ•°è¾“å‡ºï¼Œå¯ä»¥å»ºç«‹ç‹¬ç«‹çš„å†³ç­–æ ‘ä»¥å¤„ç†ä¸åŒè¾“å‡ºã€‚ æ•°æ®æŒ–æ˜ä¸­å†³ç­–æ ‘æ˜¯ä¸€ç§ç»å¸¸è¦ç”¨åˆ°çš„æŠ€æœ¯ï¼Œå¯ä»¥ç”¨äºåˆ†ææ•°æ®ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥ç”¨æ¥ä½œé¢„æµ‹ï¼Œä»æ•°æ®äº§ç”Ÿå†³ç­–æ ‘çš„æœºå™¨å­¦ä¹ æŠ€æœ¯å«åš <strong>å†³ç­–æ ‘å­¦ä¹ </strong> ,é€šä¿—è¯´å°±æ˜¯<strong>å†³ç­–æ ‘</strong></p>
<span id="more"></span>

<h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯å†³ç­–æ ‘ç®—æ³•"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯å†³ç­–æ ‘ç®—æ³•" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯å†³ç­–æ ‘ç®—æ³•"></a>ä¸€ã€ä»€ä¹ˆæ˜¯å†³ç­–æ ‘ç®—æ³•</h2><p><strong>å†³ç­–æ ‘</strong>æ˜¯ä¸€ä¸ªé¢„æµ‹æ¨¡å‹ï¼›ä»–ä»£è¡¨çš„æ˜¯å¯¹è±¡å±æ€§ä¸å¯¹è±¡å€¼ä¹‹é—´çš„ä¸€ç§æ˜ å°„å…³ç³»ã€‚æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹è¡¨ç¤ºæŸä¸ªå¯¹è±¡ï¼Œè€Œæ¯ä¸ªåˆ†å‰è·¯å¾„åˆ™ä»£è¡¨æŸä¸ªå¯èƒ½çš„å±æ€§å€¼ï¼Œè€Œæ¯ä¸ªå¶èŠ‚ç‚¹åˆ™å¯¹åº”ä»æ ¹èŠ‚ç‚¹åˆ°è¯¥å¶èŠ‚ç‚¹æ‰€ç»å†çš„è·¯å¾„æ‰€è¡¨ç¤ºçš„å¯¹è±¡çš„å€¼ã€‚å†³ç­–æ ‘ä»…æœ‰å•ä¸€è¾“å‡ºï¼Œè‹¥æ¬²æœ‰å¤æ•°è¾“å‡ºï¼Œå¯ä»¥å»ºç«‹ç‹¬ç«‹çš„å†³ç­–æ ‘ä»¥å¤„ç†ä¸åŒè¾“å‡ºã€‚ æ•°æ®æŒ–æ˜ä¸­å†³ç­–æ ‘æ˜¯ä¸€ç§ç»å¸¸è¦ç”¨åˆ°çš„æŠ€æœ¯ï¼Œå¯ä»¥ç”¨äºåˆ†ææ•°æ®ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥ç”¨æ¥ä½œé¢„æµ‹ï¼Œä»æ•°æ®äº§ç”Ÿå†³ç­–æ ‘çš„æœºå™¨å­¦ä¹ æŠ€æœ¯å«åš <strong>å†³ç­–æ ‘å­¦ä¹ </strong> ,é€šä¿—è¯´å°±æ˜¯<strong>å†³ç­–æ ‘</strong></p>
<blockquote>
<p>ç»´åŸºç™¾ç§‘ï¼š<a href="https://zh.wikipedia.org/zh-cn/%E5%86%B3%E7%AD%96%E6%A0%91#%E7%AE%80%E4%BB%8B">https://zh.wikipedia.org/zh-cn/%E5%86%B3%E7%AD%96%E6%A0%91#%E7%AE%80%E4%BB%8B</a></p>
</blockquote>
<p>ä¸æ‡‚ï¼Ÿé‚£æˆ‘ä»¬å¼•ç”¨<strong>å‘¨å¿—åè€å¸ˆè¥¿ç“œä¹¦</strong>ä¸Šçš„ä¾‹å­ï¼Œç«‹é©¬å°±èƒ½æœ‰ä¸€ä¸ªå¤§æ¦‚äº†è§£ã€‚</p>
<blockquote>
<p>æ¯”å¦‚ä½ å¸¦ä½ è¡¨å¦¹ç°åœ¨è¦å»è¥¿ç“œæ‘Šä¹°è¥¿ç“œï¼Œè€Œä½œä¸ºå–è¥¿ç“œè€æ‰‹çš„ä½ æ€»æ˜¯èƒ½å¤Ÿä¸€çœ¼æŒ‘é€‰å‡ºé‚£ä¸ªæœ€å¥½åƒæœ€ç”œçš„è¥¿ç“œï¼Œè€Œè¡¨å¦¹æ€»æ˜¯é€‰çš„ä¸å°½äººæ„ï¼Œè¡¨å¦¹çªå‘å¥‡æƒ³å‘ä½ è¯·æ•™æ€ä¹ˆé€‰å‡ºä¸€ä¸ªå¿ƒæ»¡æ„è¶³çš„è¥¿ç“œã€‚ä½ è¯´ï¼šå¾—ä»·é’±ï¼ä¸å¯¹ä¸å¯¹å’±ä»¬åœ¨è°ˆä¹°è¥¿ç“œï¼Œä½ è¯´å’±ä»¬å•Šï¼Œå…ˆçœ‹â€œå®ƒæ˜¯ä»€ä¹ˆé¢œè‰²?â€ï¼Œå¦‚æœæ˜¯â€œé’ç»¿è‰²â€ï¼Œåˆ™æˆ‘ä»¬å†çœ‹ â€œå®ƒçš„æ ¹è’‚æ˜¯ä»€ä¹ˆå½¢æ€?â€ï¼Œå¦‚æœæ˜¯â€œèœ·ç¼© â€ï¼Œæˆ‘ä»¬å†åˆ¤æ–­â€œå®ƒæ•²èµ·æ¥æ˜¯ä»€ä¹ˆå£°éŸ³?â€ï¼Œæœ€åï¼Œæˆ‘ä»¬å¾—å‡ºæœ€ç»ˆå†³ç­–ï¼šè¿™ä¸ªç“œå¾ˆæ¶¦ï¼Œå‘¸å‘¸å‘¸ï¼Œæ˜¯å¾ˆç”œï¼</p>
</blockquote>
<p>æˆ‘ç›¸ä¿¡ä½ ç°åœ¨åº”è¯¥æœ‰ä¸€ä¸ªå¤§æ¦‚äº†è§£äº†ï¼Œä¸å°±æ˜¯é€‰æ‹©ä¸€ä¸ªç›®çš„ï¼ˆæˆ‘ä»¬éœ€è¦è¿›è¡Œçš„åˆ†ç±»çš„æ ‡ç­¾ï¼‰ï¼Œç„¶åæ ¹æ®ä¸€ç³»åˆ—çš„ç‰¹å¾ä»è€Œæ»¡è¶³æˆ‘ä»¬çš„ç›®çš„ï¼Œä»¥åæˆ‘ä»¬å°±å€Ÿç”¨è¿™ä¸ªç‰¹å¾å»æŒ‘é€‰â€œå¥½ç“œâ€ã€‚ä½†æ˜¯ï¼å…ˆæ³¼ä¸€ç›†å‡‰æ°´ç»™ä½ ï¼Œæˆ‘ä»¬æ€ä¹ˆå¼€å§‹ç¬¬ä¸€æ­¥å‘¢ï¼Ÿè¿™è¿˜ä¸ç®€å•ï¼Œç›´æ¥é€‰æ‹©â€é¢œè‰²â€œå‘€ï¼ä½†æ˜¯æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸ä»â€æ ¹èŒâ€œä¸‹æ‰‹å‘¢ï¼Ÿä¸‹é¢å°±æ˜¯æˆ‘ä»¬è¦å°†çš„å¦‚ä½•è¿›è¡Œåˆ’åˆ†ï¼Œä¹Ÿå°±æ˜¯åˆ’åˆ†æ ‡å‡†ã€‚</p>
<h2 id="äºŒã€åˆ’åˆ†æ ‡å‡†"><a href="#äºŒã€åˆ’åˆ†æ ‡å‡†" class="headerlink" title="äºŒã€åˆ’åˆ†æ ‡å‡†"></a>äºŒã€åˆ’åˆ†æ ‡å‡†</h2><h3 id="2-1-ä¿¡æ¯å¢ç›Š-ID3å†³ç­–æ ‘ç®—æ³•åˆ’åˆ†æ ‡å‡†"><a href="#2-1-ä¿¡æ¯å¢ç›Š-ID3å†³ç­–æ ‘ç®—æ³•åˆ’åˆ†æ ‡å‡†" class="headerlink" title="2.1 ä¿¡æ¯å¢ç›Š(ID3å†³ç­–æ ‘ç®—æ³•åˆ’åˆ†æ ‡å‡†)"></a>2.1 ä¿¡æ¯å¢ç›Š(ID3å†³ç­–æ ‘ç®—æ³•åˆ’åˆ†æ ‡å‡†)</h3><p>å¿…é¡»å…ˆäº†è§£ä¿¡æ¯ç†µè¿™ä¸ªæ¦‚å¿µï¼Œ<strong>ä¿¡æ¯ç†µ</strong>ï¼Œç»´åŸºç™¾ç§‘ä¸Šçš„å®šä¹‰ï¼šæ˜¯æ¥æ”¶çš„æ¯æ¡æ¶ˆæ¯ä¸­åŒ…å«çš„ä¿¡æ¯çš„å¹³å‡é‡ã€‚è¿™é‡Œï¼Œâ€œæ¶ˆæ¯â€ä»£è¡¨æ¥è‡ªåˆ†å¸ƒæˆ–æ•°æ®æµä¸­çš„äº‹ä»¶ã€æ ·æœ¬æˆ–ç‰¹å¾ã€‚ï¼ˆç†µæœ€å¥½ç†è§£ä¸ºä¸ç¡®å®šæ€§çš„é‡åº¦è€Œä¸æ˜¯ç¡®å®šæ€§çš„é‡åº¦ï¼Œå› ä¸ºè¶Šéšæœºçš„ä¿¡æºçš„ç†µè¶Šå¤§ï¼‰æ¥è‡ªä¿¡æºçš„å¦ä¸€ä¸ªç‰¹å¾æ˜¯æ ·æœ¬çš„æ¦‚ç‡åˆ†å¸ƒã€‚è¿™é‡Œçš„æƒ³æ³•æ˜¯ï¼Œæ¯”è¾ƒä¸å¯èƒ½å‘ç”Ÿçš„äº‹æƒ…ï¼Œå½“å®ƒå‘ç”Ÿäº†ï¼Œä¼šæä¾›æ›´å¤šçš„ä¿¡æ¯ã€‚ç”±äºä¸€äº›å…¶ä»–çš„åŸå› ï¼ŒæŠŠä¿¡æ¯ï¼ˆç†µï¼‰å®šä¹‰ä¸ºæ¦‚ç‡åˆ†å¸ƒçš„å¯¹æ•°çš„ç›¸åæ•°æ˜¯æœ‰é“ç†çš„ã€‚äº‹ä»¶çš„æ¦‚ç‡åˆ†å¸ƒå’Œæ¯ä¸ªäº‹ä»¶çš„ä¿¡æ¯é‡æ„æˆäº†ä¸€ä¸ªéšæœºå˜é‡ï¼Œè¿™ä¸ªéšæœºå˜é‡çš„å‡å€¼ï¼ˆå³æœŸæœ›ï¼‰å°±æ˜¯è¿™ä¸ªåˆ†å¸ƒäº§ç”Ÿçš„ä¿¡æ¯é‡çš„å¹³å‡å€¼ï¼ˆå³ç†µï¼‰ã€‚ç†µçš„æ¦‚å¿µæœ€æ—©èµ·æºäºç‰©ç†å­¦ï¼Œç”¨äºåº¦é‡ä¸€ä¸ªçƒ­åŠ›å­¦ç³»ç»Ÿçš„æ— åºç¨‹åº¦ã€‚åœ¨ä¿¡æ¯è®ºé‡Œé¢ï¼Œç†µæ˜¯å¯¹ä¸ç¡®å®šæ€§çš„æµ‹é‡ã€‚ä½†æ˜¯åœ¨ä¿¡æ¯ä¸–ç•Œï¼Œ<strong>ç†µè¶Šé«˜ï¼Œåˆ™èƒ½ä¼ è¾“è¶Šå¤šçš„ä¿¡æ¯ï¼Œç†µè¶Šä½ï¼Œåˆ™æ„å‘³ç€ä¼ è¾“çš„ä¿¡æ¯è¶Šå°‘</strong>ã€‚è¿˜æ˜¯ä¸æ‡‚ï¼Ÿé‚£ä½ ä¸å¦¨è®°ä½ï¼š<strong>ä¿¡æ¯ç†µæ˜¯å¯¹ä¿¡æ¯é‡çš„ä¸€ç§è¡¡é‡</strong></p>
<blockquote>
<p>ç»´åŸºç™¾ç§‘ï¼š<a href="https://zh.wikipedia.org/zh-cn/%E7%86%B5_(%E4%BF%A1%E6%81%AF%E8%AE%BA)">https://zh.wikipedia.org/zh-cn/%E7%86%B5_(%E4%BF%A1%E6%81%AF%E8%AE%BA)</a><br>Shannon,C.E.(1948).A Mathematical Theory of Communication. Bell System Technical Journal,27(3),379â€“423.doi:10.1002&#x2F;j.1538-7305.1948.tb01338.x</p>
</blockquote>
<p>ä¸€èˆ¬åœ°ï¼Œåˆ’åˆ†æ•°æ®é›†çš„å¤§åŸåˆ™æ˜¯ï¼š<strong>å°†æ— åºçš„æ•°æ®å˜å¾—æ›´åŠ æœ‰åº</strong>ã€‚åœ¨åˆ’åˆ†æ•°æ®é›†ä¹‹å‰ä¹‹åä¿¡æ¯å‘ç”Ÿçš„å˜åŒ–ç§°ä¸ºä¿¡æ¯å¢ç›Šï¼ŒçŸ¥é“å¦‚ä½•è®¡ç®—ä¿¡æ¯å¢ç›Šï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—æ¯ä¸ªç‰¹å¾å€¼åˆ’åˆ†æ•°æ®é›†è·å¾—çš„ä¿¡æ¯å¢ç›Šï¼Œ<strong>è·å¾—ä¿¡æ¯å¢ç›Šæœ€é«˜çš„ç‰¹å¾å°±æ˜¯æœ€å¥½çš„é€‰æ‹©</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ç”¨ä¿¡æ¯å¢ç›Šæ¥è¿›è¡Œå†³ç­–æ ‘çš„åˆ’åˆ†å±æ€§é€‰æ‹©ï¼Œä»–ä»¬å…¬å¼å¦‚ä¸‹ï¼š</p>
<p>$$<br>ä¿¡æ¯ç†µï¼šEnt(D)&#x3D;-\displaystyle\sum_{k&#x3D;1}^{|y|}p_klog_2p_k \å–è´Ÿæ•°ï¼šä¿è¯ä¿¡æ¯ç†µ&gt;0<br>$$</p>
<p>å…¶ä¸­$Ent(D)$çš„å€¼è¶Šå°ï¼Œåˆ™æ¶ˆæ¯ç†µè¶Šå°</p>
<p>$$<br>ä¿¡æ¯å¢ç›ŠGain(D,a)&#x3D;Ent(D)-\sum_{v&#x3D;1}^{V}\frac{|D^v|}{|D|}Ent(D^v) \V:ç¦»æ•£å±æ€§açš„å¯èƒ½å–å€¼çš„ä¸ªæ•°<br>$$</p>
<p>æ€ä¹ˆä½¿ç”¨ï¼Ÿå†æ¬¡å€Ÿç”¨å‘¨å¿—åè€å¸ˆä¹¦ä¸Šä¾‹å­ï¼Œæˆ‘ä»¬æ¥åŒºåˆ†å¥½ç“œåç“œã€‚</p>
<blockquote>
<img data-src="https://s2.loli.net/2023/06/04/YiKdrHCL4758yJI.png" alt="202306041908136" style="zoom:75%;">

<ul>
<li><strong>æ³¨é‡Š</strong>ï¼šæœ¬æ–‡éƒ½æ˜¯é‡‡ç”¨çš„ID3å†³ç­–æ ‘ç®—æ³•</li>
</ul>
<p>å› ä¸ºæˆ‘ä»¬çš„ç›®çš„æ˜¯åŒºåˆ†å¥½ç“œåç“œæ‰€ä»¥å…ˆè®¡ç®—å…¶ä¿¡æ¯ç†µï¼š</p>
<p>$$<br>Ent(D)&#x3D;-\sum_{k&#x3D;1}^{2}p_klog_2p_k&#x3D;-(\frac{8}{17}log_2(\frac{8}{17})+\frac{9}{17}log_2(\frac{9}{17}))&#x3D;0.998<br>$$</p>
<p>åŒç†å¯å¾—å‡è®¾æˆ‘ä»¬ä»¥è‰²æ³½è¿›è¡Œåˆ†ç±»ï¼Œé‚£ä¹ˆè‰²æ³½æœ‰ä¸‰ç§å¯èƒ½ {é’ç»¿ã€ä¹Œé»‘ã€æµ…ç™½}ï¼Œæˆ‘ä»¬å†è®¡ç®—æ¯ç§è‰²æ³½ä¸‹æ‰€å¯¹åº”å¥½åç“œçš„æ¦‚ç‡ï¼ˆ$p_1:å¥½ï¼Œp_2:å$ï¼‰ï¼šé’ç»¿ï¼š$p_1&#x3D;0.5,p_2&#x3D;0.5$ï¼›ä¹Œé»‘ï¼š$p_1&#x3D;\frac{4}{6}ï¼Œp_2&#x3D;\frac{2}{6}$ï¼›æµ…ç™½ï¼š$p_1&#x3D;\frac{1}{5},p_2&#x3D;\frac{4}{5}$ï¼›è¿™æ ·ä¸€æ¥æˆ‘ä»¬å¯ä»¥è®¡ç®—å„ç§ä¿¡æ¯å¢ç›Šï¼š</p>
<p>$$<br>Ent(é’ç»¿)&#x3D;1ï¼ŒEnt(ä¹Œé»‘)&#x3D;0.918ï¼ŒEnt(æµ…ç™½)&#x3D;0.722<br>$$</p>
<p>ç„¶åè®¡ç®—ä¿¡æ¯å¢ç›Š:</p>
<p>$$<br>Gain(D,è‰²æ³½)&#x3D;Ent(D)-\sum_{v&#x3D;1}^{V}\frac{|D^v|}{|D|}Ent(D^v)&#x3D;0.998-(\frac{6}{17}\times1+\frac{6}{17}\times0.918+\frac{5}{17}\times0.722)&#x3D;0.109<br>$$</p>
<p>$$<br>åŒç†å¯å¾—å…¶ä»–çš„ä¿¡æ¯å¢ç›Šï¼š\Gain(D,æ ¹è’‚)&#x3D;0.143;\Gain(D,æ•²å£°)&#x3D;0.141;\Gain(D,çº¹ç†)&#x3D;0.381;\Gain(D,è„éƒ¨)&#x3D;0.289;\Gain(D,è§¦æ„Ÿ)&#x3D;0.006;<br>$$</p>
<p>çº¹ç†çš„ä¿¡æ¯å¢ç›Šæœ€å¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬å–çº¹ç†ä½œä¸ºæˆ‘ä»¬çš„åˆ’åˆ†æ ‡å‡†ï¼ŒåŒç†ä»çº¹ç†å‡ºå‘å†å–è®¡ç®—å…¶ä»–å±æ€§ï¼Œå¹¶ä¸”å¾—åˆ°ä¿¡æ¯å¢ç›Šï¼Œä»¥æ­¤ç±»æ¨åªåˆ°æ‰€æœ‰æ ‡å‡†éƒ½åˆ’åˆ†å®Œæ¯•ã€‚</p>
</blockquote>
<h3 id="2-2-åŸºå°¼æŒ‡æ•°-CARTå†³ç­–æ ‘ç®—æ³•åˆ’åˆ†æ ‡å‡†"><a href="#2-2-åŸºå°¼æŒ‡æ•°-CARTå†³ç­–æ ‘ç®—æ³•åˆ’åˆ†æ ‡å‡†" class="headerlink" title="2.2 åŸºå°¼æŒ‡æ•°(CARTå†³ç­–æ ‘ç®—æ³•åˆ’åˆ†æ ‡å‡†)"></a>2.2 åŸºå°¼æŒ‡æ•°(CARTå†³ç­–æ ‘ç®—æ³•åˆ’åˆ†æ ‡å‡†)</h3><h2 id="ä¸‰ã€è¯„ä»·"><a href="#ä¸‰ã€è¯„ä»·" class="headerlink" title="ä¸‰ã€è¯„ä»·"></a>ä¸‰ã€è¯„ä»·</h2><p><strong>å†³ç­–æ ‘çš„ä¼˜ç‚¹</strong><br>1ã€å†³ç­–æ ‘æ˜“äºç†è§£å’Œå®ç°.äººä»¬åœ¨é€šè¿‡è§£é‡Šåéƒ½æœ‰èƒ½åŠ›å»ç†è§£å†³ç­–æ ‘æ‰€è¡¨è¾¾çš„æ„ä¹‰<br>2ã€å¯¹äºå†³ç­–æ ‘ï¼Œæ•°æ®çš„å‡†å¤‡å¾€å¾€æ˜¯ç®€å•æˆ–è€…æ˜¯ä¸å¿…è¦çš„.å…¶ä»–çš„æŠ€æœ¯å¾€å¾€è¦æ±‚å…ˆæŠŠæ•°æ®ä¸€èˆ¬åŒ–ï¼Œæ¯”å¦‚å»æ‰å¤šä½™çš„æˆ–è€…ç©ºç™½çš„å±æ€§<br>3ã€èƒ½å¤ŸåŒæ—¶å¤„ç†æ•°æ®å‹å’Œå¸¸è§„å‹å±æ€§ã€‚å…¶ä»–çš„æŠ€æœ¯å¾€å¾€è¦æ±‚æ•°æ®å±æ€§çš„å•ä¸€<br>4ã€æ˜¯ä¸€ä¸ªç™½ç›’æ¨¡å‹å¦‚æœç»™å®šä¸€ä¸ªè§‚å¯Ÿçš„æ¨¡å‹ï¼Œé‚£ä¹ˆæ ¹æ®æ‰€äº§ç”Ÿçš„å†³ç­–æ ‘å¾ˆå®¹æ˜“æ¨å‡ºç›¸åº”çš„é€»è¾‘è¡¨è¾¾å¼<br>5ã€æ˜“äºé€šè¿‡é™æ€æµ‹è¯•æ¥å¯¹æ¨¡å‹è¿›è¡Œè¯„æµ‹ã€‚è¡¨ç¤ºæœ‰å¯èƒ½æµ‹é‡è¯¥æ¨¡å‹çš„å¯ä¿¡åº¦<br>6ã€åœ¨ç›¸å¯¹çŸ­çš„æ—¶é—´å†…èƒ½å¤Ÿå¯¹å¤§å‹æ•°æ®æºåšå‡ºå¯è¡Œä¸”æ•ˆæœè‰¯å¥½çš„ç»“æœ<br><strong>å†³ç­–æ ‘çš„ç¼ºç‚¹</strong><br>å¯¹äºé‚£äº›å„ç±»åˆ«æ ·æœ¬æ•°é‡ä¸ä¸€è‡´çš„æ•°æ®ï¼Œåœ¨å†³ç­–æ ‘å½“ä¸­ä¿¡æ¯å¢ç›Šçš„ç»“æœåå‘äºé‚£äº›å…·æœ‰æ›´å¤šæ•°å€¼çš„ç‰¹å¾</p>
<p>æ–‡ç« å¦‚è‹¥æœ‰é”™è¯¯ï¼Œæ¬¢è¿å¤§ä½¬ä»¬æ‰¹è¯„æŒ‡æ­£ã€‚ğŸ’ªğŸ’ª</p>
<h2 id="å››ã€ä»£ç "><a href="#å››ã€ä»£ç " class="headerlink" title="å››ã€ä»£ç "></a>å››ã€ä»£ç </h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è®¡ç®—ä¿¡æ¯ç†µ</span></span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ent</span>(<span class="params">data</span>):</span><br><span class="line">    data_length = <span class="built_in">len</span>(data)</span><br><span class="line">    dic = &#123;&#125;</span><br><span class="line">    <span class="comment">#ç»Ÿè®¡ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">        data_leable = i[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> data_leable <span class="keyword">not</span> <span class="keyword">in</span> dic:</span><br><span class="line">            dic[data_leable] = <span class="number">0</span></span><br><span class="line">        dic[data_leable] +=<span class="number">1</span></span><br><span class="line">   <span class="comment">#return dic</span></span><br><span class="line">    <span class="comment">#è®¡ç®—ä¿¡æ¯ç†µ</span></span><br><span class="line">    ent_number = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">        num1 = <span class="built_in">float</span>(dic[j])/data_length</span><br><span class="line">        ent_number = ent_number - num1*log(num1,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> ent_number</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#åˆ’åˆ†æ•°æ®é›†åˆ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">data_split</span>(<span class="params">data, axis, value</span>):</span><br><span class="line">    data_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">if</span> i[axis] == value:</span><br><span class="line">            feat = i[:axis]</span><br><span class="line">            feat.extend(i[axis+<span class="number">1</span>:])</span><br><span class="line">            data_list.append(feat)</span><br><span class="line">    <span class="keyword">return</span> data_list</span><br><span class="line"></span><br><span class="line"><span class="comment">#extendä¸appendå‡½æ•°åŒºåˆ«ï¼ša.extend(b):å°†bçš„å€¼å…¨éƒ¨åŠ åˆ°aä¸­ï¼›a.append(b):å°†båˆ—è¡¨åŠ åˆ°aä¸­</span></span><br><span class="line"><span class="comment"># a = [1,2]</span></span><br><span class="line"><span class="comment"># b = [3,4]</span></span><br><span class="line"><span class="comment"># c = [3,4]</span></span><br><span class="line"><span class="comment"># a.append(b)</span></span><br><span class="line"><span class="comment"># c.extend(b)</span></span><br><span class="line"><span class="comment"># print(a,c)</span></span><br><span class="line"><span class="comment"># [1, 2, [3, 4]] [3, 4, 3, 4]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è®¡ç®—ä¿¡å¢ç›Š,å¹¶ä¸”æŒ‘é€‰æœ€ä½³ç‰¹å¾</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gain_chose</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    data_ent:ä¿¡æ¯ç†µ</span></span><br><span class="line"><span class="string">    feat_list:æ¯ä¸€ç§æ ‡ç­¾çš„å…¨éƒ¨æ•°æ®</span></span><br><span class="line"><span class="string">    feat_value:æ¯ä¸€ç§æ ‡ç­¾ä¸‹çš„å–å€¼</span></span><br><span class="line"><span class="string">    data_gain:ä¿¡æ¯å¢ç›Š</span></span><br><span class="line"><span class="string">    ent_number:è®¡ç®—å„è‡ªåˆ—ä¸‹çš„ä¿¡æ¯ç†µ</span></span><br><span class="line"><span class="string">    prop:è®¡ç®—æ¦‚ç‡</span></span><br><span class="line"><span class="string">    best_feature:æœ€ä½³åˆ’åˆ†ç‰¹å¾</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    data_base_length = <span class="built_in">len</span>(data[<span class="number">0</span>])-<span class="number">1</span></span><br><span class="line">    ent_base = ent(data)</span><br><span class="line">    gain_max = -<span class="number">1</span> <span class="comment">#å–ä»»ä½•å°äº0çš„å€¼éƒ½å¯ä»¥</span></span><br><span class="line">    <span class="comment">#ç¬¬ä¸€ä¸ªforå¾ªç¯å¾—åˆ°æ¯ä¸€åˆ—ï¼Œç¬¬äºŒä¸ªforå¾ªç¯åˆ™æ˜¯å¯¹æ¯ä¸€åˆ—ä¸­å–å€¼</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(data_base_length):</span><br><span class="line">        feat_list = [a[i] <span class="keyword">for</span> a <span class="keyword">in</span> data]</span><br><span class="line">        feat_value = <span class="built_in">set</span>(feat_list)</span><br><span class="line">        ent_number = <span class="number">0.0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> feat_value:</span><br><span class="line">            data_split_use = data_split(data, i, j)</span><br><span class="line">            prop = <span class="built_in">len</span>(data_split_use)/<span class="built_in">float</span>(<span class="built_in">len</span>(data_split_use))</span><br><span class="line">            ent_number = ent_number + prop * ent(data_split_use)</span><br><span class="line">        data_gain = ent_base - ent_number </span><br><span class="line">        <span class="keyword">if</span> data_gain &gt; gain_max:</span><br><span class="line">            gain_max = data_gain</span><br><span class="line">            best_feature = i</span><br><span class="line">    <span class="keyword">return</span> best_feature</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ç»˜åˆ¶å†³ç­–æ ‘</span></span><br><span class="line"><span class="keyword">import</span> operator</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">majorityCnt</span>(<span class="params">classList</span>):</span><br><span class="line">    classCount=&#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> vote <span class="keyword">in</span> classList:</span><br><span class="line">        <span class="keyword">if</span> vote <span class="keyword">not</span> <span class="keyword">in</span> classCount.keys(): classCount[vote] = <span class="number">0</span></span><br><span class="line">        classCount[vote] += <span class="number">1</span></span><br><span class="line">    sortedClassCount = <span class="built_in">sorted</span>(classCount.iteritems(), key=operator.itemgetter(<span class="number">1</span>), reverse=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> sortedClassCount[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createTree</span>(<span class="params">dataSet,labels</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    classList:å­˜å‚¨datasetä¸­çš„æ ‡ç­¾</span></span><br><span class="line"><span class="string">    bestFeatLabel:æ ¹èŠ‚ç‚¹</span></span><br><span class="line"><span class="string">    myTree:å­˜å‚¨æ ‘ç»“æ„</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    classList = [example[-<span class="number">1</span>] <span class="keyword">for</span> example <span class="keyword">in</span> dataSet]</span><br><span class="line">    <span class="comment"># å¦‚æœå…¨æ˜¯ä¸€ä¸ªç‰¹å¾ï¼Œç›´æ¥è¿”å›</span></span><br><span class="line">    <span class="keyword">if</span> classList.count(classList[<span class="number">0</span>]) == <span class="built_in">len</span>(classList): </span><br><span class="line">        <span class="keyword">return</span> classList[<span class="number">0</span>]</span><br><span class="line">    <span class="comment"># å¦‚æœæ•°ç»„é•¿åº¦ä¸º1ï¼Œåˆ™</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(dataSet[<span class="number">0</span>]) == <span class="number">1</span>: </span><br><span class="line">        <span class="keyword">return</span> majorityCnt(classList)</span><br><span class="line"></span><br><span class="line">    bestFeat = gain_chose(dataSet)</span><br><span class="line">    bestFeatLabel = labels[bestFeat]     <span class="comment"># æŒ‘é€‰å‡ºæ ¹èŠ‚ç‚¹</span></span><br><span class="line">    myTree = &#123;bestFeatLabel:&#123;&#125;&#125;</span><br><span class="line">    <span class="keyword">del</span>(labels[bestFeat]) <span class="comment"># åˆ é™¤ä»¥å…å†æ¬¡é€‰åˆ°</span></span><br><span class="line"></span><br><span class="line">    featValues = [example[bestFeat] <span class="keyword">for</span> example <span class="keyword">in</span> dataSet]</span><br><span class="line">    uniqueVals = <span class="built_in">set</span>(featValues)</span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> uniqueVals:</span><br><span class="line">        subLabels = labels[:] </span><br><span class="line">        myTree[bestFeatLabel][value] = createTree(data_split(dataSet, bestFeat, value),subLabels)</span><br><span class="line">    <span class="keyword">return</span> myTree   </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€å†³ç­–æ ‘ç®—æ³•æµç¨‹"><a href="#äº”ã€å†³ç­–æ ‘ç®—æ³•æµç¨‹" class="headerlink" title="äº”ã€å†³ç­–æ ‘ç®—æ³•æµç¨‹"></a>äº”ã€å†³ç­–æ ‘ç®—æ³•æµç¨‹</h2><p>ç¬¬ä¸€æ­¥ï¼šè®¡ç®—ä¿¡æ¯ç†µï¼šåˆ©ç”¨<strong>å“ˆå¸Œè¡¨</strong>å¾—åˆ°åˆ†ç±»æ ‡ç­¾çš„å¯¹åº”æ•°é‡å…³ç³»ï¼Œè€Œåæ„Ÿè§‰å¯¹åº”çš„æ•°é‡å…³ç³»è®¡ç®—ä¿¡æ¯ç†µã€‚<br>ç¬¬äºŒæ­¥ï¼šè®¡ç®—ä¿¡æ¯å¢ç›Šå¹¶ä¸”æŒ‘é€‰å‡ºæœ€ä½³ç‰¹å¾ï¼šåˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ã€‚ç¬¬ä¸€æ­¥ï¼šåˆ’åˆ†æ•°æ®é›†åˆï¼Œç¬¬äºŒæ­¥è®¡ç®—</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼šä»¥è¥¿ç“œä¾‹å­è¯´æ˜ï¼Œæˆ‘ä»¬åœ¨æŒ‘é€‰å¥½ â€˜yesâ€™orâ€™noâ€™ ä¹‹åï¼Œæˆ‘ä»¬è¦å›è¿‡å¤´è§‚å¯Ÿå‰é¢ç‰¹å¾çš„é›†åˆï¼ˆè‰²æ³½ï¼šaï¼‰ï¼Œè€Œååœ¨è‰²æ³½ï¼šaä¸­åˆ†åˆ«è®¡ç®—æ»¡è¶³â€™yesâ€™orâ€™noâ€™çš„ä¿¡æ¯ç†µã€‚ä¾æ¬¡ç±»æ¨åˆ†åˆ«å¾—åˆ°çº¹ç†ç­‰ç‰¹å¾çš„ä¿¡æ¯ç†µã€‚</li>
<li>ç¬¬äºŒæ­¥ï¼šåœ¨æˆ‘ä»¬å‰ä¸€æ­¥æ‰€å¾—åˆ°çš„ä¿¡æ¯ç†µä¸­è®¡ç®—ä¿¡æ¯å¢ç›Š</li>
<li>ç¬¬ä¸‰æ­¥ï¼šæŒ‘é€‰ä¿¡æ¯å¢ç›Šæœ€å¤§çš„å€¼<br>ç¬¬ä¸‰æ­¥ï¼šæŒ‘é€‰å¥½æœ€ä½³ç‰¹å¾ä¹‹åå¼€å§‹ç»˜åˆ¶å†³ç­–æ ‘</li>
</ul>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><blockquote>
<p>å‘¨å¿—å ã€Šè¥¿ç“œä¹¦ã€‹</p>
<p>ã€Šæœºå™¨å­¦ä¹ å®æˆ˜ã€‹</p>
</blockquote>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>è¯„ä»·æ ‡å‡†</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆè¯†æ·±åº¦å­¦ä¹ </title>
    <url>/posts/3065358813/</url>
    <content><![CDATA[<h1 id="åˆè¯†æ·±åº¦å­¦ä¹ "><a href="#åˆè¯†æ·±åº¦å­¦ä¹ " class="headerlink" title="åˆè¯†æ·±åº¦å­¦ä¹ "></a>åˆè¯†æ·±åº¦å­¦ä¹ </h1><span id="more"></span>
<hr>
<p><strong>æ³¨ï¼š</strong></p>
<p>1ã€æœ¬æ–‡ä¸ºä¸ªäººå­¦ä¹ ç¬”è®°ï¼Œæ‰€ä»¥å†…å®¹å¤§å¤šæ¯”è¾ƒç®€ç»ƒä¸åšè¿‡å¤šè§£é‡Š</p>
<p>2ã€æ–‡ç« å‚è€ƒä¹¦ç±ï¼š1ã€ã€Špythonæ·±åº¦å­¦ä¹ ã€‹[ç¾] å¼—æœ—ç´¢ç“¦Â·è‚–è±ã€€è‘— å¼ äº® è¯‘ï¼›2ã€ã€Šæ·±åº¦å­¦ä¹ ã€‹(èŠ±ä¹¦)</p>
<p>3ã€éƒ¨åˆ†å†…å®¹è‡ªå·±é˜…è¯»å‚è€ƒæ–‡çŒ®è¿›è¡Œè¡¥å……</p>
<p>4ã€å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯<strong>åŸºäºpytorch</strong>è¿›è¡Œç¼–å†™&lt;å…ˆå­¦åŸç†åå­¦ä»£ç &gt;</p>
<p>nã€åç»­ç”¨åˆ°ä»€ä¹ˆå°±ç»§ç»­ç»§ç»­è¡¥å……</p>
<hr>
<p>[toc]</p>
<h2 id="ä¸€ã€åˆè¯†ç¥ç»ç½‘ç»œ"><a href="#ä¸€ã€åˆè¯†ç¥ç»ç½‘ç»œ" class="headerlink" title="ä¸€ã€åˆè¯†ç¥ç»ç½‘ç»œ"></a>ä¸€ã€åˆè¯†ç¥ç»ç½‘ç»œ</h2><h3 id="1-1-ç¥ç»ç½‘ç»œçš„å·¥ä½œåŸç†"><a href="#1-1-ç¥ç»ç½‘ç»œçš„å·¥ä½œåŸç†" class="headerlink" title="1.1 ç¥ç»ç½‘ç»œçš„å·¥ä½œåŸç†"></a>1.1 ç¥ç»ç½‘ç»œçš„å·¥ä½œåŸç†</h3><p><img data-src="https://s2.loli.net/2023/06/04/wCQ1ymusatMEjkX.png" alt="1680779540890"></p>
<ul>
<li>ä¼˜åŒ–å™¨ï¼šéšæœºæ¢¯åº¦ä¸‹é™ã€ç‰›é¡¿æ³•</li>
<li>å±‚ï¼šå¯ä»¥å–ç±»æ¯”å¤šå±‚æ„ŸçŸ¥æœºæ¨¡å‹ä¸­çš„éšè—å±‚</li>
<li>æ•°æ®å˜æ¢ï¼šæ¿€æ´»å‡½æ•°</li>
</ul>
<p>è¿›ä¸€æ­¥è§£é‡Šè§ï¼š2.2.3 åŸºäºæ¢¯åº¦ä¼˜åŒ–</p>
<h3 id="1-2-ç¥ç»ç½‘ç»œåŸºç¡€çŸ¥è¯†"><a href="#1-2-ç¥ç»ç½‘ç»œåŸºç¡€çŸ¥è¯†" class="headerlink" title="1.2 ç¥ç»ç½‘ç»œåŸºç¡€çŸ¥è¯†"></a>1.2 ç¥ç»ç½‘ç»œåŸºç¡€çŸ¥è¯†</h3><h4 id="1-2-1-å¼ é‡"><a href="#1-2-1-å¼ é‡" class="headerlink" title="1.2.1 å¼ é‡"></a>1.2.1 å¼ é‡</h4><p>å…³äºå¼ é‡çš„äº†è§£å…¶å®æ²¡å¿…è¦è¿‡å¤šå»è§£é‡Šä»–åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆæ ·å­çš„ï¼Œpythonç¼–ç¨‹è¿‡ç¨‹ä¸­å¯ä»¥ç›´æ¥å°†å…¶ä¸numpyçš„çŸ©é˜µä¸€èµ·äº†è§£(<strong>ä¸‹ä»¥pytorchä¸ºä¾‹</strong>)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line">a = torch.ones(<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">a</span><br><span class="line">&gt;tensor([[<span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">1.</span>]])</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å¼ é‡çš„ä¸€äº›åŸºæœ¬æ€§è´¨è¿˜æ˜¯éœ€è¦äº†è§£ï¼š</p>
<ul>
<li><strong>è½´çš„ä¸ªæ•°ï¼ˆé˜¶ï¼‰</strong>ã€‚ä¾‹å¦‚ï¼Œ3D å¼ é‡æœ‰ 3 ä¸ªè½´ï¼ŒçŸ©é˜µæœ‰ 2 ä¸ªè½´ã€‚è¿™åœ¨ Numpy ç­‰ Python åº“ä¸­ä¹Ÿå«å¼ é‡çš„ ndimã€‚</li>
<li><strong>å½¢çŠ¶</strong>ã€‚è¿™æ˜¯ä¸€ä¸ªæ•´æ•°å…ƒç»„ï¼Œè¡¨ç¤ºå¼ é‡æ²¿æ¯ä¸ªè½´çš„ç»´åº¦å¤§å°ï¼ˆå…ƒç´ ä¸ªæ•°ï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸Šè¿°åˆ—å­å°±æ˜¯ä¸€ä¸ªäºŒç»´çš„3x2</li>
<li><strong>æ•°æ®ç±»å‹</strong>ã€‚è¿™æ˜¯å¼ é‡ä¸­æ‰€åŒ…å«æ•°æ®çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼Œå¼ é‡çš„ç±»å‹å¯ä»¥æ˜¯ float32ã€uint8ã€float64 ç­‰ã€‚åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°å­—ç¬¦ï¼ˆcharï¼‰å¼ é‡ã€‚æ³¨æ„ï¼ŒNumpyï¼ˆä»¥åŠå¤§å¤šæ•°å…¶ä»–åº“ï¼‰ä¸­ä¸å­˜åœ¨å­—ç¬¦ä¸²å¼ é‡ï¼Œå› ä¸ºå¼ é‡å­˜å‚¨åœ¨é¢„å…ˆåˆ†é…çš„è¿ç»­å†…å­˜æ®µä¸­ï¼Œè€Œå­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯å¯å˜çš„ï¼Œæ— æ³•ç”¨è¿™ç§æ–¹å¼å­˜å‚¨ã€‚</li>
</ul>
<blockquote>
<p><strong>pytorchçš„å…·ä½“è¯­æ³•ï¼Œåç»­ç»§ç»­è¡¥å……</strong></p>
</blockquote>
<h5 id="1-2-1-1-æ—¶é—´åºåˆ—æ•°æ®"><a href="#1-2-1-1-æ—¶é—´åºåˆ—æ•°æ®" class="headerlink" title="1.2.1.1 æ—¶é—´åºåˆ—æ•°æ®"></a>1.2.1.1 æ—¶é—´åºåˆ—æ•°æ®</h5><p>ä»¥è‚¡ç¥¨äº¤æ˜“ä¸ºä¾‹ï¼šæ¯æ—¶æ¯åˆ»éƒ½å­˜åœ¨äº¤æ˜“ï¼Œå¹¶ä¸”æ¯æ—¶æ¯åˆ»å¯¹äºä¸åŒçš„è‚¡ç¥¨ä¹Ÿéƒ½å­˜åœ¨ä¹°å…¥ã€å–å‡ºã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å€ŸåŠ©3Då¼ é‡è¿›è¡Œè¡¨ç¤ºï¼š</p>
<img data-src="https://s2.loli.net/2023/06/04/d3XRzVQlGiwokWy.png" alt="202306041904592" style="zoom:100%;">

<ul>
<li><strong>æ—¶é—´æ­¥é•¿</strong>ï¼šå¯ä»¥å‡è®¾æ˜¯1åˆ†é’Ÿå†…è¿›è¡Œäº¤æ˜“</li>
<li><strong>ç‰¹å¾</strong>ï¼šæŸä¸€ä¸ªè‚¡ç¥¨è¿›è¡Œçš„äº¤æ˜“</li>
<li><strong>æ ·æœ¬</strong>ï¼šä¸åŒçš„å±‚å¯ä»¥è¡¨ç¤ºæ˜¯ä¸åŒè‚¡ç¥¨ï¼šèŒ…å°ã€‚ã€‚ã€‚ã€‚ã€‚</li>
</ul>
<h5 id="1-2-1-2-å›¾åƒæ•°æ®"><a href="#1-2-1-2-å›¾åƒæ•°æ®" class="headerlink" title="1.2.1.2 å›¾åƒæ•°æ®"></a>1.2.1.2 å›¾åƒæ•°æ®</h5><p>ä¸€å¼ <strong>å½©è‰²</strong>å›¾ç‰‡å¯ä»¥ç”±3éƒ¨åˆ†æ„æˆï¼šé«˜åº¦ã€å®½åº¦ã€é¢œè‰²æ·±åº¦ï¼ˆç°åº¦å›¾åƒåªæœ‰ä¸€ä¸ªé¢œè‰²é€šé“å¯ä»¥å–æ¶ˆé¢œè‰²æ·±åº¦ï¼‰ï¼Œé‚£ä¹ˆå›¾ç‰‡ä¹Ÿæ˜¯3Då¼ é‡ï¼š</p>
<img data-src="https://s2.loli.net/2023/06/04/6ojruqShLPxmCdO.png" alt="202306041905909" style="zoom:100%;">

<blockquote>
<p>å‡è®¾å›¾ç‰‡ä¸º<strong>å½©è‰²</strong>ï¼Œå¤§å°ä¸º256x256ã€‚é‚£ä¹ˆæˆ‘ä»¬å¼ é‡å¯ä»¥å¦‚æ­¤è¡¨ç¤ºï¼šï¼ˆn, 256, 256, 3)ã€‚nï¼šå›¾ç‰‡æ•°ç›®ï¼›3ï¼šå½©è‰²å›¾ç‰‡ä¸€èˆ¬3ç§é¢œè‰²ï¼ˆå…‰çš„3åŸè‰²ï¼‰</p>
</blockquote>
<blockquote>
<p><a href="https://baike.baidu.com/item/%E4%B8%89%E5%8E%9F%E8%89%B2%E5%8E%9F%E7%90%86/6969780">ä¸‰åŸè‰²åŸç†_ç™¾åº¦ç™¾ç§‘ (baidu.com)</a></p>
</blockquote>
<p>$$<br>\textcolor{red}{æ³¨æ„}\text{:PyTorch æ¨¡å—è¦æ±‚å¼ é‡æ’åˆ—ä¸º CÃ—HÃ—Wï¼ˆåˆ†åˆ«è¡¨ç¤ºé€šé“ã€é«˜åº¦å’Œå®½åº¦ï¼‰è€Œtensorflowåˆ™æ˜¯ï¼šHÃ—WxC}<br>$$</p>
<h5 id="1-2-1-3-è§†é¢‘æ•°æ®"><a href="#1-2-1-3-è§†é¢‘æ•°æ®" class="headerlink" title="1.2.1.3 è§†é¢‘æ•°æ®"></a>1.2.1.3 è§†é¢‘æ•°æ®</h5><p>è§†é¢‘æ˜¯ä¸€å¸§ä¸€å¸§æ‰€æ„æˆçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çœ‹åˆ°çš„è§†é¢‘éƒ½æ˜¯ä¸€å¼ ä¸€å¼ çš„å›¾ç‰‡ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªè§†é¢‘æ˜¯ä¸€ä¸ª4Då¼ é‡ï¼ˆä¸åŒè§†é¢‘æ„æˆ5Då¼ é‡ï¼‰</p>
<h4 id="1-2-2-å¼ é‡çš„è¿ç®—"><a href="#1-2-2-å¼ é‡çš„è¿ç®—" class="headerlink" title="1.2.2 å¼ é‡çš„è¿ç®—"></a>1.2.2 å¼ é‡çš„è¿ç®—</h4><blockquote>
<p>åç»­è¡¥å……ï¼</p>
<p><a href="https://www.w3cschool.cn/pytorch/pytorch-5ubt3bby.html">1ã€PyTorchæ˜¯ä»€ä¹ˆï¼Ÿ_w3cschool</a></p>
</blockquote>
<h4 id="1-2-3-åŸºäºæ¢¯åº¦ä¼˜åŒ–"><a href="#1-2-3-åŸºäºæ¢¯åº¦ä¼˜åŒ–" class="headerlink" title="1.2.3 åŸºäºæ¢¯åº¦ä¼˜åŒ–"></a>1.2.3 åŸºäºæ¢¯åº¦ä¼˜åŒ–</h4><p>åœ¨æ­¤å¼•ç”¨ç¥ç»ç½‘ç»œå·¥ä½œåŸç†å›¾ï¼š</p>
<img data-src="https://s2.loli.net/2023/06/04/wCQ1ymusatMEjkX.png" alt="202306041900967" style="zoom:100%;">


<p>åœ¨å¤šå±‚æ„ŸçŸ¥æœºæ¨¡å‹ä¸­æœ‰3ç±»å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°ï¼šSigmoidã€Reluã€Tannhã€‚å‡è®¾å·ç§¯ç¥ç»ç½‘ç»œåªæœ‰2å±‚ï¼š$f(x)&#x3D;f^{(1)}(f^{(2)}(x,w,b))$æ­¤å¤„æˆ‘ä»¬çš„$f^{(2)}$å°±æ˜¯æˆ‘ä»¬çš„æ¿€æ´»å‡½æ•°ï¼Œè€Œ$w,b$å°±æ˜¯æˆ‘ä»¬çš„æƒé‡ã€‚ä¸€å¼€å§‹ï¼Œè¿™äº›æƒé‡çŸ©é˜µå–è¾ƒå°çš„<strong>éšæœºå€¼</strong>ï¼Œè¿™ä¸€æ­¥å«ä½œ<strong>éšæœºåˆå§‹åŒ–</strong>ï¼Œä»–ä»¬è‚¯å®šä¸ä¼šå¾—åˆ°ä»»ä½•æœ‰ç”¨çš„è¡¨ç¤ºã€‚è™½ç„¶å¾—åˆ°çš„è¡¨ç¤ºæ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªèµ·ç‚¹ã€‚ä¸‹ä¸€æ­¥åˆ™æ˜¯æ ¹æ®åé¦ˆä¿¡å·é€æ¸è°ƒèŠ‚è¿™äº›æƒé‡ã€‚è¿™ä¸ªé€æ¸è°ƒèŠ‚çš„è¿‡ç¨‹å«ä½œ<strong>è®­ç»ƒ</strong>ï¼Œä¹Ÿå°±æ˜¯æœºå™¨å­¦ä¹ ä¸­çš„å­¦ä¹ ã€‚</p>
<p>ä¸Šè¿°è¿‡ç¨‹å‘ç”Ÿåœ¨ä¸€ä¸ªè®­ç»ƒå¾ªç¯ï¼ˆtraining loopï¼‰å†…ï¼Œå…¶å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ã€‚å¿…è¦æ—¶ä¸€ç›´é‡å¤è¿™äº›æ­¥éª¤ã€‚</p>
<ul>
<li>(1) æŠ½å–è®­ç»ƒæ ·æœ¬ x å’Œå¯¹åº”ç›®æ ‡ y ç»„æˆçš„æ•°æ®æ‰¹é‡ã€‚</li>
<li>(2) åœ¨ x ä¸Šè¿è¡Œç½‘ç»œï¼»è¿™ä¸€æ­¥å«ä½œ<strong>å‰å‘ä¼ æ’­</strong>ï¼½ï¼Œå¾—åˆ°é¢„æµ‹å€¼ y_predã€‚</li>
<li>(3) è®¡ç®—ç½‘ç»œåœ¨è¿™æ‰¹æ•°æ®ä¸Šçš„<em>æŸå¤±</em>ï¼Œç”¨äºè¡¡é‡ y_pred å’Œ y ä¹‹é—´çš„è·ç¦»ã€‚</li>
<li>(4) æ›´æ–°ç½‘ç»œçš„æ‰€æœ‰æƒé‡ï¼Œä½¿ç½‘ç»œåœ¨è¿™æ‰¹æ•°æ®ä¸Šçš„æŸå¤±ç•¥å¾®ä¸‹é™</li>
</ul>
<blockquote>
<p><em>å…³äºæƒé‡æ·±åº¦å­¦ä¹ æœ‰ä½•ä¸åŒ</em></p>
<p>å…ˆå‰çš„æœºå™¨å­¦ä¹ æŠ€æœ¯ï¼ˆæµ…å±‚å­¦ä¹ ï¼‰ä»…åŒ…å«å°†è¾“å…¥æ•°æ®å˜æ¢åˆ°ä¸€ä¸¤ä¸ªè¿ç»­çš„è¡¨ç¤ºç©ºé—´ï¼Œé€šå¸¸ä½¿ç”¨ç®€å•çš„å˜æ¢ï¼Œæ¯”å¦‚é«˜ç»´éçº¿æ€§æŠ•å½±ï¼ˆSVMï¼‰æˆ–å†³ç­–æ ‘ã€‚ä½†è¿™äº›æŠ€æœ¯é€šå¸¸æ— æ³•å¾—åˆ°å¤æ‚é—®é¢˜æ‰€éœ€è¦çš„ç²¾ç¡®è¡¨ç¤ºã€‚å› æ­¤ï¼Œäººä»¬å¿…é¡»ç«­å°½å…¨åŠ›è®©åˆå§‹è¾“å…¥æ•°æ®æ›´é€‚åˆç”¨è¿™äº›æ–¹æ³•å¤„ç†ï¼Œä¹Ÿå¿…é¡»æ‰‹åŠ¨ä¸ºæ•°æ®è®¾è®¡å¥½çš„è¡¨ç¤ºå±‚ã€‚è¿™å«ä½œ<strong>ç‰¹å¾å·¥ç¨‹</strong>ï¼Œæ·±åº¦å­¦ä¹ å®Œå…¨å°†è¿™ä¸ªæ­¥éª¤è‡ªåŠ¨åŒ–ã€‚</p>
</blockquote>
<p>ä¸Šè¿°æ­¥éª¤å¤æ‚åœ¨äºæ›´æ–°æƒé‡ï¼æˆ‘ä»¬æ›´æ–°æƒé‡çš„ç›®çš„ï¼šä½¿å¾—æŸå¤±å‡½æ•°æœ€å°ã€‚æˆ‘ä»¬ä½¿ç”¨å¾—æ–¹æ³•æ˜¯ï¼š<strong>éšæœºæ¢¯åº¦ä¸‹é™ï¼š</strong></p>
<ul>
<li>(1) æŠ½å–è®­ç»ƒæ ·æœ¬ x å’Œå¯¹åº”ç›®æ ‡ y ç»„æˆçš„æ•°æ®æ‰¹é‡ã€‚</li>
<li>(2) åœ¨ x ä¸Šè¿è¡Œç½‘ç»œï¼Œå¾—åˆ°é¢„æµ‹å€¼ y_predã€‚</li>
<li>(3) è®¡ç®—ç½‘ç»œåœ¨è¿™æ‰¹æ•°æ®ä¸Šçš„æŸå¤±ï¼Œç”¨äºè¡¡é‡ y_pred å’Œ y ä¹‹é—´çš„è·ç¦»ã€‚</li>
<li>(4) è®¡ç®—æŸå¤±ç›¸å¯¹äºç½‘ç»œå‚æ•°çš„æ¢¯åº¦ï¼»ä¸€æ¬¡<strong>åå‘ä¼ æ’­</strong>ï¼½ã€‚</li>
<li>(5) å°†å‚æ•°æ²¿ç€æ¢¯åº¦çš„åæ–¹å‘ç§»åŠ¨ä¸€ç‚¹ï¼Œæ¯”å¦‚ W -&#x3D; step * gradientï¼Œä»è€Œä½¿è¿™æ‰¹æ•°æ®ä¸Šçš„æŸå¤±å‡å°ä¸€ç‚¹ã€‚</li>
</ul>
<p>å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­ï¼š</p>
<ul>
<li>å‰å‘ä¼ æ’­ï¼šè¾“å…¥æä¾›çš„åˆå§‹ä¿¡æ¯xï¼Œç„¶åä¼ æ’­ç»™æ¯ä¸€å±‚å¾—éšè—å•å…ƒï¼Œæœ€ç»ˆäº§å‡ºè¾“å‡ºy</li>
<li>åå‘ä¼ æ’­ï¼šå…è®¸æ¥è‡ªä»£ä»·å‡½æ•°çš„ä¿¡æ¯é€šè¿‡ç½‘ç»œå‘åæµåŠ¨ï¼Œä»¥ä¾¿è®¡ç®—æ¢¯åº¦</li>
</ul>
<blockquote>
<p>è®¾å­˜åœ¨æ¨¡å‹ï¼š$\widehat{y}&#x3D;wx+b$ï¼Œè®¾æŸå¤±å‡½æ•°ä¸ºï¼š$J&#x3D;\frac{1}{2}(y-\widehat{y})^2$ã€‚</p>
<p><strong>å‰å‘ä¼ æ’­</strong>ï¼šæˆ‘ä»¬ç›´æ¥è¾“å…¥$x$æœ€åè¿”å›y</p>
<p><strong>åå‘ä¼ æ’­</strong>ï¼šæˆ‘ä»¬åœ¨åˆå§‹åŒ–å‚æ•°ï¼š$w,b$æ—¶å€™æ‰€å¾—åˆ°$\widehat{y}$æŸå¤±å‡½æ•°å€¼æ¯”è¾ƒå¤§ã€‚é‚£ä¹ˆæ ¹æ®æ¢¯åº¦ä¸‹é™æˆ‘ä»¬éœ€è¦å¯¹$wï¼Œb$è¿›è¡Œæ›´æ–°äºæ˜¯å°±æœ‰ï¼šæ¢¯åº¦ï¼š$\nabla_{w}J &#x3D;\dfrac{\partial J}{\partial \widehat{y}}\dfrac{\partial \widehat{y}}{\partial {w}}$ï¼Œæ‰€ä»¥ï¼š$w&#x3D;w-\epsilon\nabla_{w}J$ï¼Œæˆ‘ä»¬è®¡ç®—æ¢¯åº¦çš„è¿‡ç¨‹å°±æ˜¯åå‘ä¼ æ’­è¿‡ç¨‹</p>
</blockquote>
<h2 id="äºŒã€æœºå™¨å­¦ä¹ è¡¥å……"><a href="#äºŒã€æœºå™¨å­¦ä¹ è¡¥å……" class="headerlink" title="äºŒã€æœºå™¨å­¦ä¹ è¡¥å……"></a>äºŒã€æœºå™¨å­¦ä¹ è¡¥å……</h2><h3 id="2-1-æœºå™¨å­¦ä¹ æ¨¡å‹è¯„ä¼°"><a href="#2-1-æœºå™¨å­¦ä¹ æ¨¡å‹è¯„ä¼°" class="headerlink" title="2.1 æœºå™¨å­¦ä¹ æ¨¡å‹è¯„ä¼°"></a>2.1 æœºå™¨å­¦ä¹ æ¨¡å‹è¯„ä¼°</h3><p>æœºå™¨å­¦ä¹ çš„ç›®çš„æ˜¯å¾—åˆ°å¯ä»¥<strong>æ³›åŒ–çš„æ¨¡å‹</strong>ï¼Œå³åœ¨å‰æ‰€æœªè§çš„æ•°æ®ä¸Šè¡¨ç°å¾ˆå¥½ã€‚åœ¨æœºå™¨å­¦ä¹ è¿‡ç¨‹ä¸­æˆ‘ä»¬ç»å¸¸éœ€è¦å¯¹æ•°æ®è¿›è¡Œåˆ‡åˆ†ï¼šåˆ’åˆ†è®­ç»ƒé›†ã€æµ‹è¯•é›†ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split </span><br><span class="line">x_train, x_test, y_train, y_test= train_test_split(x,y,test_size=<span class="number">0.2</span>) <span class="comment">#é€‰å–20%çš„æ•°æ®ä½œä¸ºæµ‹è¯•æ•°æ®</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>åˆ‡åˆ†æœ‰ä¸¤ç§ï¼š</p>
<p>1ã€ç®€å•çš„ç•™å‡ºéªŒè¯ï¼ˆä¸Šè¿°ä»£ç ï¼‰</p>
<p>2ã€<strong>K æŠ˜éªŒè¯</strong></p>
<p>å°†æ•°æ®åˆ’åˆ†ä¸ºå¤§å°ç›¸åŒçš„ K ä¸ªåˆ†åŒºã€‚å¯¹äºæ¯ä¸ªåˆ†åŒº iï¼Œåœ¨å‰©ä½™çš„ K-1 ä¸ªåˆ†åŒºä¸Šè®­ç»ƒæ¨¡å‹ï¼Œç„¶ååœ¨åˆ†åŒº i ä¸Šè¯„ä¼°æ¨¡å‹ã€‚æœ€ç»ˆåˆ†æ•°ç­‰äº K ä¸ªåˆ†æ•°çš„å¹³å‡å€¼ã€‚</p>
<p><img data-src="/%E5%88%9D%E8%AF%86%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/1680867838870.png" alt="1680867838870"></p>
</blockquote>
<p>æˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„æ˜¯æˆ‘ä»¬è®¾è®¡çš„æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šã€è®­ç»ƒé›†ä¸Šçš„æµ‹è¯•æ•ˆæœéƒ½æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­æ¶‰åŠä¸¤ä¸ªé—®é¢˜ï¼š1ã€<strong>æ¬ æ‹Ÿåˆ</strong>ï¼šæ¨¡å‹ä¸èƒ½å†è®­ç»ƒé›†ä¸Šæˆ–è€…è¶³å¤Ÿä½çš„è¯¯å·®ï¼›2ã€<strong>è¿‡æ‹Ÿåˆ</strong>ï¼šè®­ç»ƒè¯¯å·®å’Œæµ‹è¯•è¯¯å·®ä¹‹é—´å·®è·è¿‡å¤§ã€‚</p>
<h3 id="2-2-æ­£åˆ™åŒ–"><a href="#2-2-æ­£åˆ™åŒ–" class="headerlink" title="2.2 æ­£åˆ™åŒ–"></a>2.2 æ­£åˆ™åŒ–</h3><p>ä¸ºäº†é˜²æ­¢æ¨¡å‹ä»è®­ç»ƒæ•°æ®ä¸­å­¦åˆ°é”™è¯¯æˆ–æ— å…³ç´§è¦çš„æ¨¡å¼ï¼Œ<strong>æœ€ä¼˜è§£å†³æ–¹æ³•æ˜¯è·å–æ›´å¤šçš„è®­ç»ƒæ•°æ®</strong>ã€‚æ¨¡å‹çš„è®­ç»ƒæ•°æ®è¶Šå¤šï¼Œæ³›åŒ–èƒ½åŠ›è‡ªç„¶ä¹Ÿè¶Šå¥½ã€‚å¦‚æœæ— æ³•è·å–æ›´å¤šæ•°æ®ï¼Œæ¬¡ä¼˜è§£å†³æ–¹æ³•æ˜¯<strong>è°ƒèŠ‚æ¨¡å‹å…è®¸å­˜å‚¨çš„ä¿¡æ¯é‡</strong>ï¼Œæˆ–å¯¹æ¨¡å‹å…è®¸å­˜å‚¨çš„ä¿¡æ¯åŠ ä»¥çº¦æŸã€‚å¦‚æœä¸€ä¸ªç½‘ç»œåªèƒ½è®°ä½å‡ ä¸ªæ¨¡å¼ï¼Œé‚£ä¹ˆä¼˜åŒ–è¿‡ç¨‹ä¼šè¿«ä½¿æ¨¡å‹é›†ä¸­å­¦ä¹ æœ€é‡è¦çš„æ¨¡å¼ï¼Œè¿™æ ·æ›´å¯èƒ½å¾—åˆ°è‰¯å¥½çš„æ³›åŒ–ã€‚è¿™ç§é™ä½è¿‡æ‹Ÿåˆçš„æ–¹æ³•å«ä½œæ­£åˆ™åŒ–ã€‚</p>
<h3 id="2-2-1-æ·»åŠ æƒé‡æ­£åˆ™åŒ–"><a href="#2-2-1-æ·»åŠ æƒé‡æ­£åˆ™åŒ–" class="headerlink" title="2.2.1 æ·»åŠ æƒé‡æ­£åˆ™åŒ–"></a>2.2.1 æ·»åŠ æƒé‡æ­£åˆ™åŒ–</h3><p>L2æ­£åˆ™åŒ–ï¼š</p>
<p>$$<br>\widehat{J}(w,x,y)&#x3D;J(w,x,y)+\frac{\alpha}{2}||w||^2<br>$$</p>
<p>L1æ­£åˆ™åŒ–ï¼š</p>
<p>$$<br>\widehat{J}(w,x,y)&#x3D;J(w,x,y)+\alpha||w||<br>$$</p>
<p>ä¸Šè¿°å‡½æ•°ï¼š$J$ï¼šæŸå¤±å‡½æ•°ï¼Œ$||w||$ï¼šæˆ‘ä»¬æ·»åŠ æ­£åˆ™åŒ–é¡¹ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­æˆ‘ä»¬åªå¯¹æƒé‡åšæƒ©ç½šè€Œä¸å¯¹åç½®åšæƒ©ç½šã€‚</p>
<h2 id="2-3-æœºå™¨å­¦ä¹ æµç¨‹"><a href="#2-3-æœºå™¨å­¦ä¹ æµç¨‹" class="headerlink" title="2.3 æœºå™¨å­¦ä¹ æµç¨‹"></a>2.3 æœºå™¨å­¦ä¹ æµç¨‹</h2><p>1ã€å®šä¹‰é—®é¢˜ï¼Œæ”¶é›†æ•°æ®é›†</p>
<p>2ã€é€‰æ‹©è¡¡é‡æˆåŠŸçš„æŒ‡æ ‡</p>
<blockquote>
<p>é€‰æ‹©åˆé€‚è¯„ä»·æŒ‡æ ‡ï¼šRMSEã€å‡†ç¡®ç‡ã€å¬å›ç‡ç­‰</p>
</blockquote>
<p>3ã€ç¡®å®šè¯„ä¼°æ–¹æ³•</p>
<blockquote>
<p>éªŒè¯é›†ã€KæŠ˜äº¤å‰éªŒè¯ç­‰</p>
</blockquote>
<p>4ã€å‡†å¤‡æ•°æ®</p>
<p>5ã€å»ºç«‹æ¨¡å‹å¹¶ä¼˜åŒ–</p>
<blockquote>
<p>æ­£åˆ™åŒ–ã€è°ƒèŠ‚è¶…å‚æ•°</p>
</blockquote>
<h2 id="ä¸‰ã€æ¨èæ–‡çŒ®"><a href="#ä¸‰ã€æ¨èæ–‡çŒ®" class="headerlink" title="ä¸‰ã€æ¨èæ–‡çŒ®"></a>ä¸‰ã€æ¨èæ–‡çŒ®</h2><p>1ã€LECUN Y, BENGIO Y, HINTON G. Deep learning[J&#x2F;OL]. Nature, 2015, 521(7553): 436-444. <a href="https://doi.org/10.1038/nature14539">https://doi.org/10.1038/nature14539</a>.</p>
<p>2ã€RUMELHART D E, HINTON G E, WILLIAMS R J. Learning representations by back-propagating errors[J&#x2F;OL]. Nature, 1986, 323(6088): 533-536. <a href="https://doi.org/10.1038/323533a0">https://doi.org/10.1038/323533a0</a>.</p>
]]></content>
      <categories>
        <category>æ·±åº¦å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>åˆ†ç±»ç®—æ³•</tag>
        <tag>æ·±åº¦å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>å›¾åƒè¯†åˆ«ç®—æ³•--VGG16</title>
    <url>/posts/6d8b26d3/</url>
    <content><![CDATA[<p><strong>å‰è¨€</strong>ï¼šäººç±»ç§‘æŠ€å°±æ˜¯ä¸æ–­çƒ§å¼€æ°´ï¼ˆå‘ç”µï¼‰ã€ä¸¢çŸ³å¤´ï¼ˆèˆªå¤©ç­‰ï¼‰ã€‚æ·±åº¦å­¦ä¹ å°±æ˜¯ä¸€ä¸ªä¸æ–­<strong>è§£æ–¹ç¨‹</strong>çš„è¿‡ç¨‹ï¼ˆå‚æ•°é‡æ ¼å¤–å¤§çš„æ–¹ç¨‹ï¼‰</p>
<p><strong>æœ¬æ–‡å†…å®¹</strong>ï¼š</p>
<p>1ã€ä»‹ç»VGG16åŸºæœ¬åŸç†</p>
<p>2ã€VGG16 pytorchå¤ç°</p>
<span id="more"></span>

<h1 id="å›¾åƒè¯†åˆ«ç®—æ³•â€“VGG16"><a href="#å›¾åƒè¯†åˆ«ç®—æ³•â€“VGG16" class="headerlink" title="å›¾åƒè¯†åˆ«ç®—æ³•â€“VGG16"></a>å›¾åƒè¯†åˆ«ç®—æ³•â€“VGG16</h1><p>[TOC]</p>
<h1 id="1ã€å‚è€ƒæ–‡çŒ®"><a href="#1ã€å‚è€ƒæ–‡çŒ®" class="headerlink" title="1ã€å‚è€ƒæ–‡çŒ®"></a>1ã€å‚è€ƒæ–‡çŒ®</h1><p>VGG16ï¼š[1]SIMONYAN K, ZISSERMAN A. Very Deep Convolutional Networks for Large-Scale Image Recognition[M&#x2F;OL]. arXiv, 2015[2023-04-07]. <a href="http://arxiv.org/abs/1409.1556">http://arxiv.org/abs/1409.1556</a>.</p>
<p>Dropoutï¼š[2]SRIVASTAVA N, HINTON G, KRIZHEVSKY A, ç­‰. Dropout: A Simple Way to Prevent Neural Networks from Overï¬tting[J].</p>
<h1 id="2ã€VGG16ç†è®º"><a href="#2ã€VGG16ç†è®º" class="headerlink" title="2ã€VGG16ç†è®º"></a>2ã€VGG16ç†è®º</h1><h2 id="2-1-VGG16-ä¼˜ç‚¹"><a href="#2-1-VGG16-ä¼˜ç‚¹" class="headerlink" title="2.1 VGG16 ä¼˜ç‚¹"></a>2.1 VGG16 ä¼˜ç‚¹</h2><p>1ã€ä½¿ç”¨3x3çš„å·ç§¯æ ¸è€Œé7x7çš„å·ç§¯æ ¸</p>
<blockquote>
<p>First, we incorporate three non-linear rectification layers instead of a single one, which makes the decision function more discriminative. Second, we decrease the number of parameters.</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´VGG16ä¸€æ–¹é¢å‡å°‘äº†å‚æ•°ï¼ˆç›¸å¯¹äº7x7ï¼‰ï¼Œå¦å¤–ä¸€æ–¹é¢é€šè¿‡3éçº¿æ€§å±‚ï¼Œæ›´åŠ å…·æœ‰éçº¿æ€§è¡¨è¾¾èƒ½åŠ›</p>
<h2 id="2-2-VGG16ç½‘ç»œç»“æ„å›¾"><a href="#2-2-VGG16ç½‘ç»œç»“æ„å›¾" class="headerlink" title="2.2 VGG16ç½‘ç»œç»“æ„å›¾"></a>2.2 VGG16ç½‘ç»œç»“æ„å›¾</h2><p>VGGè®¾è®¡çš„ç¥ç»ç½‘ç»œç»“æ„å›¾ï¼š</p>
<img data-src="https://s2.loli.net/2023/05/22/TMopYLiGVAXEZ4a.png" alt="image-20230521224103927" style="zoom:100%;">

<blockquote>
<p>Dï¼šdropout</p>
</blockquote>
<p><em>å›¾ç‰‡å˜åŒ–è¿‡ç¨‹</em>ï¼š</p>
<p>1ï¼šè¾“å…¥æˆ‘ä»¬çš„å·å»ºå›½ï¼ˆ224x224x3ï¼‰â€”&gt;224x224x64â€”&gt;112x112x64</p>
<p>2ï¼š112x112x64â€”&gt;112x112x128â€”&gt;56x56x128</p>
<p>3ï¼š56x56x128â€”&gt;56x56x256â€”&gt;56x56x256â€”&gt;28x28x256</p>
<p>4ï¼š28x28x256â€”&gt;28x28x512â€”&gt;28x28x512â€”&gt;14x14x512</p>
<p>5ï¼š14x14x512â€”&gt;14x14x512â€”&gt;14x14x512â€”&gt;7x7x512</p>
<blockquote>
<p>å˜åŒ–è¿‡ç¨‹ç¬¬ä¸€ä¸ªæ•°å­—ä»£è¡¨è¾“å…¥ï¼Œæœ€åä¸€ä¸ªæ•°å­—ä»£è¡¨è¿™ä¸€å±‚çš„è¾“å‡ºï¼Œä¸‹ä¸€å±‚çš„è¾“å…¥</p>
</blockquote>
<p>å…¨è¿æ¥å±‚ï¼š</p>
<p>1ã€è¾“å…¥ï¼š7x7x512ï¼ˆ25088ï¼‰ï¼Œè¾“å‡ºï¼š4096</p>
<p>2ã€è¾“å…¥ï¼š4096ï¼Œè¾“å‡º4096</p>
<p>3ã€è¾“å…¥ï¼š4096ï¼Œè¾“å‡º1000 (<strong>å› ä¸ºè¿›è¡Œçš„æ˜¯1000ä¸ªåˆ†ç±»</strong>ï¼‰</p>
<p>åœ¨å‚è€ƒæ–‡çŒ®1ä¸­ä½œè€…åŒæ—¶æ¯”è¾ƒäº†ä¸‹é¢å‡ ç§ä¸åŒç»“æ„ï¼ˆVGG11ã€VGG16ä¸VGG19ï¼‰ï¼š</p>
<img data-src="https://s2.loli.net/2023/06/04/tDAGlFpbTnv7wXP.png" alt="image-20230521225247719" style="zoom: 50%;">

<hr>
<p><strong>å»ºè®®</strong>ï¼š</p>
<blockquote>
<p>we have found that our conceptually much simpler scheme already provides a speedup of 3.75 times on an off-the-shelf 4-GPU system, as compared to using a single GPU. On a system equipped with four NVIDIA Titan Black GPUs, training a single net took 2â€“3 weeks depending on the architecture.</p>
<p>æˆ‘ä»¬å‘ç°ï¼Œä¸ä½¿ç”¨å•ä¸ªGPUç›¸æ¯”ï¼Œæˆ‘ä»¬åœ¨æ¦‚å¿µä¸Šæ›´ç®€å•çš„æ–¹æ¡ˆå·²ç»åœ¨ç°æˆçš„4 - GPUç³»ç»Ÿä¸Šæä¾›äº†3.75å€çš„åŠ é€Ÿæ¯”ã€‚åœ¨æ­è½½4ä¸ªNVIDIA Titan Black GPUçš„ç³»ç»Ÿä¸Šï¼Œæ ¹æ®æ¶æ„çš„ä¸åŒï¼Œè®­ç»ƒå•ä¸ªç½‘ç»œéœ€è¦2 ~ 3å‘¨ã€‚</p>
</blockquote>
<p>è®¿é—®é“¾æ¥ï¼š<a href="https://www.image-net.org/challenges/LSVRC/2012/index.php">https://www.image-net.org/challenges/LSVRC/2012/index.php</a></p>
<p>å¦‚æœæƒ³å¤ç°VGG16ï¼Œç›´æ¥ä½¿ç”¨è®ºæ–‡ä½œè€…æ•°æ®æ˜¯ä¸è¦åˆ‡åˆå®é™…çš„ï¼š1ã€æ•°æ®è¿‡å¤§ï¼›2ã€æ²¡æœ‰è¿™ä¹ˆé«˜çš„ç”µè„‘é…ç½®ã€‚</p>
<p>æ¨èä½¿ç”¨æ•°æ®é›†ï¼š<a href="https://download.pytorch.org/tutorial/hymenoptera_data.zip">https://download.pytorch.org/tutorial/hymenoptera_data.zip</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">url = <span class="string">&quot;https://download.pytorch.org/tutorial/hymenoptera_data.zip&quot;</span></span><br><span class="line">save_path = os.path.join(data_dir, <span class="string">&quot;hymenoptera_data.zip&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(save_path):</span><br><span class="line">    urllib.request.urlretrieve(url, save_path)</span><br><span class="line">    <span class="built_in">zip</span> = zipfile.ZipFile(save_path)</span><br><span class="line">    <span class="built_in">zip</span>.extractall(data_dir)</span><br><span class="line">    <span class="built_in">zip</span>.close()</span><br><span class="line">    os.remove(save_path)</span><br></pre></td></tr></table></figure>

<p>pytorchå®˜æ–¹æ•°æ®ï¼Œä¸»è¦æ˜¯å®ç°èœœèœ‚å’Œèš‚èšåˆ†ç±»ï¼Œä¸è¿‡åœ¨ä½¿ç”¨å‰å¿…é¡»å¯¹å›¾ç‰‡è¿›è¡Œå¤„ç†ï¼Œå› ä¸ºä»–æä¾›çš„å›¾ç‰‡å¹¶ééƒ½æ˜¯<strong>224x224x3</strong>ï¼Œæ‰€ä»¥éœ€è¦å¯¹å›¾ç‰‡è¿›è¡Œè½¬æ¢ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">å›¾ç‰‡é¢„å¤„ç†ï¼š</span></span><br><span class="line"><span class="string">1ã€å›¾ç‰‡è£å‰ª</span></span><br><span class="line"><span class="string">2ã€æ ‡å‡†åŒ–</span></span><br><span class="line"><span class="string">3ã€å›¾ç‰‡æ—‹è½¬</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ImageTransform</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, resize, mean, std</span>):</span><br><span class="line">        self.data_transform = &#123;</span><br><span class="line">            <span class="string">&#x27;train&#x27;</span>: transforms.Compose([</span><br><span class="line">                transforms.RandomResizedCrop(resize, scale=(<span class="number">0.5</span>, <span class="number">1.0</span>)), </span><br><span class="line">                <span class="comment">#scaleåœ¨è°ƒæ•´å¤§å°ä¹‹å‰ï¼ŒæŒ‡å®šè£å‰ªçš„éšæœºåŒºåŸŸçš„ä¸‹é™å’Œä¸Šé™ã€‚è§„æ¨¡æ˜¯ç›¸å¯¹äºåŸå§‹å›¾åƒçš„é¢ç§¯æ¥å®šä¹‰çš„</span></span><br><span class="line">                transforms.RandomHorizontalFlip(), <span class="comment">#ä»¥ç»™å®šçš„æ¦‚ç‡éšæœºæ°´å¹³ç¿»è½¬ç»™å®šçš„å›¾åƒ</span></span><br><span class="line"></span><br><span class="line">                transforms.ToTensor(), <span class="comment">#å°†å›¾ç‰‡è½¬åŒ–ä¸ºå¼ é‡</span></span><br><span class="line">                transforms.Normalize(mean, std) <span class="comment">#å°†å›¾ç‰‡è¿›è¡Œæ­£åˆ™åŒ–</span></span><br><span class="line">            ]),</span><br><span class="line">            <span class="string">&#x27;val&#x27;</span>: transforms.Compose([</span><br><span class="line">                transforms.Resize(resize), <span class="comment">#æ”¹å˜å°ºå¯¸</span></span><br><span class="line">                transforms.CenterCrop(resize), <span class="comment">#ä¸­å¿ƒè£å‰ªå›¾åƒ</span></span><br><span class="line"></span><br><span class="line">                transforms.ToTensor(), </span><br><span class="line">                transforms.Normalize(mean, std)</span><br><span class="line">            ])</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, img, phase=<span class="string">&#x27;train&#x27;</span></span>):</span><br><span class="line">        <span class="keyword">return</span> self.data_transform[phase](img)</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°ä»£ç æ¶‰åŠåˆ°ä¸€ä¸ªç†è®ºï¼šåœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼ˆVGGä¹Ÿæ˜¯ä¸€ç§å·ç§¯ç¥ç»ç½‘ç»œï¼‰ï¼Œåœ¨å¯¹äºè®­ç»ƒé›†æ•°æ®ä¸è¶³çš„æ—¶å€™ï¼Œå¯ä»¥å°è¯•å¯¹å›¾ç‰‡è¿›è¡Œæ—‹è½¬ç­‰æ“ä½œæ¥è¡¥å……è®­ç»ƒé›†æ•°æ®ã€‚æ¯”å¦‚æˆ‘ä»¬å·å»ºå›½ï¼Œæˆ‘æ—‹è½¬ä»–å°±ç›¸å½“äºåˆå¢åŠ äº†ä¸€ä¸ªè®­ç»ƒé›†æ•°æ®ã€‚</p>
<p><strong>å¦‚æœå®éªŒå®¤ç”µè„‘é…ç½®ä¸å¤Ÿ</strong>ï¼šå»ºè®®ç›´æ¥ç§Ÿç®—åŠ›ï¼ˆå¦‚æœåªæ˜¯è½»å¾®ä½¿ç”¨æ·±åº¦å­¦ä¹ +å®éªŒå®¤æ²¡é’±ï¼‰</p>
<p>æ¨èç½‘ç«™ï¼š<a href="https://www.autodl.com/home">AutoDL-å“è´¨GPUç§Ÿç”¨å¹³å°-ç§ŸGPUå°±ä¸ŠAutoDL</a>ï¼Œå­¦ç”Ÿè®¤è¯ä»·æ ¼ä¹Ÿè¿˜okã€‚ç½‘ç«™æä¾›GPUï¼ˆéƒ¨åˆ†ï¼‰ï¼š</p>
<img data-src="https://s2.loli.net/2023/05/22/MkONHI4BzLD8XAp.png" alt="image-20230521231718698" style="zoom:50%;">

<hr>
<p>å¤šå°ºåº¦è¯„ä»·çš„å®éªŒç»“æœï¼š</p>
<img data-src="https://s2.loli.net/2023/05/22/jlU6khWQNdmXTLO.png" alt="image-20230521230626642" style="zoom: 80%;">

<p>ä½œè€…æ“ä½œè¿‡ç¨‹ä¸­è¿˜ä½¿ç”¨äº†ï¼š1ã€$L_{2}$èŒƒæ•°ï¼›2ã€è®¾ç½®0.5çš„dropout</p>
<h2 id="2-2-1-å¤ç°ä»£ç "><a href="#2-2-1-å¤ç°ä»£ç " class="headerlink" title="2.2.1 å¤ç°ä»£ç "></a>2.2.1 å¤ç°ä»£ç </h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#å®šä¹‰è®­ç»ƒç½‘ç»œ VGG-16</span></span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">vgg16</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        <span class="comment">#å¼€å§‹å®šä¹‰ç½‘ç»œç»“æ„</span></span><br><span class="line">        self.conv1 = torch.nn.Conv2d(<span class="number">3</span>, <span class="number">64</span>, <span class="number">3</span>, padding=(<span class="number">1</span>,<span class="number">1</span>))</span><br><span class="line">        self.conv2 = torch.nn.Conv2d(<span class="number">64</span>, <span class="number">64</span>, <span class="number">3</span>, padding=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        self.pool1 = torch.nn.MaxPool2d((<span class="number">2</span>, <span class="number">2</span>), padding=(<span class="number">1</span>, <span class="number">1</span>)) <span class="comment">#64x112x112</span></span><br><span class="line"></span><br><span class="line">        self.conv3 = torch.nn.Conv2d(<span class="number">64</span>, <span class="number">128</span>,<span class="number">3</span>,padding=(<span class="number">1</span>,<span class="number">1</span>))</span><br><span class="line">        self.conv4 = torch.nn.Conv2d(<span class="number">128</span>, <span class="number">128</span>, <span class="number">3</span>, padding=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        self.pool2 = torch.nn.MaxPool2d((<span class="number">2</span>, <span class="number">2</span>), padding=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">        self.conv5 = torch.nn.Conv2d(<span class="number">128</span>, <span class="number">256</span>,<span class="number">3</span>, padding=(<span class="number">1</span>,<span class="number">1</span>))</span><br><span class="line">        self.conv6 = torch.nn.Conv2d(<span class="number">256</span>, <span class="number">256</span>,<span class="number">3</span>, padding=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        self.conv7 = torch.nn.Conv2d(<span class="number">256</span>, <span class="number">256</span>,<span class="number">3</span>, padding=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        self.pool3 = torch.nn.MaxPool2d((<span class="number">2</span>,<span class="number">2</span>), padding=(<span class="number">1</span>, <span class="number">1</span>))       </span><br><span class="line">        </span><br><span class="line">        self.conv8 = torch.nn.Conv2d(<span class="number">256</span>, <span class="number">512</span>,<span class="number">3</span>, padding=(<span class="number">1</span>,<span class="number">1</span>))</span><br><span class="line">        self.conv9 = torch.nn.Conv2d(<span class="number">512</span>, <span class="number">512</span>,<span class="number">3</span>, padding=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        self.conv10 = torch.nn.Conv2d(<span class="number">512</span>, <span class="number">512</span>,<span class="number">3</span>, padding=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        self.pool4 = torch.nn.MaxPool2d((<span class="number">2</span>,<span class="number">2</span>),padding=(<span class="number">1</span>, <span class="number">1</span>))         </span><br><span class="line"></span><br><span class="line">        self.conv11 = torch.nn.Conv2d(<span class="number">512</span>, <span class="number">512</span>,<span class="number">3</span>)</span><br><span class="line">        self.conv12 = torch.nn.Conv2d(<span class="number">512</span>, <span class="number">512</span>,<span class="number">3</span>, padding=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        self.conv13 = torch.nn.Conv2d(<span class="number">512</span>, <span class="number">512</span>,<span class="number">3</span>, padding=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        self.pool5 = torch.nn.MaxPool2d((<span class="number">2</span>,<span class="number">2</span>),padding=(<span class="number">1</span>, <span class="number">1</span>)) </span><br><span class="line"></span><br><span class="line">        self.fc1 = nn.Linear(<span class="number">512</span>*<span class="number">7</span>*<span class="number">7</span>, <span class="number">4096</span>)</span><br><span class="line">        self.dropout1 = nn.Dropout(<span class="number">0.5</span>)</span><br><span class="line">        self.fc2 = nn.Linear(<span class="number">4096</span>, <span class="number">4096</span>)</span><br><span class="line">        self.dropout2 = nn.Dropout(<span class="number">0.5</span>)</span><br><span class="line">        self.fc3 = nn.Linear(<span class="number">4096</span>, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        insize = x.size(<span class="number">0</span>)</span><br><span class="line">        out = F.relu(self.conv1(x))</span><br><span class="line">        out = self.pool1(F.relu(self.conv2(out)))</span><br><span class="line"></span><br><span class="line">        out = F.relu(self.conv3(out))</span><br><span class="line">        out = self.pool2(F.relu(self.conv4(out)))</span><br><span class="line"></span><br><span class="line">        out = F.relu(self.conv5(out))</span><br><span class="line">        out = F.relu(self.conv6(out))</span><br><span class="line">        out = self.pool3(F.relu(self.conv7(out)))</span><br><span class="line"></span><br><span class="line">        out = F.relu(self.conv8(out))</span><br><span class="line">        out = F.relu(self.conv9(out))</span><br><span class="line">        out = self.pool4(F.relu(self.conv10(out)))</span><br><span class="line"></span><br><span class="line">        out = F.relu(self.conv11(out))</span><br><span class="line">        out = F.relu(self.conv12(out))</span><br><span class="line">        out = self.pool5(F.relu(self.conv13(out)))</span><br><span class="line"></span><br><span class="line">        out = out.view(insize, -<span class="number">1</span>) <span class="comment">#è¿™é‡Œå¯¹äºä¸åŒæ•°æ®å¤„ç†ä¼šæœ‰ä¸ä¸€æ ·ï¼Œ-1ä½äºåé¢ç›¸å½“äºç›´æ¥å°†æ•°æ®è¿›è¡Œå¹³é“º--&gt;1*nï¼›</span></span><br><span class="line">        <span class="comment"># -1ä½äºå‰é¢åˆ™---&gt;n*1</span></span><br><span class="line">        out = self.dropout1(self.act1(self.fc1(out)))</span><br><span class="line">        out = self.dropout2(self.act1(self.fc2(out)))</span><br><span class="line">        out = self.fc3(out)</span><br><span class="line">        out = F.log_softmax(out, dim=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line">device = torch.device(<span class="string">&#x27;cuda:0&#x27;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&#x27;CPU&#x27;</span>)</span><br><span class="line">vgg = vgg16()</span><br><span class="line">x = torch.rand(size=(<span class="number">4</span>, <span class="number">3</span>, <span class="number">224</span>, <span class="number">224</span>)) <span class="comment">#ç›¸å½“äº4å¼ 224x224çš„å›¾ç‰‡ï¼Œæ‰€ä»¥æ—‹è½¬out.view(insize, -1)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">x = torch.rand(size=(3, 224, 224)) out.view(224*224*3, -1)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">vgg(x)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>æ–‡çŒ®ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ·±åº¦å­¦ä¹ </tag>
        <tag>å›¾åƒè¯†åˆ«</tag>
      </tags>
  </entry>
  <entry>
    <title>æ”¯æŒå‘é‡æœº</title>
    <url>/posts/671832206/</url>
    <content><![CDATA[<p>ä»‹ç»æ”¯æŒå‘é‡æœºåŸºæœ¬åŸç†</p>
<span id="more"></span>
<p>[toc]</p>
<h1 id="æ”¯æŒå‘é‡æœº-SVM"><a href="#æ”¯æŒå‘é‡æœº-SVM" class="headerlink" title="æ”¯æŒå‘é‡æœº(SVM)"></a>æ”¯æŒå‘é‡æœº(SVM)</h1><h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯æ”¯æŒå‘é‡æœº"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯æ”¯æŒå‘é‡æœº" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯æ”¯æŒå‘é‡æœº"></a>ä¸€ã€ä»€ä¹ˆæ˜¯æ”¯æŒå‘é‡æœº</h2><p>æ”¯æŒå‘é‡æœºåœ¨é«˜çº¬æˆ–æ— é™ç»´ç©ºé—´ä¸­æ„é€ <strong>è¶…å¹³é¢</strong>æˆ–è¶…å¹³é¢é›†åˆï¼Œå…¶å¯ä»¥ç”¨äºåˆ†ç±»ã€å›å½’æˆ–å…¶ä»–ä»»åŠ¡ã€‚ç›´è§‚æ¥è¯´ï¼Œåˆ†ç±»è¾¹ç•Œè·ç¦»æœ€è¿‘çš„è®­ç»ƒèµ„æ–™ç‚¹è¶Šè¿œè¶Šå¥½ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥ç¼©å°åˆ†ç±»å™¨çš„<strong>æ³›åŒ–è¯¯å·®</strong>ã€‚</p>
<blockquote>
<p><a href="https://zh.wikipedia.org/zh-cn/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA">https://zh.wikipedia.org/zh-cn/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA</a></p>
</blockquote>
<p>é‡Œé¢æ¶‰åŠåˆ°å‡ ä¸ªæ¦‚å¿µï¼š1ã€è¶…å¹³é¢ï¼›2ã€æ³›åŒ–è¯¯å·®ï¼›3ã€æ”¯æŒå‘é‡</p>
<ul>
<li>ä»€ä¹ˆæ˜¯è¶…å¹³é¢å‘¢ï¼Ÿ</li>
</ul>
<p>å‡å¦‚å’±ä»¬æ˜¯åœ¨ç”¨æ”¯æŒå‘é‡æœºæ¥å¤„ç†äºŒåˆ†ç±»é—®é¢˜å§ã€‚å’±ä»¬è®¾æƒ³å‡å¦‚åœ¨ä¸€ä¸ªç›´è§’åæ ‡ç³»é‡Œé¢å­˜åœ¨ä¸¤ä¸ªä¸åŒç±»åˆ«ï¼šé»‘ç‚¹å’Œç´«ç‚¹ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦å°†ä»–ä»¬è¿›è¡Œåˆ†ç¦»ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿä½ æˆ–è®¸ä¼šè¯´ï¼šè¿™è¿˜ä¸ç®€å•ç›´æ¥ç”»ä¸€æ¡çº¿ä¸ä¹…å®Œäº‹äº†å—ï¼Ÿçœ‹æ¥ä½ æ˜ç™½ä»€ä¹ˆæ˜¯<strong>è¶…å¹³é¢</strong>ï¼Œå¥½çš„æˆ‘ä»¬çœ‹ä¸‹å›¾ï¼š</p>
<p><img data-src="/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/1678697314457.png" alt="1678697314457"></p>
<p>é‚£ä¹ˆåˆ°åº•æ˜¯è“è‰²å¥½å‘¢ï¼Ÿè¿˜æ˜¯é»„è‰²å¥½å‘¢ï¼Ÿè¿™å°±æ˜¯æˆ‘ä»¬è¦æçš„ç¬¬äºŒä¸ªæ¦‚å¿µâ€”â€”æ³›åŒ–è¯¯å·®</p>
<ul>
<li>ä»€ä¹ˆæ˜¯æ³›åŒ–è¯¯å·®</li>
</ul>
<p>ä»”ç»†çœ‹å›¾å¯èƒ½ä¼šç»å¯¹è“è‰²æœ€ä½³å‘€ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºç®­å¤´æ ‡è®°çš„ç‚¹ä»–æ˜¯è·ç¦»æœ€çŸ­çš„å‘€ï¼å¬èµ·æ¥ä¼¼ä¹å¾ˆæœ‰é“ç†ï¼Œ<strong>ä½†æ˜¯</strong>ï¼Œæˆ‘ä»¬ä¸€èˆ¬å®éªŒéƒ½æ˜¯å–éƒ¨åˆ†æ ·æœ¬è¿›è¡Œæµ‹è¯•ï¼Œç”±äºè®­ç»ƒé›†çš„å±€é™æ€§æˆ–å™ªå£°çš„å› ç´ ï¼Œè®­ç»ƒé›†å¤–çš„æ ·æœ¬å¯èƒ½æ¯”å›¾ä¸­çš„è®­ç»ƒæ ·æœ¬æ›´æ¥è¿‘ä¸¤ä¸ªç±»çš„åˆ†éš”ç•Œï¼Œè¿™å°†ä½¿è®¸å¤šåˆ’åˆ†è¶…å¹³é¢å‡ºç°é”™è¯¯ï¼Œè€Œé»„è‰²çš„è¶…å¹³é¢å—å½±å“æœ€å°ã€‚è¿™å°±æ˜¯æˆ‘ä»¬è¦è€ƒè™‘çš„â€”â€”æ³›åŒ–è¯¯å·®ï¼ç›´è§‚ç†è§£å°±æ˜¯ï¼šåœ¨æ–°åŠ å…¥æ ·æœ¬ç‚¹çš„æ—¶å€™è¶…å¹³é¢ä¾æ—§å¯ä»¥å¾ˆå¥½çš„åˆ’åˆ†æ•°æ®ç‚¹ã€‚</p>
<ul>
<li>ä»€ä¹ˆæ˜¯æ”¯æŒå‘é‡</li>
</ul>
<p>æˆ‘ä»¬å°†è¶…å¹³é¢åˆ†åˆ«åŠ å‡å¸¸æ•°Cè¿™æ ·çš„è¯æˆ‘ä»¬çš„è¶…å¹³é¢å°±ä¼šå‘ç”Ÿç§»åŠ¨ä½†æ˜¯ç§»åŠ¨å¤šå°‘å‘¢ï¼Ÿå½“æˆ‘ä»¬ç§»åŠ¨åˆ°æ¥è§¦æ ·æœ¬æ•°æ®ç‚¹ï¼Œè€Œè¿™äº›æ ·æœ¬æ•°æ®ç‚¹å°±å†³å®šäº†æˆ‘ä»¬çš„<strong>é—´éš”è·ç¦»</strong>ï¼ˆå–ä¸ªå…³å­ï¼‰ï¼Œä»–ä»¬å°±å«<strong>æ”¯æŒå‘é‡</strong></p>
<p>è¯´äº†é‚£ä¹ˆå¤šï¼Œæ€ä¹ˆæ±‚è¿™ä¸ªè¶…å¹³é¢æ–¹ç¨‹å‘¢ï¼Ÿ(<strong>å¯èƒ½ä¼šæ¶‰åŠè®¸å¤šçš„æ•°å­¦çŸ¥è¯†ï¼Œæƒ³ç›´æ¥äº†è§£ä»£ç ç›´æ¥è·³è¿‡è¿™éƒ¨åˆ†</strong>)</p>
<h2 id="äºŒã€æ•°å­¦ç†è®º"><a href="#äºŒã€æ•°å­¦ç†è®º" class="headerlink" title="äºŒã€æ•°å­¦ç†è®º"></a>äºŒã€æ•°å­¦ç†è®º</h2><p>æœºå™¨å­¦ä¹ ç®—æ³•å’Œæ•°å­¦çŸ¥è¯†ç¦»ä¸å¼€å…³ç³»ï¼Œæˆ‘å°½å¯èƒ½çš„ç®€åŒ–æ•°å­¦çŸ¥è¯†ï¼Œå½“ç„¶å¦‚æœåªæƒ³è¦ä»£ç ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯å¾—çŸ¥é“å¦‚ä½•<strong>è°ƒå‚</strong></p>
<blockquote>
<p>æ”¯æŒå‘é‡æœºçš„æœ‰æ•ˆæ€§å–å†³äºæ ¸å‡½æ•°ã€æ ¸å‚æ•°å’Œè½¯é—´éš”å‚æ•° <em>C</em> çš„é€‰æ‹©</p>
</blockquote>
<h3 id="2-1-æ•°å­¦é¢„å¤‡çŸ¥è¯†"><a href="#2-1-æ•°å­¦é¢„å¤‡çŸ¥è¯†" class="headerlink" title="2.1 æ•°å­¦é¢„å¤‡çŸ¥è¯†"></a>2.1 æ•°å­¦é¢„å¤‡çŸ¥è¯†</h3><ul>
<li>ä¸¤ç›´çº¿è·ç¦»</li>
</ul>
<p>$$<br>è®¾å­˜åœ¨ä¸¤å¹³è¡Œç›´çº¿ï¼šA_0x+B_0y+b_0&#x3D;0ï¼›A_0x+B_0y+b_1&#x3D;0ï¼›åˆ™ä»–ä»¬ä¹‹é—´çš„è·ç¦»ä¸º:\d&#x3D;\frac{|b_1-b_0|}{\sqrt{A_0^2+B_0^2}}<br>$$</p>
<ul>
<li>äºŒæ¬¡è§„åˆ’é—®é¢˜<br>å½¢å¦‚ï¼š</li>
</ul>
<p>$$<br>min;;c^Tx+\frac{1}{2}x^TQx\subject;to:Dx\geqslant d\Ax&#x3D;b<br>$$</p>
<p>å¦‚æœQâ‰¥0æ—¶ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±æ˜¯å‡¸ä¼˜åŒ–é—®é¢˜</p>
<ul>
<li>æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•</li>
</ul>
<p>æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•æ˜¯ä¸€ç§å°†çº¦æŸä¼˜åŒ–é—®é¢˜è½¬åŒ–ä¸ºæ— çº¦æŸä¼˜åŒ–é—®é¢˜çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ç°åœ¨è¦æ±‚è§£å¦‚ä¸‹ä¼˜åŒ–ï¼ˆæœ€å°åŒ–ï¼‰é—®é¢˜ï¼š</p>
<p>$$<br>minf(x);;s.t.;g(x)&#x3D;0<br>$$</p>
<p>ä¹Ÿå°±æ˜¯æ±‚è§£f(x)åœ¨çº¦æŸæ¡ä»¶g(x)&#x3D;0çš„æ¡ä»¶ä¸‹çš„æœ€å°å€¼çš„é—®é¢˜ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¼•å…¥æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š</p>
<p>$$<br>L(x,\alpha)&#x3D;f(x)+\alpha g(x);;; \alpha è®°ä½œæ‹‰æ ¼æœ—æ—¥ä¹˜å­<br>$$</p>
<blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/440297403">å½¢è±¡ç†è§£æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³• - çŸ¥ä¹ (zhihu.com)</a></p>
</blockquote>
<ul>
<li>KKTçº¦æŸæ¡ä»¶</li>
</ul>
<blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/38163970">Karush-Kuhn-Tucker (KKT)æ¡ä»¶ - çŸ¥ä¹ (zhihu.com)</a></p>
</blockquote>
<h3 id="2-2-çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœº"><a href="#2-2-çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœº" class="headerlink" title="2.2 çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœº"></a>2.2 çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœº</h3><ul>
<li>ä»€ä¹ˆæ˜¯çº¿æ€§å¯åˆ†ï¼Ÿ</li>
</ul>
<p>ä¸è¯´æ¦‚å¿µï¼Œç›´è§‚ç†è§£å°±æ˜¯ï¼šå’±ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ä¸€æ¡ç›´çº¿æˆ–è€…ä¸€ä¸ªå¹³é¢å»åˆ’åˆ†æ•°æ®é›†ï¼Œé‚£è¿™å°±å«çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºï¼æ¯”å¦‚è¯´ï¼šå’±ä»¬æœ‰è®­ç»ƒæ•°æ®é›†ï¼š$T&#x3D;[(x_1,y_1),(x_2,y_2)]$ç°åœ¨æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€æ¡ç›´çº¿åˆ’åˆ†ä»–ä»¬ï¼Œæˆ‘æƒ³ä½ ä¼šç«‹é©¬æƒ³åˆ°$ax+by+c&#x3D;0$è¿™ä¸ªæ–¹ç¨‹ã€‚å¾ˆå¥½é‚£ä¹ˆæˆ‘ä»¬æ¨å¹¿åˆ°$n$ä¸ªç‚¹çš„æƒ…å†µã€‚</p>
<p>ç»™å®šè®­ç»ƒæ•°æ®é›†:</p>
<p>$$<br>T&#x3D;[(x_1,y_1)â€¦â€¦(x_n,y_n)]<br>$$</p>
<p>è¿™ç§æƒ…å†µä¸‹æ€ä¹ˆåŠå‘¢ï¼ŸåŒæ ·çš„æ–¹æ³•æˆ‘ä»¬å‡è®¾è¶…å¹³é¢æ–¹ç¨‹ä¸ºï¼š</p>
<p>$$<br>w^Tx+b&#x3D;0\å…¶ä¸­wï¼Œbéƒ½æ˜¯æ¨¡å‹å‚æ•°,æ³¨æ„æ­¤æ—¶wå°±ä¸æ˜¯ä¸€ä¸ªæ•°å­—è€Œæ˜¯ä¸€ä¸ªå‘é‡ï¼<br>$$</p>
<p>é‚£ä¹ˆçš„è¯å’±ä»¬æ–¹ç¨‹ä¹Ÿæœ‰äº†ï¼Œæ¥ä¸‹æ¥é—®é¢˜å°±è½¬åŒ–æˆæ±‚è§£$w,b$å‚æ•°å…·ä½“çš„å€¼çš„é—®é¢˜äº†ã€‚å†æ¬¡å›é¡¾æˆ‘ä»¬2å…ƒçš„ç‚¹åˆ°ç›´çº¿è·ç¦»å…¬å¼ï¼š$d&#x3D;\frac{|ax+by+c|}{\sqrt{a^2+b^2}}$åŒæ ·çš„é“ç†æˆ‘ä»¬æ¨åˆ°åˆ°å¤šç»´æƒ…å†µï¼š</p>
<p>$$<br>d&#x3D;\frac{|w^Tx+b|}{||w||}<br>$$</p>
<p>ä¸è¦å¿˜è®°æˆ‘ä»¬çš„å‡ºå‘ç‚¹æ˜¯ä»€ä¹ˆï¼šäºŒåˆ†ç±»ï¼ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦å°†æˆ‘ä»¬çš„ç‚¹åˆ’åˆ†å¼€æ¥ï¼Œè¿™æ ·çš„è¯æ˜¯ä¸æ˜¯åœ¨è¶…å¹³é¢çš„æŸä¸€ä¾§æ˜¯aç±»å¦å¤–ä¸€ä¾§åˆ™æ˜¯bç±»ï¼Œè¿˜è®°å¾—æˆ‘ä»¬å‰é¢æåˆ°çš„<strong>é—´éš”è·ç¦»</strong>å—ï¼Ÿæˆ‘ä»¬è®¾ï¼š</p>
<p>$$<br>\begin{cases}<br>    w^Tx_i+b\geqslant1,y_i&#x3D;1\<br>    w^Tx_i+b\leqslant1,y_i&#x3D;-1<br>\end{cases}\\text{è¿™æ ·çš„è¯ä¸¤ä¸ªè¶…å¹³é¢çš„è·ç¦»å°±æ˜¯}r&#x3D;\frac{2}{||w||}<br>$$</p>
<blockquote>
<p>è¶…å¹³é¢è·ç¦»å°±å¯ä»¥ç±»æ¯”ä¸¤å¹³è¡Œç›´çº¿ä¹‹é—´è·ç¦»</p>
</blockquote>
<p>è¿™æ ·çš„è¯æˆ‘ä»¬å°±æ˜¯æ‰¾åˆ°æœ€å¤§â€œé—´éš”â€ä¹Ÿå°±æ˜¯è¯´è®¡ç®—ï¼š</p>
<p>$$<br>max\frac{2}{||w||}ç®€åŒ–è®¡ç®—è®°ä½œmin\frac{1}{2}||w||^2\<br>subject;to;y_i(w^Tx_i+b)\geqslant1,;i&#x3D;1,2â€¦.n<br>$$</p>
<p>åˆ©ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•è¿›è¡Œæ±‚è§£ï¼š</p>
<p>$$<br>å…¬å¼1;;L(w,b,\alpha)&#x3D;\frac{1}{2}||w||^2+\sum_{i&#x3D;1}^{m}\alpha_i(1-y_i(w^Tx_i+b))\||w||^2&#x3D;w^Tw<br>$$</p>
<p>æ­¤æ—¶æˆ‘ä»¬å¯¹wï¼Œbåˆ†åˆ«è®¡ç®—åå¯¼å¹¶ä¸”ä»¤å…¶ä¸º0å¾—åˆ°:</p>
<p>$$<br>å…¬å¼2;;w&#x3D;\sum_{i&#x3D;1}^{m}\alpha_iy_ix_i;;\sum_{i&#x3D;1}^{m}\alpha_iy_i&#x3D;0<br>$$</p>
<p>å°†å…¬å¼2ä»£å…¥å…¬å¼1å¾—åˆ°å¯¹å¶é—®é¢˜ï¼š</p>
<p>$$<br>å…¬å¼3;;max\sum_{i&#x3D;1}^{m}\alpha_i-\frac{1}{2}\sum_{i&#x3D;1}^{m}\sum_{j&#x3D;1}^{m}\alpha_iy_ix^T_i\alpha_jy_jx_j<br>$$</p>
<blockquote>
<p>è®¡ç®—æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<p><img data-src="/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/1678763077705.png" alt="1678763077705"></p>
</blockquote>
<p>ä¸Šè¿°è¿‡ç¨‹éœ€è¦æ»¡è¶³KKTæ¡ä»¶ï¼š</p>
<p>$$<br>\begin{cases}<br>    \alpha_i\ge0\y_if(x_i)-1\ge0\\alpha_i(y_if(x_i)-1)&#x3D;0<br>\end{cases}<br>$$</p>
<h3 id="2-3-æ ¸å‡½æ•°"><a href="#2-3-æ ¸å‡½æ•°" class="headerlink" title="2.3 æ ¸å‡½æ•°"></a>2.3 æ ¸å‡½æ•°</h3><p>å‰é¢æˆ‘ä»¬è®²è¯‰äº†çº¿æ€§å¯åˆ†ï¼Œé‚£ä¹ˆå¯èƒ½å°±ä¼šæœ‰äººæœ‰ç–‘é—®ï¼šé‚£ä¹ˆä¼šä¸ä¼šå­˜åœ¨çº¿æ€§ä¸å¯åˆ†çš„é—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬å…ˆçœ‹ä¸‹å›¾ï¼š</p>
<p><img data-src="/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/1678789201324.png" alt="1678789201324"></p>
<p>åŒæ ·éƒ½æ˜¯é»‘ç‚¹ç´«ç‚¹ä½†æ˜¯æ— è®ºä½ å¦‚ä½•ç”»ç›´çº¿éƒ½ä¸å¯èƒ½æ‰¾åˆ°è¿™ä¹ˆä¸€æ¡ç›´çº¿èƒ½å¤Ÿå®Œç¾çš„å°†ä¸¤è€…è¿›è¡ŒåŒºåˆ†ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯æ”¯æŒå‘é‡æœºå°±ä¸èµ·ä½œç”¨äº†ï¼Ÿä½†æ˜¯ï¼Œä»å›¾å¾ˆå®¹æ˜“çœ‹åˆ°æˆ‘ä»¬å¯ä»¥ç»˜åˆ¶ä¸€ä¸ªåœ†åœˆå°†ä¸¤è€…åˆ†å¼€ï¼Œä¹Ÿå°±æ˜¯è¯´å­˜åœ¨ä¸€ç§æ–¹æ³•å°†ä»–ä»¬åˆ’åˆ†å¼€æ¥ã€‚ä½†æ˜¯æˆ‘ä»¬çŸ¥é“æ”¯æŒå‘é‡æœºç®—æ³•æ˜¯æ‰¾åˆ°ä¸€ä¸ª<strong>è¶…å¹³é¢</strong>å»åˆ’åˆ†æ•°æ®é›†åˆï¼Œæ˜¾ç„¶åœ†æ˜¯ä¸ç¬¦åˆæˆ‘ä»¬è¦æ±‚çš„ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿå°±æ˜¯æˆ‘ä¹ˆä»Šå¤©è¦è®²çš„ä¸»è§’â€”â€”æ ¸å‡½æ•°</p>
<blockquote>
<p><em><strong>æ ¸å‡½æ•°</strong></em>ï¼šå°†æ ·æœ¬ç‚¹ä»ä½çº¬æ˜ å°„åˆ°é«˜ç»´çš„ç‰¹å¾ç©ºé—´ã€‚</p>
</blockquote>
<p><img data-src="/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/1678789607922.png" alt="1678789607922"></p>
<p>ä»ä¸Šå›¾å¾ˆå®¹æ˜“çŸ¥é“å¼€å§‹åœ¨2ç»´ç©ºé—´æˆ‘ä»¬æ‰¾ä¸åˆ°ä¸€æ¡ç›´çº¿åˆ’åˆ†ï¼Œä½†æ˜¯æ˜ å°„åˆ°3ç»´ç©ºé—´æ—¶ï¼Œæ­¤æ—¶å°±å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªè¶…å¹³é¢æŠŠä»–ä»¬åˆ’åˆ†å¼€æ¥ã€‚é‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬çº¿æ€§å¯åˆ†æ¨¡å‹å°±è½¬åŒ–æˆï¼š</p>
<p>$$<br>f(x)&#x3D;w^T\phi(x)+b;;\phi:ä»£è¡¨xçš„æ˜ å°„<br>$$</p>
<p>å¯¹å¶é—®é¢˜è½¬åŒ–ä¸ºï¼š</p>
<p>$$<br>max\sum_{i&#x3D;1}^{m}\alpha_i-\frac{1}{2}\sum_{i&#x3D;1}^{m}\sum_{j&#x3D;1}^{m}\alpha_iy_i\phi(x_i)^T\alpha_jy_j\phi(x_j)\\text{æˆ‘ä»¬ä»¤}k&#x3D;\phi(x_i)^T\phi(x_j)å³æˆ‘ä»¬çš„æ ¸å‡½æ•°<br>$$</p>
<p>å‡ ç§å¸¸ç”¨çš„æ ¸å‡½æ•°ï¼š</p>
<p><img data-src="/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/1678790610325.png" alt="1678790610325"></p>
<h3 id="2-4-è½¯é—´éš”ã€æ­£åˆ™åŒ–"><a href="#2-4-è½¯é—´éš”ã€æ­£åˆ™åŒ–" class="headerlink" title="2.4 è½¯é—´éš”ã€æ­£åˆ™åŒ–"></a>2.4 è½¯é—´éš”ã€æ­£åˆ™åŒ–</h3><p>ä»€ä¹ˆï¼Ÿé—´éš”è¿˜æœ‰è½¯ç¡¬ä¹‹åˆ†ï¼Ÿæ­¤è½¯ç¡¬éæˆ‘ä»¬æ‰€è®¤ä¸ºçš„è½¯ç¡¬ï¼æˆ‘ä»¬å‰é¢æ‰€è®¾æƒ³çš„éƒ½æ˜¯ï¼šæˆ‘ä»¬ç»˜åˆ¶çš„è¶…å¹³é¢å¯ä»¥<strong>å®Œå…¨</strong>å°†æˆ‘ä»¬çš„æ•°æ®ç‚¹è¿›è¡Œåˆ’åˆ†ï¼Œä½†æ˜¯ä¼šä¸ä¼šå­˜åœ¨è¿™ä¹ˆä¸€ç§æƒ…å†µâ€”â€”æ— è®ºä½ å¦‚ä½•ç»˜åˆ¶è¶…å¹³é¢æ€»æ˜¯ä¼šæœ‰éƒ¨åˆ†ç‚¹ä¼šé”™åˆ†å‘¢ï¼Ÿè§ä¸‹å›¾ï¼š</p>
<p><img data-src="/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA%5C1679056981202.png" alt="1679056981202"></p>
<p>æ€»æ˜¯æœ‰å°é»‘è·‘åˆ°å°ç´«è¿™è¾¹ï¼ŒåŒæ—¶ä¹Ÿæ€»æ˜¯æœ‰å°ç´«è·‘åˆ°å°é»‘è¿™è¾¹ã€‚é‚£ä¹ˆè½¯é—´éš”å°±æ˜¯<strong>å…è®¸æ”¯æŒå‘é‡æœºåœ¨ä¸€äº›æ ·æœ¬ä¸Šå‡ºé”™</strong></p>
<h2 id="ä¸‰ã€Pythonä»£ç "><a href="#ä¸‰ã€Pythonä»£ç " class="headerlink" title="ä¸‰ã€Pythonä»£ç "></a>ä¸‰ã€Pythonä»£ç </h2><h2 id="å››ã€è¯„ä»·"><a href="#å››ã€è¯„ä»·" class="headerlink" title="å››ã€è¯„ä»·"></a>å››ã€è¯„ä»·</h2><p><strong>ä¼˜ç‚¹</strong></p>
<ul>
<li>å¯ä»¥è§£å†³é«˜ç»´é—®é¢˜ï¼Œå³å¤§å‹ç‰¹å¾ç©ºé—´ï¼›</li>
<li>è§£å†³å°æ ·æœ¬ä¸‹æœºå™¨å­¦ä¹ é—®é¢˜ï¼›</li>
<li>èƒ½å¤Ÿå¤„ç†éçº¿æ€§ç‰¹å¾çš„ç›¸äº’ä½œç”¨ï¼›</li>
<li>æ— å±€éƒ¨æå°å€¼é—®é¢˜ï¼›ï¼ˆç›¸å¯¹äºç¥ç»ç½‘ç»œç­‰ç®—æ³•ï¼‰</li>
<li>æ— éœ€ä¾èµ–æ•´ä¸ªæ•°æ®ï¼›</li>
<li>æ³›åŒ–èƒ½åŠ›æ¯”è¾ƒå¼ºï¼›</li>
</ul>
<p><strong>ç¼ºç‚¹</strong></p>
<ul>
<li>å½“è§‚æµ‹æ ·æœ¬å¾ˆå¤šæ—¶ï¼Œæ•ˆç‡å¹¶ä¸æ˜¯å¾ˆé«˜ï¼›</li>
<li>å¯¹éçº¿æ€§é—®é¢˜æ²¡æœ‰é€šç”¨è§£å†³æ–¹æ¡ˆï¼Œæœ‰æ—¶å€™å¾ˆéš¾æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„æ ¸å‡½æ•°ï¼›</li>
<li>å¯¹äºæ ¸å‡½æ•°çš„é«˜ç»´æ˜ å°„è§£é‡ŠåŠ›ä¸å¼ºï¼Œå°¤å…¶æ˜¯å¾„å‘åŸºå‡½æ•°ï¼›</li>
<li>å¸¸è§„SVMåªæ”¯æŒäºŒåˆ†ç±»ï¼›</li>
<li><strong>å¯¹ç¼ºå¤±æ•°æ®æ•æ„Ÿï¼›</strong></li>
</ul>
<h2 id="äº”ã€ç®—æ³•æµç¨‹"><a href="#äº”ã€ç®—æ³•æµç¨‹" class="headerlink" title="äº”ã€ç®—æ³•æµç¨‹"></a>äº”ã€ç®—æ³•æµç¨‹</h2><h2 id="ä¸ƒã€å‚è€ƒ"><a href="#ä¸ƒã€å‚è€ƒ" class="headerlink" title="ä¸ƒã€å‚è€ƒ"></a>ä¸ƒã€å‚è€ƒ</h2><blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/440297403">https://zhuanlan.zhihu.com/p/440297403</a></p>
<p>æèˆªã€Šç»Ÿè®¡å­¦å­¦ä¹ æ–¹æ³•(ç¬¬äºŒç‰ˆ)ã€‹</p>
<p>ã€Šè¥¿ç“œä¹¦ã€‹</p>
</blockquote>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>æ”¯æŒå‘é‡æœº</tag>
      </tags>
  </entry>
  <entry>
    <title>æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§--LIME</title>
    <url>/posts/cd6f0230/</url>
    <content><![CDATA[<center>â€œWhy Should I Trust You?â€ Explaining the Predictions of Any Classifier</center>

<center>trusting a prediction or trusting a model</center>

<p>å¦‚æœâ¼€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹è¿â¾è‰¯å¥½ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä»…ä»…ä¿¡ä»»è¯¥æ¨¡å‹â½½å¿½ç•¥ä¸ºä»€ä¹ˆåšå‡ºç‰¹å®šçš„å†³ç­–å‘¢ï¼Ÿ<br>è¯¸å¦‚åˆ†ç±»å‡†ç¡®æ€§ä¹‹ç±»çš„å•â¼€æŒ‡æ ‡â½†æ³•å®Œæ•´åœ°æè¿°â¼¤å¤šæ•°å®é™…ä»»åŠ¡ã€‚å½“æ¶‰åŠåˆ°é¢„æµ‹æ¨¡å‹æ—¶ï¼Œéœ€è¦ä½œå‡ºæƒè¡¡ï¼š<strong>ä½ æ˜¯åªæƒ³çŸ¥é“é¢„æµ‹æ˜¯ä»€ä¹ˆï¼Ÿ</strong>ä¾‹å¦‚ï¼Œå®¢æˆ·æµå¤±çš„æ¦‚ç‡æˆ–æŸç§è¯ç‰©å¯¹ç—…â¼ˆçš„ç–—æ•ˆã€‚<strong>è¿˜æ˜¯æƒ³çŸ¥é“ä¸ºä»€ä¹ˆåšå‡ºè¿™æ ·çš„é¢„æµ‹ï¼Ÿ</strong>è¿™ç§æƒ…å†µä¸‹å¯èƒ½ä¸ºäº†å¯è§£é‡Šæ€§ä»˜å‡ºé¢„æµ‹æ€§èƒ½ä¸‹é™çš„ä»£ä»·ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ ä¸å¿…å…³â¼¼ä¸ºä»€ä¹ˆè¦åšå‡ºè¿™æ ·çš„é¢„æµ‹ï¼Œåªè¦çŸ¥é“æ¨¡å‹åœ¨æµ‹è¯•æ•°æ®é›†çš„é¢„æµ‹æ€§èƒ½è‰¯å¥½å°±â¾œå¤Ÿäº†ã€‚ä½†æ˜¯åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œäº†è§£ â€œä¸ºä»€ä¹ˆâ€ å¯ä»¥å¸®åŠ©ä½ æ›´å¤šåœ°äº†è§£é—®é¢˜ã€æ•°æ®ä»¥åŠæ¨¡å‹å¯èƒ½å¤±è´¥çš„åŸå› ã€‚æœ‰äº›æ¨¡å‹å¯èƒ½ä¸éœ€è¦è§£é‡Šï¼Œå› ä¸ºå®ƒä»¬æ˜¯åœ¨ä½é£é™©çš„ç¯å¢ƒä¸­ä½¿â½¤çš„ï¼Œè¿™æ„å‘³ç€é”™è¯¯ä¸ä¼šé€ æˆä¸¥é‡åæœ (ä¾‹å¦‚ï¼Œç”µå½±æ¨èç³»ç»Ÿ)ï¼Œæˆ–è€…è¯¥â½…æ³•å·²ç»è¢«â¼´æ³›ç ”ç©¶å’Œè¯„ä¼° (ä¾‹å¦‚ï¼Œå…‰å­¦å­—ç¬¦è¯†åˆ« OCR)ã€‚å¯¹å¯è§£é‡Šæ€§çš„éœ€æ±‚æ¥â¾ƒé—®é¢˜å½¢å¼åŒ–çš„ä¸å®Œæ•´æ€§ï¼Œè¿™æ„å‘³ç€å¯¹äºæŸäº›é—®é¢˜æˆ–ä»»åŠ¡ï¼Œä»…ä»…è·å¾—é¢„æµ‹ç»“æœæ˜¯ä¸å¤Ÿçš„ã€‚è¯¥æ¨¡å‹è¿˜å¿…é¡»è§£é‡Šæ˜¯æ€ä¹ˆè·å¾—è¿™ä¸ªé¢„æµ‹çš„ï¼Œå› ä¸ºæ­£ç¡®çš„é¢„æµ‹åªéƒ¨åˆ†åœ°è§£å†³äº†ä½ çš„åŸå§‹é—®é¢˜ã€‚</p>
<span id="more"></span>

<h1 id="æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§"><a href="#æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§" class="headerlink" title="æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§"></a>æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§</h1><p>éœ€è¦å»ºç«‹ä¸€ä¸ªè§£é‡Šå™¨æ¥è§£é‡Šé»‘ç›’æ¨¡å‹ï¼Œå¹¶ä¸”è¿™ä¸ªè§£é‡Šå™¨å¿…é¡»æ»¡è¶³ä»¥ä¸‹ç‰¹å¾ï¼š<br><strong>å¯è§£é‡Šæ€§</strong><br>è¦æ±‚è§£é‡Šå™¨çš„æ¨¡å‹ä¸ç‰¹å¾éƒ½å¿…é¡»æ˜¯å¯è§£é‡Šçš„ï¼Œåƒå†³ç­–æ ‘ã€çº¿æ€§æ¨¡å‹éƒ½æ˜¯å¾ˆé€‚åˆæ‹¿æ¥è§£é‡Šçš„æ¨¡å‹ï¼›è€Œå¯è§£é‡Šçš„æ¨¡å‹å¿…é¡»æ­é…å¯è§£é‡Šçš„ç‰¹å¾ï¼Œæ‰æ˜¯çœŸæ­£çš„å¯è§£é‡Šæ€§ï¼Œè®©ä¸äº†è§£æœºå™¨å­¦ä¹ çš„äººä¹Ÿèƒ½é€šè¿‡è§£é‡Šå™¨ç†è§£æ¨¡å‹ã€‚<br><strong>å±€éƒ¨ä¿çœŸåº¦</strong><br>æ—¢ç„¶æˆ‘ä»¬å·²ç»ä½¿ç”¨äº†å¯è§£é‡Šçš„æ¨¡å‹ä¸ç‰¹å¾ï¼Œå°±ä¸å¯èƒ½æœŸæœ›ç®€å•çš„å¯è§£é‡Šæ¨¡å‹åœ¨æ•ˆæœä¸Šç­‰åŒäºå¤æ‚æ¨¡å‹ï¼ˆæ¯”å¦‚åŸå§‹CNNåˆ†ç±»å™¨ï¼‰ã€‚æ‰€ä»¥è§£é‡Šå™¨ä¸éœ€è¦åœ¨å…¨å±€ä¸Šè¾¾åˆ°å¤æ‚æ¨¡å‹çš„æ•ˆæœï¼Œä½†è‡³å°‘åœ¨å±€éƒ¨ä¸Šæ•ˆæœè¦å¾ˆæ¥è¿‘ï¼Œè€Œæ­¤å¤„çš„å±€éƒ¨ä»£è¡¨æˆ‘ä»¬æƒ³è§‚å¯Ÿçš„é‚£ä¸ªæ ·æœ¬çš„å‘¨å›´ã€‚<br><strong>ä¸æ¨¡å‹æ— å…³</strong><br>è¿™é‡Œæ‰€æŒ‡çš„æ˜¯ä¸å¤æ‚æ¨¡å‹æ— å…³ï¼Œæ¢å¥è¯è¯´æ— è®ºå¤šå¤æ‚çš„æ¨¡å‹ï¼Œåƒæ˜¯SVMæˆ–ç¥ç»ç½‘ç»œï¼Œè¯¥è§£é‡Šå™¨éƒ½å¯ä»¥å·¥ä½œã€‚<br>é™¤äº†ä¼ ç»Ÿçš„ç‰¹å¾é‡è¦æ€§æ’åºå¤–ï¼ŒICEã€PDPã€SDTã€LIMEã€SHAPéƒ½æ˜¯æ­å¼€æœºå™¨å­¦ä¹ æ¨¡å‹é»‘ç®±çš„æœ‰åŠ›å·¥å…·ã€‚</p>
<ul>
<li>ç‰¹å¾é‡è¦æ€§è®¡ç®—ä¾æ®æŸä¸ªç‰¹å¾è¿›è¡Œå†³ç­–æ ‘åˆ†è£‚æ—¶ï¼Œåˆ†è£‚å‰åçš„ä¿¡æ¯å¢ç›Šï¼ˆåŸºå°¼ç³»æ•°ï¼‰ï¼›</li>
<li>ICEå’ŒPDPè€ƒå¯ŸæŸé¡¹ç‰¹å¾çš„ä¸åŒå–å€¼å¯¹æ¨¡å‹è¾“å‡ºå€¼çš„å½±å“ï¼›</li>
<li>SDTç”¨å•æ£µå†³ç­–æ ‘è§£é‡Šå…¶å®ƒæ›´å¤æ‚çš„æœºå™¨å­¦ä¹ æ¨¡å‹ï¼›</li>
<li>LIMEçš„æ ¸å¿ƒæ€æƒ³æ˜¯å¯¹äºæ¯æ¡æ ·æœ¬ï¼Œå¯»æ‰¾ä¸€ä¸ªæ›´å®¹æ˜“è§£é‡Šçš„ä»£ç†æ¨¡å‹è§£é‡ŠåŸæ¨¡å‹ï¼›</li>
<li>SHAPçš„æ¦‚å¿µæºäºåšå¼ˆè®ºï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯è®¡ç®—ç‰¹å¾å¯¹æ¨¡å‹è¾“å‡ºçš„è¾¹é™…è´¡çŒ®ï¼›</li>
</ul>
<hr>
<h1 id="æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§â€“LIME"><a href="#æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§â€“LIME" class="headerlink" title="æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§â€“LIME"></a>æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§â€“LIME</h1><p>[toc]</p>
<h2 id="æœºå™¨å­¦ä¹ çš„è§£é‡Šæ€§"><a href="#æœºå™¨å­¦ä¹ çš„è§£é‡Šæ€§" class="headerlink" title="æœºå™¨å­¦ä¹ çš„è§£é‡Šæ€§"></a>æœºå™¨å­¦ä¹ çš„è§£é‡Šæ€§</h2><p>Trusting a prediction, i.e. whether a user trusts an individual prediction sufficiently to take some action based on it, and  trusting a model, i.e. whether the user trusts a model to behave in reasonable ways if deployed.â€ (Ribeiro ç­‰, 2016, p. 1135)</p>
<blockquote>
<p>ä¿¡ä»»ä¸€ä¸ªé¢„æµ‹ï¼Œå³ç”¨æˆ·æ˜¯å¦å……åˆ†ä¿¡ä»»ä¸€ä¸ªä¸ªä½“çš„é¢„æµ‹ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šé‡‡å–è¡ŒåŠ¨ï¼›ä¿¡ä»»ä¸€ä¸ªæ¨¡å‹ï¼Œå³ç”¨æˆ·æ˜¯å¦ä¿¡ä»»ä¸€ä¸ªæ¨¡å‹åœ¨éƒ¨ç½²åçš„è¡Œä¸ºæ˜¯å¦åˆ</p>
</blockquote>
<p>LIME, an algorithm that can explain the predictions of any classifier or regressor in a faithful way, by approximating it locally with an interpretable model.â€ (Ribeiro ç­‰, 2016, p. 1135)</p>
<blockquote>
<p>LIMEæ˜¯ä¸€ç§ç®—æ³•ï¼Œé€šè¿‡ç”¨å¯è§£é‡Šçš„æ¨¡å‹å¯¹å…¶è¿›è¡Œ<strong>å±€éƒ¨è¿‘ä¼¼</strong>ï¼Œå¯ä»¥å¿ å®åœ°è§£é‡Šä»»ä½•åˆ†ç±»å™¨æˆ–å›å½’å™¨çš„é¢„æµ‹ã€‚</p>
</blockquote>
<p>æ‰€è°“æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§å°±æ˜¯ï¼šæˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªæ¨¡å‹é¢„æµ‹å¾—åˆ°äº†ä¸€ä¸ªç»“æœï¼Œä½†æ˜¯ä½ è¿™ä¸ª<strong>ç»“æœçœŸçš„å¯ä»¥è®©äººä¿¡æœå—</strong>ï¼ˆä»å®é™…ç”Ÿäº§è§’åº¦è€ƒè™‘ï¼Œä¸ä»æ¨¡å‹çš„å‡†ç¡®ç‡çš„è§’åº¦è€ƒè™‘ï¼‰ï¼Ÿè¿™ä¸ª<strong>æ¨¡å‹çš„å½±å“å› ç´ </strong>åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¦‚ä¸‹å›¾<a href="https://doi.org/10.1145/2939672.2939778">^2</a>ï¼š</p>
<img data-src="https://s2.loli.net/2023/06/04/Pm6VexD4KinwA2l.png" alt="æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§--LIME[^2]" style="zoom:60%;">

<p>æˆ‘ä»¬é€šè¿‡æ¨¡å‹é¢„æµ‹æµæ„Ÿï¼ˆfluï¼‰ï¼Œé€šè¿‡LIMEå¾—åˆ°çš„è§£é‡Šæ˜¯ï¼šå–·åšï¼ˆsneezeï¼‰ã€å¤´ç–¼ï¼ˆheadcheï¼‰å¯¹æµæ„Ÿé¢„æµ‹æ˜¯â€œæ”¯æŒâ€ï¼Œè€Œæ²¡æœ‰ç–²åŠ³ï¼ˆno fatigueï¼‰æ˜¯â€œåå¯¹â€ã€‚æˆ‘ä»¬å°†æ¨¡å‹ç»“æœäº¤ç»™å†³ç­–è€…ï¼ˆhuman make decisionï¼‰è®©å¥¹å¯¹æ¨¡å‹ç»“æœåšåˆ¤æ–­ã€‚<strong>æœºå™¨å­¦ä¹ </strong>åªèƒ½ä½œä¸ºæˆ‘ä»¬è¾…åŠ©å†³ç­–çš„å·¥å…·ï¼Œå¯¹äºå®é™…å†³ç­–è¿˜æ˜¯ä¾é <strong>äººç±»</strong>ã€‚è€Œæˆ‘ä»¬çš„å†³ç­–çš„ä¾æ®å°±æ˜¯<strong>è§£é‡Š</strong>ï¼ˆexplainerï¼‰ï¼Œæˆ‘ä»¬æ ¹æ®ç»™å‡ºçš„è§£é‡Šæ¥åˆ¤åˆ«æ¨¡å‹æ˜¯å¦å¯ä½œä¸ºæˆ‘ä»¬çš„å†³ç­–ä¾æ®ã€‚</p>
<h2 id="LIMEåŸç†"><a href="#LIMEåŸç†" class="headerlink" title="LIMEåŸç†"></a>LIMEåŸç†</h2><p><strong>LIMEï¼ˆLocal Interpretable Model-agnostic Explanationsï¼‰</strong>ã€‚è¯¥æ¨¡å‹æ˜¯ä¸€ä¸ª<strong>å±€éƒ¨</strong>å¯è§£é‡Šæ¨¡å‹ï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªä¸æ¨¡å‹è‡ªèº«çš„æ— å…³çš„å¯è§£é‡Šæ–¹æ³•ã€‚ä½¿ç”¨è®­ç»ƒçš„<strong>å±€éƒ¨ä»£ç†æ¨¡å‹</strong>æ¥å¯¹å•ä¸ªæ ·æœ¬è¿›è¡Œè§£é‡Šã€‚å‡è®¾å¯¹äºéœ€è¦è§£é‡Šçš„é»‘ç›’æ¨¡å‹ï¼Œå–å…³æ³¨çš„å®ä¾‹æ ·æœ¬(<strong>å¯è§£é‡Šè¾“å…¥$x$</strong>)ï¼Œåœ¨å…¶é™„è¿‘è¿›è¡Œæ‰°åŠ¨ç”Ÿæˆæ–°çš„æ ·æœ¬ç‚¹(<strong>ç”Ÿæˆæ‰°åŠ¨æ ·æœ¬</strong>)ï¼Œå¹¶å¾—åˆ°é»‘ç›’æ¨¡å‹çš„é¢„æµ‹å€¼ï¼Œä½¿ç”¨æ–°çš„æ•°æ®é›†ï¼ˆ<strong>æ‰°åŠ¨æ ·æœ¬</strong>ï¼‰è®­ç»ƒå¯è§£é‡Šçš„æ¨¡å‹ï¼ˆå¦‚çº¿æ€§å›å½’ã€å†³ç­–æ ‘ï¼‰ï¼Œå¾—åˆ°å¯¹é»‘ç›’æ¨¡å‹è‰¯å¥½çš„å±€éƒ¨è¿‘ä¼¼<a href="https://blog.csdn.net/iqdutao/article/details/108397239">^1</a>ã€‚</p>
<p>â€œThe overall goal of LIME is to identify an interpretable model over the interpretable representation that is locally faithful to the classifier.â€ (Ribeiro ç­‰, 2016, p. 1137)</p>
<blockquote>
<p>LIMEçš„æ€»ä½“ç›®æ ‡æ˜¯åŸºäºå±€éƒ¨å¯è§£é‡Šæ€§æ¨¡å‹ åœ¨å±€éƒ¨å¿ å®äºåˆ†ç±»å™¨çš„å¯è§£é‡Šè¡¨ç¤ºä¸Šè¯†åˆ«ä¸€ä¸ªå¯è§£é‡Šæ¨¡å‹ã€‚</p>
</blockquote>
<p>LIMEç‰¹ç‚¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>Localï¼šå±€éƒ¨ä¿è¯åº¦ï¼Œå³æˆ‘ä»¬å¸Œæœ›è§£é‡ŠçœŸå®åæ˜ çš„åˆ†ç±»å™¨</li>
</ul>
<h2 id="LIMEè®¡ç®—"><a href="#LIMEè®¡ç®—" class="headerlink" title="LIMEè®¡ç®—"></a>LIMEè®¡ç®—</h2><p>å‡è®¾$f$ä½œä¸ºæˆ‘ä»¬éœ€è¦è§£é‡Šçš„æ¨¡å‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å®šä¹‰è§£é‡Šæ¨¡å‹$g \in G$ ï¼Œ$G$ä½œä¸º<strong>è§£é‡Šæ—å‡½æ•°</strong>ï¼ˆä¸€ç³»åˆ—å¯èƒ½çš„è§£é‡Šæ¨¡å‹ï¼ˆçº¿æ€§æ¨¡å‹ã€å†³ç­–æ ‘æ¨¡å‹ç­‰ï¼‰ï¼‰ï¼Œå› ä¸ºå¹¶ä¸æ˜¯æ¯ä¸€ä¸ª$g\in G$éƒ½å¯èƒ½æ˜¯ç®€å•åˆ°å¯ä»¥è§£é‡Šçš„ï¼Œå› æ­¤å®šä¹‰$\Omega(g)$ä½œä¸º<strong>å¤æ‚å½¢æµ‹åº¦</strong>ï¼Œ$\pi_{x}$ä½œä¸ºå®ä¾‹$z$åˆ°$x$ä¹‹é—´çš„é‚»è¿‘åº¦é‡ï¼Œä»è€Œå®šä¹‰$x$å‘¨å›´çš„å±€éƒ¨æ€§ã€‚æœ€åå®šä¹‰$L(f,g,\pi_{x})$ä½œä¸ºä¸å¿ å®$g$åœ¨$\pi_{x}$å®šä¹‰çš„å±€éƒ¨ä¸­é€¼è¿‘$f$ï¼Œä¸ºäº†ä¿è¯<strong>å¯è§£é‡Šæ€§</strong>å’Œ<strong>å±€éƒ¨å¿ å®æ€§</strong>è®¡ç®—å…¬å¼ï¼š</p>
<p>$$<br>\xi(s)&#x3D; argmin_{g\in G} L(f,g,\pi_{x})+\Omega(g)<br>$$</p>
<h3 id="å±€éƒ¨æ¢ç´¢"><a href="#å±€éƒ¨æ¢ç´¢" class="headerlink" title="å±€éƒ¨æ¢ç´¢"></a>å±€éƒ¨æ¢ç´¢</h3><p>å‰é¢æåŠåˆ°äº†LIMEæ˜¯ä¸€ç§å±€éƒ¨æ¢ç´¢å¯è§£é‡Šæ¨¡å‹ï¼Œé‚£ä¹ˆå…¶å±€éƒ¨æ¢ç´¢åŠŸèƒ½å¦‚ä½•å®ç°å‘¢ï¼Ÿåœ¨è®ºæ–‡ä¸­çš„ <code>3.3 Sampling for Local Exploration</code>ä½œè€…ç»™å‡ºè§£é‡Šå¦‚ä¸‹ï¼š<br>å¦‚å…¬å¼1æ‰€ç¤ºæˆ‘ä»¬éœ€è¦æœ€å°åŒ–$L(f,g,\pi_{x})$ï¼Œæˆ‘ä»¬åœ¨$x$å‘¨å›´ç”Ÿæˆ<strong>æ‰°åŠ¨æ ·æœ¬</strong>ï¼ˆperturbed sampleï¼‰è®¾ç”Ÿæˆçš„æ‰°åŠ¨æ ·æœ¬ä¸º$Z$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ ¹æ®æˆ‘ä»¬çš„$f$å¯¹æˆ‘ä»¬æ‰€ç”Ÿæˆçš„æ‰°åŠ¨æ ·æœ¬è¿›è¡Œå¤„ç†å³ï¼š$f(Z)$ï¼Œæˆ‘ä»¬å¯¹æ‰°åŠ¨æ ·æœ¬è¿›è¡ŒåŠ æƒï¼ˆè·ç¦»$x$è¿‘çš„èµ‹äºˆè¾ƒå¤§æƒé‡ï¼Œåä¹‹åˆ™è¾ƒå°æƒé‡ï¼‰</p>
<blockquote>
<p>â€œwhere we sample instances both in the vicinity of $x$ (which have a high weight due to $\pi_{x}$) and far away from x (low weight from $\pi_{x}$).â€ ([Ribeiro ç­‰, 2016, p. 1137]<br>å…¶ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«åœ¨$x$ (ç”±äº$\pi_{x}$è€Œå…·æœ‰å¾ˆé«˜çš„æƒé‡)é™„è¿‘å’Œè¿œç¦»$x$ (æ¥è‡ª$\pi_{x}$çš„ä½æƒé‡)çš„åœ°æ–¹é‡‡æ ·å®ä¾‹ã€‚</p>
</blockquote>
<p>ä½œè€…åœ¨è®ºæ–‡ä¸­æåˆ°å³ä½¿åŸå§‹æ¨¡å‹ï¼ˆ$f$ï¼‰å¾ˆéš¾å…¨å±€è¿›è¡Œè§£é‡Šï¼Œä½†æ˜¯LIMEèƒ½å¤Ÿåœ¨å±€éƒ¨è¿›è¡Œåˆç†è§£é‡Š</p>
<blockquote>
<p>ven though the original model may be too complex to explain globally, LIME presents an explanation that is locally faithful</p>
</blockquote>
<h3 id="ç¨€ç–çº¿æ€§è§£é‡Š"><a href="#ç¨€ç–çº¿æ€§è§£é‡Š" class="headerlink" title="ç¨€ç–çº¿æ€§è§£é‡Š"></a>ç¨€ç–çº¿æ€§è§£é‡Š</h3><p>è®ºæ–‡ä½œè€…è®¾ç½®è§£é‡Šæ—å‡½æ•°$G$ä¸ºçº¿æ€§æ¨¡å‹ï¼ˆ$g(Z)&#x3D;w_{g}z$ï¼‰ï¼Œè®¾ç½®$L$ä¸º</p>
<p>$$<br>\underset{z,z^{â€˜}\in Z}{\sum}\pi_{x}(z)(f(z)-g(z^{â€˜}))^{2}<br>$$</p>
<p>$\pi_{x}$ä¸º$exp(\frac{-D(x,z)^{2}}{\sigma^{2}})$ï¼Œä¸Šé¢æåŠåˆ°çš„æ‰°åŠ¨æ ·æœ¬$Z$ï¼Œå¯¹äºæ‰°åŠ¨æ ·æœ¬è®¾è®¡çº¿æ€§å‡½æ•°å»å¯¹æ‰°åŠ¨æ ·æœ¬è¿›è¡ŒåŒºåˆ†ï¼ˆå·²åˆ†ç±»ç®—æ³•ä¸ºä¾‹ï¼‰é‚£ä¹ˆæˆ‘ä»¬æ‰€èµ‹äºˆçš„ä¸åŒçš„æƒé‡$w_{g}$å°±æ˜¯ä¸åŒçš„æ ·æœ¬ä¸­ä¸åŒç‰¹å¾çš„å½±å“ã€‚</p>
<h3 id="LIMEæ­¥éª¤"><a href="#LIMEæ­¥éª¤" class="headerlink" title="LIMEæ­¥éª¤"></a>LIMEæ­¥éª¤</h3><ul>
<li>å¯¹æ•´ä¸ªæ•°æ®è¿›è¡Œè®­ç»ƒï¼Œæ¨¡å‹å¯ä»¥æ˜¯Lightgbmï¼ŒXGBoostç­‰å¤æ‚çš„æ¨¡å‹ï¼ˆæœ¬èº«ä¸å¯è§£é‡Šï¼‰;</li>
<li>é€‰æ‹©æˆ‘ä»¬æƒ³è¦è§£é‡Šçš„å˜é‡$x$;</li>
<li>å¯¹æ•°æ®é›†ä¸­çš„æ•°æ®è¿›è¡Œå¯è§£é‡Šçš„Næ¬¡æ‰°åŠ¨ï¼Œç”Ÿæˆæ‰°åŠ¨æ ·æœ¬;</li>
<li>å¯¹è¿™äº›æ–°çš„æ ·æœ¬æ±‚å‡ºæƒé‡ï¼Œè¿™ä¸ªæƒé‡æ˜¯è¿™äº›æ•°æ®ç‚¹ä¸æˆ‘ä»¬è¦è§£é‡Šçš„æ•°æ®ä¹‹é—´çš„è·ç¦»;</li>
<li>æ ¹æ®ä¸Šé¢æ–°çš„æ•°æ®é›†ï¼Œæ‹Ÿåˆä¸€ä¸ªç®€å•çš„æ¨¡å‹$g$ï¼Œæ¯”å¦‚Lasso Regressionå¾—åˆ°æ¨¡å‹çš„æƒé‡;</li>
<li>é€šè¿‡ç®€å•æ¨¡å‹$g$æ¥å¯¹åŸå¤æ‚æ¨¡å‹åœ¨$x$ç‚¹é™„è¿‘è¿›è¡Œè§£é‡Š;</li>
</ul>
<h2 id="LIMEç›´è§‚è§£é‡Š"><a href="#LIMEç›´è§‚è§£é‡Š" class="headerlink" title="LIMEç›´è§‚è§£é‡Š"></a>LIMEç›´è§‚è§£é‡Š</h2><h3 id="1ã€åˆ†ç±»ç®—æ³•"><a href="#1ã€åˆ†ç±»ç®—æ³•" class="headerlink" title="1ã€åˆ†ç±»ç®—æ³•"></a>1ã€åˆ†ç±»ç®—æ³•</h3><img data-src="https://s2.loli.net/2023/06/05/RqaWkvG7wHSo6jF.png" alt="202306052009422" style="zoom:50%;">

<p>å¦‚ä¸Šå›¾ä¸åŒçš„é¢œè‰²å—ä»£è¡¨ä¸åŒçš„ç±»åˆ«ï¼ˆè“è‰²å’Œç²‰è‰²ï¼‰ï¼Œå¾ˆéš¾é€šè¿‡çº¿æ€§æ¨¡å‹è¿›è¡Œè¿‘ä¼¼ã€‚å› æ­¤è¾“å…¥æ ·æœ¬ï¼ˆåŠ é‡çº¢è‰²Ã—ï¼‰åœ¨å…¶å‘¨å›´ç”Ÿæˆä¸åŒçš„æ‰°åŠ¨æ ·æœ¬ï¼ˆÃ—å’ŒÂ·ï¼Œå…¶å¤§å°ä»£è¡¨è·ç¦»ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ‰€ç”Ÿæˆçš„æ‰°åŠ¨æ ·æœ¬æ„å»ºçº¿æ€§å‡½æ•°è¿›è¡ŒåŒºåˆ†ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<img data-src="https://s2.loli.net/2023/06/05/W2h9NPIY1sDdwi6.png" alt="202306052008339" style="zoom:60%;">

<h3 id="2ã€å›¾åƒè¯†åˆ«"><a href="#2ã€å›¾åƒè¯†åˆ«" class="headerlink" title="2ã€å›¾åƒè¯†åˆ«"></a>2ã€å›¾åƒè¯†åˆ«</h3><p>åœ¨Local Interpretable Model-Agnostic Explanations (LIME): An Introduction<a href="https://www.oreilly.com/content/introduction-to-local-interpretable-model-agnostic-explanations-lime/">^3</a>ä¸­ä½œè€…å¯¹å›¾åƒè¯†åˆ«åšå‡ºäº†è§£é‡Šã€‚å¯¹ä¸€åªæ ‘è›™è¿›è¡Œåˆ†ç±»ï¼š</p>
<img data-src="https://s2.loli.net/2023/06/05/srhUdaWXZK1jwgT.png" alt="202306052008339" style="zoom:60%;">

<p>å°†ä¸€äº›å¯è§£é‡Šçš„æˆåˆ† â€œå…³é—­â€ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿å®ƒä»¬å˜æˆç°è‰²ï¼‰æ¥ç”Ÿæˆä¸€ç»„æ‰°ä¹±å®ä¾‹çš„æ•°æ®ã€‚å¯¹äºæ¯ä¸ªè¢«æ‰°ä¹±çš„å®ä¾‹ï¼Œæˆ‘ä»¬æ ¹æ®æ¨¡å‹å¾—åˆ°æ ‘è›™åœ¨å›¾åƒä¸­çš„æ¦‚ç‡ã€‚ç„¶åæˆ‘ä»¬åœ¨è¿™ä¸ªæ•°æ®é›†ä¸Šå­¦ä¹ ä¸€ä¸ªç®€å•çš„ï¼ˆçº¿æ€§ï¼‰æ¨¡å‹ï¼Œè¿™ä¸ªæ¨¡å‹æ˜¯å±€éƒ¨åŠ æƒçš„â€“ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ›´å…³å¿ƒåœ¨ä¸åŸå§‹å›¾åƒæ›´ç›¸ä¼¼çš„æ‰°åŠ¨å®ä¾‹ä¸­çŠ¯é”™è¯¯ã€‚æœ€åï¼Œæˆ‘ä»¬å°†å…·æœ‰æœ€é«˜æ­£å‘æƒé‡çš„è¶…çº§åƒç´ ä½œä¸ºè§£é‡Šï¼Œè€Œå°†å…¶ä»–çš„ä¸œè¥¿æ¶‚æˆç°è‰²ã€‚</p>
<img data-src="https://s2.loli.net/2023/06/05/xTNHmRpBsW52Lna.png" alt="202306052008339" style="zoom:60%;">

<p>æˆ‘ä»¬åœ¨ä»»æ„å›¾åƒä¸Šè§£é‡Šè°·æ­Œçš„ Inception ç¥ç»ç½‘ç»œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚ä¸‹å›¾ æ‰€ç¤ºï¼Œåˆ†ç±»å™¨å°†â€œæ ‘è›™â€é¢„æµ‹ä¸ºæœ€æœ‰å¯èƒ½çš„ç±»åˆ«ï¼Œå…¶æ¬¡æ˜¯æ¦‚ç‡è¾ƒä½çš„â€œå°çƒæ¡Œâ€å’Œâ€œæ°”çƒâ€ã€‚è§£é‡Šè¡¨æ˜åˆ†ç±»å™¨ä¸»è¦å…³æ³¨é’è›™çš„è„¸ä½œä¸ºå¯¹é¢„æµ‹ç±»åˆ«çš„è§£é‡Šã€‚å®ƒè¿˜é˜æ˜äº†ä¸ºä»€ä¹ˆâ€œå°çƒæ¡Œâ€çš„æ¦‚ç‡ä¸ä¸ºé›¶ï¼šé’è›™çš„æ‰‹å’Œçœ¼ç›ä¸å°çƒå¾ˆç›¸ä¼¼ï¼Œå°¤å…¶æ˜¯åœ¨ç»¿è‰²èƒŒæ™¯ä¸‹ã€‚åŒæ ·ï¼Œçˆ±å¿ƒä¹Ÿå¾ˆåƒä¸€ä¸ªçº¢è‰²çš„æ°”çƒã€‚</p>
<img data-src="https://s2.loli.net/2023/06/05/bE4x2AP1dktK8VZ.png" alt="202306052008339" style="zoom:60%;">

<h2 id="LIMEä¼˜ç¼ºç‚¹"><a href="#LIMEä¼˜ç¼ºç‚¹" class="headerlink" title="LIMEä¼˜ç¼ºç‚¹"></a>LIMEä¼˜ç¼ºç‚¹</h2><p>1ã€LIMEç®—æ³•æœ‰å¾ˆå¼ºçš„é€šç”¨æ€§ï¼Œæ•ˆæœå¥½ã€‚LIMEé™¤äº†èƒ½å¤Ÿå¯¹å›¾åƒçš„åˆ†ç±»ç»“æœè¿›è¡Œè§£é‡Šå¤–ï¼Œè¿˜å¯ä»¥åº”ç”¨åˆ°è‡ªç„¶è¯­è¨€å¤„ç†çš„ç›¸å…³ä»»åŠ¡ä¸­ï¼Œå¦‚ä¸»é¢˜åˆ†ç±»ã€è¯æ€§æ ‡æ³¨ç­‰ã€‚å› ä¸ºLIMEæœ¬èº«çš„å‡ºå‘ç‚¹å°±æ˜¯æ¨¡å‹æ— å…³çš„ï¼Œå…·æœ‰å¹¿æ³›çš„é€‚ç”¨æ€§ã€‚</p>
<p>2ã€LIMEç®—æ³•é€Ÿåº¦æ…¢ï¼ŒLIMEåœ¨é‡‡æ ·å®Œæˆåï¼Œæ¯å¼ é‡‡æ ·å‡ºæ¥çš„å›¾ç‰‡éƒ½è¦é€šè¿‡åŸæ¨¡å‹é¢„æµ‹ä¸€æ¬¡ç»“æœï¼Œæ‰€ä»¥åœ¨é€Ÿåº¦ä¸Šæ²¡æœ‰æ˜æ˜¾ä¼˜åŠ¿ã€‚</p>
<p>3ã€LIMEç®—æ³•æ‹“å±•æ–¹å‘ï¼Œæœ¬æ–‡çš„ä½œè€…åœ¨18å¹´æ–°æå‡ºäº†Anchorsçš„æ–¹æ³•ï¼ŒæŒ‡çš„æ˜¯å¤æ‚æ¨¡å‹åœ¨å±€éƒ¨æ‰€å‘ˆç°å‡ºæ¥çš„å¾ˆå¼ºçš„è§„åˆ™æ€§çš„è§„å¾‹ï¼Œæ³¨æ„å’ŒLIMEçš„åŒºåˆ«ï¼ŒLIMEæ˜¯åœ¨å±€éƒ¨å»ºç«‹ä¸€ä¸ªå¯ç†è§£çš„çº¿æ€§å¯åˆ†æ¨¡å‹ï¼Œè€ŒAnchorsçš„ç›®çš„æ˜¯å»ºç«‹ä¸€å¥—æ›´ç²¾ç»†çš„è§„åˆ™ç³»ç»Ÿã€‚åœ¨å’Œæ–‡æœ¬ç›¸å…³çš„ä»»åŠ¡ä¸Šæœ‰ä¸é”™çš„è¡¨ç°ã€‚æœ‰å¾…æˆ‘ä»¬ç»§ç»­ç ”ç©¶ã€‚</p>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>è¡¨æ ¼å‹æ•°æ®ã€æ–‡æœ¬å’Œå›¾ç‰‡å‡é€‚ç”¨ï¼›</li>
<li>è§£é‡Šå¯¹äººå‹å¥½ï¼Œå®¹æ˜“æ˜ç™½ï¼›</li>
<li>ç»™å‡ºä¸€ä¸ªå¿ è¯šæ€§åº¦é‡ï¼Œåˆ¤æ–­å¯è§£é‡Šæ¨¡å‹æ˜¯å¦å¯é ï¼›</li>
<li>LIMEå¯ä»¥ä½¿ç”¨åŸæ¨¡å‹æ‰€ç”¨ä¸åˆ°çš„ä¸€äº›ç‰¹å¾æ•°æ®ï¼Œæ¯”å¦‚æ–‡æœ¬ä¸­ä¸€ä¸ªè¯æ˜¯å¦å‡ºç°ã€‚</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>è¡¨æ ¼å‹æ•°æ®ä¸­ï¼Œç›¸é‚»ç‚¹å¾ˆéš¾å®šä¹‰ï¼Œéœ€è¦å°è¯•ä¸åŒçš„kernelæ¥çœ‹LIMEç»™å‡ºçš„å¯è§£é‡Šæ˜¯å¦åˆç†ï¼›</li>
<li>æ‰°åŠ¨æ—¶ï¼Œæ ·æœ¬æœä»é«˜æ–¯åˆ†å¸ƒï¼Œå¿½è§†äº†ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§ï¼›</li>
<li>ç¨³å®šæ€§ä¸å¤Ÿå¥½ï¼Œé‡å¤åŒæ ·çš„æ“ä½œï¼Œæ‰°åŠ¨ç”Ÿæˆçš„æ ·æœ¬ä¸åŒï¼Œç»™å‡ºçš„è§£é‡Šå¯èƒ½ä¼šå·®åˆ«å¾ˆå¤§ã€‚</li>
</ul>
<h2 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h2><p><a href="http://hjiezero.github.io/posts/32fedbdb/">http://hjiezero.github.io/posts/32fedbdb/</a></p>
<h1 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h1><p>Pythonåº“<a href="https://github.com/marcotcr/lime">LIME</a>æä¾›äº†å®ç°æ¨¡å‹è§£é‡Šçš„æ¥å£ï¼ŒæŒ‰æ•°æ®ç±»å‹åˆ†ä¸ºè¡¨æ ¼(LimeTabularExplainer), å›¾åƒ(LimeImageExplainer) å’Œæ–‡æœ¬(LimeTextExplainer)<br>åˆ›å»ºLimeTabularExplainer ç±»<a href="https://e0hyl.github.io/BLOG-OF-E0/LIMEandSHAP/">^4</a></p>
<ul>
<li>å¿…è¦å‚æ•°æ˜¯ <code>training_data</code>,å› ä¸ºé‡‡æ ·æ—¶ä¼šä¾ç…§è®­ç»ƒæ•°æ®çš„åˆ†å¸ƒï¼Œç±»å‹æ˜¯ <code>numpy</code> äºŒç»´æ•°ç»„ï¼›</li>
<li><code>feature_names</code> å’Œ <code>class_names</code> åˆ†åˆ«æ˜¯ç‰¹å¾å’Œç±»åˆ«çš„åå­—ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼›</li>
<li>ç”±äºç±»åˆ«æ•°æ®å’Œæ•°å€¼æ•°æ®çš„å¤„ç†æ–¹å¼ä¸åŒï¼Œéœ€è¦æŠŠå¯¹åº”çš„ç‰¹å¾ç¼–å·ä¼ å…¥å‚æ•° <code>categorical_features</code> ä¸­ï¼›</li>
<li>mode å‚æ•°ä»£è¡¨ä»»åŠ¡çš„ç±»å‹ï¼Œå¯é€‰åˆ†ç±»ï¼ˆ<code>classification</code>ï¼‰æˆ–å›å½’ï¼ˆ<code>regression</code>ï¼‰ã€‚</li>
</ul>
<p>è§£é‡Šå•ä¸ªæ ·æœ¬ï¼šè°ƒç”¨è¯¥ç±»çš„ <code>explain_instance</code> æ–¹æ³•ï¼Œè¿”å› <code>Explanation</code> å¯¹è±¡</p>
<ul>
<li>å¿…è¦å‚æ•° <code>data_row</code>ï¼šå¾…è§£é‡Šçš„æ ·æœ¬ï¼ˆä¸€ç»´ <code>numpy</code>æ•°ç»„ï¼‰ï¼›</li>
<li>å¿…è¦å‚æ•° <code>predict_fn</code>ï¼Œç”¨äºé¢„æµ‹çš„å‡½æ•°ï¼ˆå¯¹åˆ†ç±»ä»»åŠ¡è€Œè¨€ï¼Œè¾“å…¥ <code>numpy</code>æ•°ç»„ï¼Œè¾“å‡ºé¢„æµ‹æ¦‚ç‡å€¼ï¼Œä¾‹å¦‚ <code>sklearn</code>çš„åˆ†ç±»å™¨çš„ <code>predict_proba</code>ï¼‰;</li>
<li><code>num_features</code>è¡¨ç¤ºè§£é‡Šç»“æœä¸­æœ€å¤šèƒ½å‘ˆç°çš„ç‰¹å¾æ•°é‡ï¼›</li>
<li><code>distance_metric</code>é»˜è®¤çš„æ˜¯ euclideanã€‚<br>è¿”å›çš„ Explanation æœ‰</li>
<li><code>as_map</code>æ–¹æ³•ï¼šè¿”å›å­—å…¸ç±»å‹ï¼Œæ ‡ç­¾ -&gt; å…ƒç»„ï¼ˆç‰¹å¾idï¼Œæƒé‡ï¼‰çš„åˆ—è¡¨</li>
<li><code>local_pred</code>å±æ€§ï¼šå­—å…¸ç±»å‹ï¼Œç±»åˆ«æ ‡ç­¾ -&gt; æ¦‚ç‡</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from lime.lime_tabular import LimeTabularExplainer</span><br><span class="line">lime_explainer = LimeTabularExplainer(</span><br><span class="line">    x_train, #è¾“å…¥è®­ç»ƒæ•°æ®</span><br><span class="line">    feature_names=list(data_bs.columns[4:]), #ç‰¹å¾</span><br><span class="line">    mode =&#x27;regression&#x27;, #å¤„ç†ç±»å‹</span><br><span class="line">    class_names=[&#x27;AQI&#x27;] #æ ‡ç­¾)</span><br><span class="line"></span><br><span class="line">exp = lime_explainer.explain_instance(</span><br><span class="line">    data_row=x_test[0], #å¤„ç†æ•°æ®ï¼šé€‰æ‹©ä¸åŒæ•°æ®å¾—åˆ°å›¾ä¸ä¸€æ ·</span><br><span class="line">    predict_fn=mlp.predict #é¢„æµ‹å‡½æ•°)</span><br><span class="line"></span><br><span class="line">#exp.show_in_notebook(show_table=True)</span><br><span class="line">exp.as_pyplot_figure()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<img data-src="https://s2.loli.net/2023/06/07/LPuY56g8dC1otTB.png" alt="202306071525633" style="zoom:60%;">

<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p>1.<a href="https://blog.csdn.net/iqdutao/article/details/1083972">https://blog.csdn.net/iqdutao/article/details/1083972</a></p>
<p>2.<a href="https://doi.org/10.1145/2939672.2939778">https://doi.org/10.1145/2939672.2939778</a></p>
<p>3.<a href="https://www.oreilly.com/content/introduction-to-local-interpretable-model-agnostic-explanations-lime/">https://www.oreilly.com/content/introduction-to-local-interpretable-model-agnostic-explanations-lime/</a></p>
<p>4.<a href="https://e0hyl.github.io/BLOG-OF-E0/LIMEandSHAP/">https://e0hyl.github.io/BLOG-OF-E0/LIMEandSHAP/</a></p>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>æ–‡çŒ®ç¬”è®°</tag>
        <tag>æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§</tag>
      </tags>
  </entry>
  <entry>
    <title>æœºå™¨å­¦ä¹ è¯„ä»·æ ‡å‡†</title>
    <url>/posts/2592384004/</url>
    <content><![CDATA[<p>ä»‹ç»æœºå™¨å­¦ä¹ è¯„ä¼°æ ‡å‡†</p>
<span id="more"></span>
<h1 id="æœºå™¨å­¦ä¹ è¯„ä¼°æŒ‡æ ‡"><a href="#æœºå™¨å­¦ä¹ è¯„ä¼°æŒ‡æ ‡" class="headerlink" title="æœºå™¨å­¦ä¹ è¯„ä¼°æŒ‡æ ‡"></a>æœºå™¨å­¦ä¹ è¯„ä¼°æŒ‡æ ‡</h1><h2 id="ä¸€ã€åˆ†ç±»ç®—æ³•"><a href="#ä¸€ã€åˆ†ç±»ç®—æ³•" class="headerlink" title="ä¸€ã€åˆ†ç±»ç®—æ³•"></a>ä¸€ã€åˆ†ç±»ç®—æ³•</h2><p><strong>æ··æ·†çŸ©é˜µ</strong></p>
<blockquote>
<p>æ··æ·†çŸ©é˜µæ˜¯ç›‘ç£å­¦ä¹ ä¸­çš„ä¸€ç§å¯è§†åŒ–å·¥å…·ï¼Œä¸»è¦ç”¨äºæ¯”è¾ƒåˆ†ç±»ç»“æœå’Œå®ä¾‹çš„çœŸå®ä¿¡æ¯ã€‚çŸ©é˜µä¸­çš„æ¯ä¸€è¡Œä»£è¡¨å®ä¾‹çš„ <strong>é¢„æµ‹ç±»åˆ«</strong> ,æ¯ä¸€åˆ—ä»£è¡¨å®ä¾‹çš„ <strong>çœŸå®ç±»åˆ«</strong> ã€‚</p>
<img data-src="https://s2.loli.net/2023/06/05/uN2gU7d1AbzjX8v.png" alt="202306051339971" style="zoom:60%;">
</blockquote>
<p>æ··æ·†çŸ©é˜µçš„æŒ‡æ ‡</p>
<blockquote>
<p>1ã€TPï¼šå°†æ­£ç±»é¢„æµ‹ä¸ºæ­£ç±»æ•°</p>
<p>2ã€FNï¼šå°†æ­£ç±»é¢„æµ‹ä¸ºè´Ÿç±»æ•°</p>
<p>3ã€FPï¼šå°†è´Ÿç±»é¢„æµ‹ä¸ºæ­£ç±»æ•°</p>
<p>4ã€TNï¼šå°†è´Ÿç±»é¢„æµ‹ä¸ºè´Ÿç±»æ•°</p>
</blockquote>
<h3 id="1ã€ç²¾ç¡®ç‡"><a href="#1ã€ç²¾ç¡®ç‡" class="headerlink" title="1ã€ç²¾ç¡®ç‡"></a>1ã€ç²¾ç¡®ç‡</h3><p>åˆ†ç±»æ­£ç¡®çš„æ­£æ ·æœ¬ä¸ªæ•°å åˆ†ç±»å™¨åˆ¤å®šä¸ºæ­£æ ·æœ¬çš„æ ·æœ¬ä¸ªæ•°çš„æ¯”ä¾‹ï¼ˆé¢„æµ‹åˆ†ç±»ä¸º1ï¼Œç›¸åº”çš„é¢„æµ‹å¯¹çš„æ¦‚ç‡ï¼‰â€”<strong>é”™æŠ¥</strong></p>
<h3 id="2ã€å¬å›ç‡"><a href="#2ã€å¬å›ç‡" class="headerlink" title="2ã€å¬å›ç‡"></a>2ã€å¬å›ç‡</h3><p>åˆ†ç±»æ­£ç¡®çš„æ­£æ ·æœ¬ä¸ªæ•°å çœŸæ­£çš„æ­£æ ·æœ¬ä¸ªæ•°çš„æ¯”ä¾‹ï¼ˆçœŸå®åˆ†ç±»ä¸º1ï¼Œç›¸åº”çš„é¢„æµ‹å¯¹çš„æ¦‚ç‡ï¼‰â€”<strong>æ¼æŠ¥</strong></p>
<blockquote>
<p>æ¯”å¦‚è¯´ï¼šæˆ‘ä»¬è¦ä»ä¸€ä¸ª<strong>ç›’å­</strong>é‡Œé¢æŒ‘é€‰å‡º10ä¸ªçƒï¼Œå…¶ä¸­ç›’å­çƒçš„æ„æˆä¸ºçº¢çƒï¼š95ï¼Œç™½çƒï¼š5ã€‚é‚£ä¹ˆæŠ½åˆ°ç™½çƒçš„å‡†ç¡®ç‡ï¼Œå¬å›ç‡ï¼Ÿ</p>
<p>ç¬¬ä¸€æ¬¡ï¼š10ä¸ªéƒ½æ˜¯çº¢è‰²â€”-é‚£ä¹ˆå‡†ç¡®ç‡ï¼š0 å¬å›ç‡ï¼š0</p>
<p>ç¬¬äºŒæ¬¡ï¼š6ä¸ªçº¢è‰²ï¼Œ4ä¸ªç™½è‰²â€”é‚£ä¹ˆå‡†ç¡®ç‡ï¼š4&#x2F;10 å¬å›ç‡ï¼š4&#x2F;5</p>
</blockquote>
<p><strong>è®¡ç®—å…¬å¼</strong></p>
<p>$$<br>å‡†ç¡®ç‡&#x3D;\frac{æ‰€æœ‰é¢„æµ‹æ­£ç¡®çš„æ ·æœ¬}{æ€»æ ·æœ¬}&#x3D;\frac{TP+TN}{TP+FN+FP+TN}<br>$$</p>
<p>$$<br>å¬å›ç‡&#x3D;\frac{å°†æ­£ç±»é¢„æµ‹ä¸ºæ­£ç±»}{åŸæœ¬æ­£ç±»}&#x3D;\frac{TP}{TP+FN}<br>$$</p>
<p>$$<br>ç²¾ç¡®ç‡&#x3D;\frac{å°†æ­£ç±»é¢„æµ‹ä¸ºæ­£ç±»}{é¢„æµ‹çš„æ­£ç±»}&#x3D;\frac{TP}{TP+FP}<br>$$</p>
<p>å–èˆé—®é¢˜ï¼šåœ¨ä¸åŒçš„åœºåˆå¯¹äº<strong>ç²¾ç¡®ç‡å’Œå¬å›ç‡</strong>è¦æ±‚ä¸åŒã€‚</p>
<p>ä¾‹å¦‚ï¼šå¯¹äºè‚¡ç¥¨é¢„æµ‹ï¼Œæ›´å¤šçš„åº”è¯¥æ˜¯å…³æ³¨ç²¾å‡†ç‡ï¼Œå‡è®¾å…³æ³¨è‚¡ç¥¨ä¸Šå‡çš„æƒ…å†µï¼Œé«˜ç²¾å‡†ç‡æ„å‘³ç€TPå€¼é«˜ï¼ˆæ­£ç¡®åœ°é¢„æµ‹åˆ°è‚¡ç¥¨ä¼šå‡ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥å¸®åŠ©äººä»¬è°ƒæ•´æŠ•èµ„ï¼Œå¢åŠ æ”¶å…¥ï¼Œå¦‚æœè¿™ä¸€æŒ‡æ ‡ä½ï¼Œå°±ä»¥ä¸ºFPå€¼é«˜ï¼ˆé”™è¯¯åœ°è®¤ä¸ºè‚¡ç¥¨ä¼šå‡ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´è‚¡ç¥¨å…¶å®æ˜¯é™çš„ï¼Œè€Œé¢„æµ‹æˆå‡äº†ï¼Œè¿™å°†ä¼šä½¿ç”¨æˆ·äºé’±ã€‚è€Œå¬å›ç‡ä½åªæ˜¯æ„å‘³ç€åœ¨è‚¡ç¥¨ä¸Šå‡çš„æƒ…å†µä¸­ï¼Œå¯¹å‡ ä¸ªè‚¡ç¥¨ä¸Šå‡çš„æƒ…å†µæ²¡æœ‰è¢«é¢„æµ‹åˆ°ï¼Œè¿™å¯¹äºæŠ•èµ„è€…æ¥è¯´ä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„ï¼Œæ¯•ç«Ÿæ²¡æœ‰äºé’±ï¼Œå› æ­¤ä½å¬å›ç‡å¯¹ç”¨æˆ·å½±å“ä¸æ˜¯å¾ˆå¤§ã€‚</p>
<p>ä¾‹å¦‚ï¼šå¯¹äºç–¾ç—…é¢„æµ‹é¢†åŸŸï¼Œæ›´å¤šçš„åº”è¯¥å…³æ³¨å¬å›ç‡ï¼Œå› ä¸ºé«˜å¬å›ç‡æ„å‘³ç€èƒ½å¤Ÿæ›´å¤šåœ°å°†å¾—ç—…çš„ç—…äººé¢„æµ‹å‡ºæ¥ï¼Œè¿™ä¸ªå¯¹äºæ‚£ç—…è€…éå¸¸é‡è¦ã€‚è€Œç²¾å‡†ç‡ä½æ„å‘³ç€é”™è¯¯åœ°é¢„æµ‹ç—…äººæ‚£ç—…ï¼Œè€Œè¿™ä¸ªæ—¶å€™åªè¦è¢«é¢„æµ‹æ‚£ç—…çš„äººå†å»æ£€æŸ¥ä¸€ä¸‹å³å¯ï¼Œå®é™…ä¸Šæ˜¯å¯ä»¥æ¥å—çš„ï¼Œå› æ­¤ä½ç²¾å‡†ç‡å¯¹ç”¨æˆ·å½±å“ä¸å¤§ã€‚</p>
<h3 id="3ã€F1-score"><a href="#3ã€F1-score" class="headerlink" title="3ã€F1-score"></a>3ã€F1-score</h3><p>æ˜¯ä¸€ç§é‡æµ‹ç®—æ³•çš„ç²¾ç¡®åº¦å¸¸ç”¨çš„æŒ‡æ ‡ ï¼Œç»å¸¸ç”¨æ¥åˆ¤æ–­ç®—æ³•çš„ç²¾ç¡®åº¦ã€‚ç›®å‰åœ¨è¾¨è¯†ã€ä¾¦æµ‹ç›¸å…³çš„ç®—æ³•ä¸­ç»å¸¸ä¼šåˆ†åˆ«æåˆ° ç²¾ç¡®ç‡ ï¼ˆprecisionï¼‰å’Œ å¬å›ç‡ ï¼ˆrecallï¼‰ï¼ŒF-scoreèƒ½åŒæ—¶è€ƒè™‘è¿™ä¸¤ä¸ªæ•°å€¼ï¼Œå¹³è¡¡åœ°åæ˜ è¿™ä¸ªç®—æ³•çš„ç²¾ç¡®åº¦ã€‚</p>
<blockquote>
<p>ç»´åŸºç™¾ç§‘ï¼š<a href="https://zh.wikipedia.org/wiki/F-score">https://zh.wikipedia.org/wiki/F-score</a></p>
</blockquote>
<p><strong>è®¡ç®—å…¬å¼ï¼š</strong></p>
<p>$$<br>F_1&#x3D;\frac{2TP}{2TP+FN+FP}<br>$$</p>
<p>è®¾æƒ³ä¸€ä¸‹ä¸€ä¸ªæ¯”è¾ƒæç«¯çš„æƒ…å†µï¼Œå¦‚æ­£æ ·æœ¬90ä¸ªï¼Œè´Ÿæ ·æœ¬10ä¸ªï¼Œæˆ‘ä»¬ç›´æ¥å°†æ‰€æœ‰æ ·æœ¬åˆ†ç±»ä¸ºæ­£æ ·æœ¬ï¼Œå¾—åˆ°å‡†ç¡®ç‡ä¸º90%ã€‚å•ä»æ•°å€¼ä¸Šè€Œè¨€ç»“æœæ˜¯å¯ä»¥æ¥å—çš„ï¼Œä½†æ˜¯è¿™æ ·å°±è¿èƒŒäº†æˆ‘ä»¬è¿›è¡Œåˆ†ç±»çš„åˆè¡·ï¼Œåº”è¯¥èµ›é€‰å‡ºæ­£æ ·æœ¬çš„åŒæ—¶ï¼Œå°½å¯èƒ½å°‘çš„è®©è´Ÿæ ·æœ¬è¿›å…¥ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¼•å…¥TPRã€FPRã€TNRå¯¹å…¶è¿›è¡Œé™åˆ¶</p>
<h3 id="4ã€ROCæ›²çº¿å’ŒAUCå€¼"><a href="#4ã€ROCæ›²çº¿å’ŒAUCå€¼" class="headerlink" title="4ã€ROCæ›²çº¿å’ŒAUCå€¼"></a>4ã€ROCæ›²çº¿å’ŒAUCå€¼</h3><h4 id="4-1-TPRã€FPRã€TNR"><a href="#4-1-TPRã€FPRã€TNR" class="headerlink" title="4.1 TPRã€FPRã€TNR"></a>4.1 TPRã€FPRã€TNR</h4><p><strong>çœŸæ­£ç±»ç‡</strong>ï¼Œåˆ»ç”»çš„æ˜¯è¢«åˆ†ç±»å™¨æ­£ç¡®åˆ†ç±»çš„æ­£å®ä¾‹å æ‰€æœ‰æ­£å®ä¾‹çš„æ¯”ä¾‹ã€‚<strong>å³ï¼šæ­£ç¡®åˆ¤æ–­ä¸ºæ­£çš„å å…¨éƒ¨æ­£çš„æ¯”ä¾‹</strong></p>
<p>$$<br>TPR&#x3D;\frac{TP}{TP+FN}<br>$$</p>
<p><strong>è´Ÿæ­£ç±»ç‡</strong>ï¼Œè®¡ç®—çš„æ˜¯è¢«åˆ†ç±»å™¨é”™è®¤ä¸ºæ­£ç±»çš„è´Ÿå®ä¾‹å æ‰€æœ‰è´Ÿå®ä¾‹çš„æ¯”ä¾‹ã€‚<strong>å³ï¼šå°†è´Ÿé”™è¯¯åˆ¤æ–­ä¸ºæ­£çš„å å…¨éƒ¨è´Ÿçš„æ¯”ä¾‹</strong></p>
<p>$$<br>FPR&#x3D;\frac{FP}{FP+TN}<br>$$</p>
<p><strong>çœŸè´Ÿç±»ç‡</strong>ï¼Œåˆ»ç”»çš„æ˜¯è¢«åˆ†ç±»å™¨æ­£ç¡®åˆ†ç±»çš„è´Ÿå®ä¾‹å æ‰€æœ‰è´Ÿå®ä¾‹çš„æ¯”ä¾‹ã€‚<strong>å³ï¼šæ­£ç¡®åˆ†ç±»ä¸ºè´Ÿå å…¨éƒ¨è´Ÿçš„æ¯”ä¾‹</strong></p>
<p>$$<br>TNR&#x3D;1-FPR&#x3D;\frac{TN}{FP+TN}<br>$$</p>
<p>é‚£ä¹ˆé€šè¿‡åˆ†æå®¹æ˜“çŸ¥é“ï¼Œæˆ‘ä»¬å¸Œæœ›TPRçš„å€¼è¶Šå¤§è¶Šå¥½ï¼Œç›¸åFPRçš„å€¼è¶Šå°è¶Šå¥½ã€‚çŸ¥é“3ä¸ªæŒ‡æ ‡ä¹‹åæˆ‘ä»¬å¼€å§‹äº†è§£ä»€ä¹ˆæ˜¯ROCæ›²çº¿ï¼Œè®¾æƒ³åœ¨ä¸€ä¸ªåˆ†ç±»é—®é¢˜ï¼ˆæ¯”å¦‚æ‰‹å†™å­—ä½“è¯†åˆ«ï¼‰ä¸­æˆ‘ä»¬å¯èƒ½å¾ˆéš¾100%çš„åˆ¤æ–­å°±ä¸€å®šå±äºæŸä¸ªæ•°å€¼ï¼Œä½†æ˜¯è¦æ˜¯ç»™å®šå±äºæŸä¸ªæ•°å­—çš„æ¦‚ç‡ï¼Œæ¯”å¦‚è¯´å±äº1çš„æ¦‚ç‡ä¸º95%ï¼Œ2çš„æ¦‚ç‡ä¸º90%â€¦â€¦é‚£ä¹ˆæˆ‘ä»¬å¾ˆå¯èƒ½åšå‡ºåˆ¤æ–­è¿™ä¸ªæ‰‹å†™å­—å°±æ˜¯1ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºä»–çš„æ¦‚ç‡å¤§ï¼Ÿä½†æ˜¯æ•°å­—2çš„æ¦‚ç‡ä¹Ÿæœ‰90%ä¸ºä»€ä¹ˆä¸é€‰æ‹©æ•°å­—2å‘¢ï¼Ÿåœ¨å®é™…ç”Ÿæ´»ä¸­è¿™ç§æƒ…å†µç»å¸¸æœ‰ï¼Œæˆ‘ä»¬å¾ˆéš¾100%åˆ¤æ–­æŸä¸ªæ•°å­—ä½†æ˜¯æˆ‘ä»¬å¯ä»¥è§„å®šï¼Œæ¯”å¦‚è¯´ï¼šæ¦‚ç‡å¤§äº90%é‚£ä¹ˆå°±è®¤ä¸ºæ˜¯1ï¼Œåä¹‹è®°ä½œ0è¿™æ ·çš„è¯ä¸Šé¢çš„ä¾‹å­å°±è§£é‡Šå¾—é€šäº†ã€‚è¿™ä¸ª90%å¸¸å¸¸è®°ä½œ<strong>é˜ˆå€¼</strong>ï¼Œé‚£ä¹ˆä¸åŒé˜ˆå€¼å’Œæˆ‘ä»¬ROCæ›²çº¿åˆæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿä¸å¦¨é€šè¿‡ä¸‹é¢è¿™ä¸ªä¾‹å­è¿›è¡Œäº†è§£ï¼š</p>
<blockquote>
<p>åˆ†ç±»é—®é¢˜ï¼šåˆ¤æ–­æ˜¯ä¸æ˜¯ğŸš²ï¼Ÿ</p>
<table>
<thead>
<tr>
<th align="center">åºå·</th>
<th>ç±»åˆ«</th>
<th>æ¦‚ç‡</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td>ğŸš³</td>
<td>0.3</td>
</tr>
<tr>
<td align="center">2</td>
<td>ğŸš²</td>
<td>0.3</td>
</tr>
<tr>
<td align="center">3</td>
<td>ğŸš²</td>
<td>0.6</td>
</tr>
<tr>
<td align="center">4</td>
<td>ğŸš²</td>
<td>0.8</td>
</tr>
<tr>
<td align="center">5</td>
<td>ğŸš²</td>
<td>0.9</td>
</tr>
<tr>
<td align="center">6</td>
<td>ğŸš³</td>
<td>0.1</td>
</tr>
<tr>
<td align="center">7</td>
<td>ğŸš³</td>
<td>0.2</td>
</tr>
<tr>
<td align="center">8</td>
<td>ğŸš³</td>
<td>0.3</td>
</tr>
</tbody></table>
<p>é‚£ä¹ˆå¯ä»¥å‡è®¾ä¸åŒ<strong>é˜ˆå€¼</strong>ï¼Œè¿›è€Œè®¡ç®—ä¸åŒTPRå’ŒFPRçš„å€¼ã€‚æ¯”å¦‚è¯´:</p>
<p>é˜ˆå€¼å–[0,0.1]çš„æ—¶å€™ï¼Œå‘ç°æ¦‚ç‡éƒ½å¤§äº0.1é‚£ä¹ˆæˆ‘ä»¬è®¤ä¸ºå…¨éƒ¨éƒ½æ˜¯ğŸš²ï¼Œæ‰€ä»¥å°±æœ‰</p>
</blockquote>
<blockquote>
<p>$$<br>TPR&#x3D;\frac{TP}{TP+FN}&#x3D;\frac{4}{4+0}<br>$$</p>
<p>$$<br>FPR&#x3D;\frac{FP}{FP+TN}&#x3D;\frac{4}{4+0}<br>$$</p>
<p>è¿™æ ·çš„è¯æˆ‘ä»¬å°±å¯ä»¥åœ¨ROCæ›²çº¿ä¸Šæ ‡è®°ä¸€ä¸ªç‚¹ï¼Œé€šè¿‡ä¸æ–­çš„ç§»åŠ¨é˜ˆå€¼æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªROCæ›²çº¿<br>å› æ­¤æˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š</p>
<img data-src="https://s2.loli.net/2023/06/04/SfBCdjHLeuXponv.png" alt="202306041906707" style="zoom:60%;">
</blockquote>
<p>è¿™æ ·çš„è¯æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€æ¡ROCæ›²çº¿ï¼Œä½†æ˜¯é—®é¢˜æœ‰æ¥äº†è¦æ˜¯æˆ‘ä»¬å¾—åˆ°å¦å¤–ä¸€æ¡ROCæ›²çº¿ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ç°åœ¨æœ‰ä¸¤æ¡ROCæ›²çº¿ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåˆ¤æ–­å‘¢ï¼Ÿè¿™å°±æ˜¯æ¥ä¸‹æ¥è¦è¯´çš„AUCå€¼ï¼Œé—®é¢˜åˆæ¥äº†æ€ä¹ˆçŸ¥é“AUCçš„å€¼å‘¢ï¼Ÿâ€”â€“&gt;è®¡ç®—é¢ç§¯é˜¿ä¼Ÿã€‚æ²¡é”™å°±æ˜¯è®¡ç®—é¢ç§¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—ä¸åŒROCæ›²çº¿ä¸FPRçš„é¢ç§¯è¿›è€Œå¾—åˆ°ä¸åŒAUCçš„å€¼ï¼Œä»è€Œåˆ¤æ–­å“ªæ¡ROCæ›²çº¿æ›´åŠ çš„å¥½ï¼</p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ä¸Šè¿°åˆ†æéƒ½æ˜¯é’ˆå¯¹äºŒåˆ†ç±»é—®é¢˜ï¼Œå®é™…ç”Ÿæ´»ä¸­å¹¶æ²¡æœ‰é‚£ä¹ˆå¤šéé»‘å³ç™½çš„äº‹æƒ…ï¼Œæ›´å¤šçš„æ˜¯<strong>å¤šåˆ†ç±»çš„é—®é¢˜</strong>ï¼Œä»€ä¹ˆæ˜¯å¤šåˆ†ç±»ï¼Ÿç»´åŸºç™¾ç§‘ç»™å‡ºçš„å®šä¹‰ï¼šå¤šå…ƒåˆ†ç±»æ˜¯å°†å®ä¾‹åˆ†é…åˆ°å¤šä¸ªï¼ˆå¤šäºä¸¤ä¸ªï¼‰ç±»åˆ«ä¸­çš„å…¶ä¸­ä¸€ä¸ªï¼ˆå°†å®ä¾‹åˆ†é…åˆ°ä¸¤ä¸ªç±»åˆ«ä¸­çš„å…¶ä¸­ä¸€ä¸ªè¢«ç§°ä¸ºäºŒåˆ†ç±»ï¼‰ã€‚æ˜¾ç„¶ï¼Œåˆ†ç±»ç®—æ³•å¯ä»¥åˆ†ä¸ºäºŒåˆ†ç±»å’Œå¤šåˆ†ç±»ä¸¤ç§ï¼Œè€Œå¤šåˆ†ç±»ç®—æ³•å¯ä»¥é€šè¿‡å°†å…¶è½¬åŒ–ä¸ºå¤šä¸ªäºŒåˆ†ç±»æ¥å®ç°ã€‚ç®€å•ä»å­—é¢ç†è§£å¾ˆå®¹æ˜“ï¼Œæ¯”å¦‚è¯´ç»™å‡ºå¤§é‡çš„äº¤é€šå›¾ç‰‡ï¼Œäº¤ç»™è®¡ç®—æœºå»å°†è¿™äº›å›¾ç‰‡è¿›è¡Œåˆ†ç±»ï¼Œåˆ’åˆ†ä»€ä¹ˆæ˜¯ğŸš—ğŸš†âœˆç­‰ç­‰ï¼Œé‚£ä¹ˆå¯¹äºå¤šåˆ†ç±»é—®é¢˜å…¶è¯„ä»·æŒ‡æ ‡å¦‚ä½•ï¼Ÿä¸Šè¿°åˆ†ææ–¹æ³•æ˜¯å¦ä¾æ—§è¡Œå¾—é€šï¼Ÿå¯¹äºå¤šå…ƒåˆ†ç±»æˆ‘ä»¬å¯ä»¥å°†å¤šåˆ†ç±»åŒ–æˆäºŒåˆ†ç±»é—®é¢˜ï¼Œæ¯”å¦‚è¯´ä¸‹å›¾ï¼š</p>
<img data-src="https://s2.loli.net/2023/06/04/IvMa1ZB8m39gJ4R.png" alt="202306041907421" style="zoom:100%;">

<h2 id="äºŒã€å›å½’ç®—æ³•è¯„ä»·æŒ‡æ ‡"><a href="#äºŒã€å›å½’ç®—æ³•è¯„ä»·æŒ‡æ ‡" class="headerlink" title="äºŒã€å›å½’ç®—æ³•è¯„ä»·æŒ‡æ ‡"></a>äºŒã€å›å½’ç®—æ³•è¯„ä»·æŒ‡æ ‡</h2><h3 id="1ã€RMSEå‡æ–¹æ ¹è¯¯å·®"><a href="#1ã€RMSEå‡æ–¹æ ¹è¯¯å·®" class="headerlink" title="1ã€RMSEå‡æ–¹æ ¹è¯¯å·®"></a>1ã€RMSEå‡æ–¹æ ¹è¯¯å·®</h3><p>$$<br>RMSE(X,h)&#x3D;\sqrt[2]{\frac{1}{m}\displaystyle\sum^{m}_{i&#x3D;1}(h(x_i)-y_i)^2}<br>$$</p>
<h3 id="2ã€MSEå‡æ–¹è¯¯å·®"><a href="#2ã€MSEå‡æ–¹è¯¯å·®" class="headerlink" title="2ã€MSEå‡æ–¹è¯¯å·®"></a>2ã€MSEå‡æ–¹è¯¯å·®</h3><p>$$<br>MSE(X,h)&#x3D;\frac{1}{m}\displaystyle\sum^{m}_{i&#x3D;1}(h(x_i)-y_i)^2<br>$$</p>
<h3 id="3ã€MAEå¹³å‡ç»å¯¹è¯¯å·®"><a href="#3ã€MAEå¹³å‡ç»å¯¹è¯¯å·®" class="headerlink" title="3ã€MAEå¹³å‡ç»å¯¹è¯¯å·®"></a>3ã€MAEå¹³å‡ç»å¯¹è¯¯å·®</h3><p>$$<br>MAE(X,h)&#x3D;\frac{1}{m}\displaystyle\sum^{m}_{i&#x3D;1}(|h(x_i|)-y_i|<br>$$</p>
<h3 id="4ã€R-squared"><a href="#4ã€R-squared" class="headerlink" title="4ã€R-squared"></a>4ã€R-squared</h3><p>R Squaredåˆå«å¯å†³ç³»æ•°(coefficient of determination)ä¹Ÿå«æ‹Ÿåˆä¼˜åº¦,åæ˜ çš„æ˜¯è‡ªå˜é‡xå¯¹å› å˜é‡yçš„å˜åŠ¨çš„è§£é‡Šçš„ç¨‹åº¦.è¶Šæ¥è¿‘äº1,è¯´æ˜æ¨¡å‹æ‹Ÿåˆå¾—è¶Šå¥½ã€‚å¯ä»¥è¿™ä¹ˆç†è§£ï¼šå°†TSSç†è§£ä¸ºå…¨éƒ¨æŒ‰å¹³å‡å€¼é¢„æµ‹ï¼ŒRSSç†è§£ä¸ºæŒ‰æ¨¡å‹é¢„æµ‹ï¼Œè¿™å°±ç›¸å½“äºå»æ¯”è¾ƒä½ æ¨¡å‹é¢„æµ‹å’Œå…¨éƒ¨æŒ‰å¹³å‡å€¼é¢„æµ‹çš„æ¯”ä¾‹ï¼Œè¿™ä¸ªæ¯”ä¾‹è¶Šå°ï¼Œåˆ™æ¨¡å‹è¶Šç²¾ç¡®ã€‚å½“ç„¶è¯¥æŒ‡æ ‡å­˜åœ¨è´Ÿæ•°çš„æƒ…å†µï¼Œå³æ¨¡å‹é¢„æµ‹è¿˜ä¸å¦‚å…¨éƒ¨æŒ‰å¹³å‡å€¼é¢„æµ‹<br>ç¼ºç‚¹ï¼šå½“æ•°æ®åˆ†å¸ƒæ–¹å·®æ¯”è¾ƒå¤§æ—¶ï¼Œé¢„æµ‹ä¸å‡†æ—¶ï¼ŒR^2ä¾ç„¶æ¯”è¾ƒå¤§ï¼Œæ­¤æ—¶æ”¹è¯„ä»·æŒ‡æ ‡å°±ä¸å¤ªå¥½</p>
<p>$$<br>R^2&#x3D;(y,\tilde{y})&#x3D;1-\frac{\displaystyle\sum_{i&#x3D;0}^{n}({y_i-\tilde{y_i}})^2}{\displaystyle\sum_{i&#x3D;0}^{n}({y_i-\tilde{y_i}})^2}&#x3D;\frac{ESS}{TSS}&#x3D;1-\frac{RSS}{TSS}<br>$$</p>
<p><strong>å‚è€ƒ</strong></p>
<blockquote>
<p><a href="https://blog.csdn.net/manduner/article/details/91040867">https://blog.csdn.net/manduner/article/details/91040867</a></p>
<p><a href="https://www.jianshu.com/p/2ca96fce7e81">https://www.jianshu.com/p/2ca96fce7e81</a></p>
<p><a href="https://www.bilibili.com/video/BV1wz4y197LU/?spm_id_from=333.337.search-card.all.click&vd_source=881c4826193cfb648b5cdd0bad9f19f0">ã€å°èŒäº”åˆ†é’Ÿã€‘æœºå™¨å­¦ä¹  | æ¨¡å‹è¯„ä¼°: ROCæ›²çº¿ä¸AUCå€¼_å“”å“©å“”å“©_bilibili</a><br><a href="https://blog.csdn.net/weixin_44441131/article/details/109037673">https://blog.csdn.net/weixin_44441131/article/details/109037673</a></p>
<p><a href="https://www.jianshu.com/p/e74eb43960a1">https://www.jianshu.com/p/e74eb43960a1</a></p>
</blockquote>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>è¯„ä»·æ ‡å‡†</tag>
      </tags>
  </entry>
  <entry>
    <title>æ·±åº¦å­¦ä¹ ä¼˜åŒ–--æ­£åˆ™åŒ–å’Œä¼˜åŒ–ç®—æ³•</title>
    <url>/posts/b8446bf4/</url>
    <content><![CDATA[<p>æœ¬æ–‡å…³äºæ·±åº¦å­¦ä¹ æ¨¡å‹ä¼˜åŒ–ä¸»è¦å›´ç»•ä¸‹é¢ä¸¤ä¸ªæ–¹é¢å±•å¼€ï¼š</p>
<p>1ã€ä¼˜åŒ–é—®é¢˜ï¼šæ·±åº¦ç¥ç»ç½‘ç»œçš„ä¼˜åŒ–ååˆ†å›°éš¾ã€‚é›†ä¸­åœ¨ä¸‹é¢ä¸‰ä¸ªåŸå› ï¼š1ã€ç¥ç»ç½‘ç»œçš„æŸå¤±å‡½æ•°æ˜¯ä¸€ä¸ªéå‡¸å‡½æ•°ï¼Œæ‰¾åˆ°å…¨å±€æœ€ä¼˜è§£é€šå¸¸æ¯”è¾ƒå›°éš¾ã€‚2ã€æ·±åº¦ç¥ç»ç½‘ç»œçš„å‚æ•°å¤šï¼Œè®­ç»ƒæ•°æ®å¤§ã€‚3ã€æ·±åº¦ç¥ç»ç½‘ç»œå­˜åœ¨æ¢¯åº¦æ¶ˆå¤±æˆ–çˆ†ç‚¸é—®é¢˜ï¼Œå¯¼è‡´åŸºäºæ¢¯åº¦çš„ä¼˜åŒ–æ–¹æ³•ç»å¸¸å¤±æ•ˆã€‚ </p>
<p>2ã€æ³›åŒ–é—®é¢˜ï¼šç”±äºæ·±åº¦ç¥ç»ç½‘ç»œçš„å¤æ‚åº¦æ¯”è¾ƒé«˜ï¼Œå¹¶ä¸”æ‹Ÿåˆèƒ½åŠ›å¾ˆå¼ºï¼Œå¾ˆå®¹æ˜“åœ¨è®­ç»ƒé›†ä¸Šäº§ç”Ÿè¿‡æ‹Ÿåˆã€‚å› æ­¤åœ¨è®­ç»ƒæ·±åº¦ç¥ç»ç½‘ç»œæ—¶ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦é€šè¿‡ä¸€å®š çš„æ­£åˆ™åŒ–æ–¹æ³•æ¥æ”¹è¿›ç½‘ç»œçš„æ³›åŒ–èƒ½åŠ›ã€‚</p>
<p>æ‰€æœ‰ä»£ç éƒ½æ˜¯åŸºäºpytorch</p>
<span id="more"></span>

<p>[TOC]</p>
<h1 id="ä¸€ã€ä¼˜åŒ–ç®—æ³•"><a href="#ä¸€ã€ä¼˜åŒ–ç®—æ³•" class="headerlink" title="ä¸€ã€ä¼˜åŒ–ç®—æ³•"></a>ä¸€ã€ä¼˜åŒ–ç®—æ³•</h1><h2 id="1-1-é—®é¢˜æå‡º"><a href="#1-1-é—®é¢˜æå‡º" class="headerlink" title="1.1 é—®é¢˜æå‡º"></a>1.1 é—®é¢˜æå‡º</h2><p>æˆ‘ä»¬å¸¸ä½¿ç”¨çš„<strong>éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•ï¼ˆstochastic gradient descentï¼ŒSGDï¼‰</strong>åŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç›´è§‚ä¸Šç†è§£å°±æ˜¯ï¼šå±±å¡æ»šçƒï¼Œçƒä»¥æœ€å¿«é€Ÿåº¦æ‰åˆ°å±±è„šã€‚ä½†æ˜¯æœ‰æ²¡æœ‰è¿™ç§å¯èƒ½ï¼šçƒæ‰äº†ä¸€ä¸ªâ€œå‘é“ï¼ˆå±€éƒ¨æœ€ä½ï¼‰â€ã€‚åœ¨æ•°å­¦ä¸Šå¯¹â€œå‘é“â€çš„å®šä¹‰ä¸º<strong>éç‚¹</strong>å³åœ¨æ­¤ç‚¹æ¢¯åº¦ä¸º0ã€‚å›é¡¾æ¢¯åº¦ä¸‹é™å…¬å¼ï¼š<br>$$<br>\widehat \theta&#x3D;\theta-\alpha \frac{\partial J(\theta)}{\partial \theta}<br>$$<br>å…¶ä¸­$J(\theta)$ä¸ºæŸå¤±å‡½æ•°ï¼›$\alpha$ä¸ºå­¦ä¹ ç‡ï¼›$\theta$ä¸ºä¼˜åŒ–å‚æ•°ã€‚éç‚¹å¤„æ¢¯åº¦ä¸º0é‚£ä¹ˆä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬éœ€è¦è°ƒæ•´çš„å‚æ•°$\theta $å°†ä¼šä¸€ç›´è¢«å›°åœ¨â€œåŸåœ°â€æ— æ³•è¿›è¡Œæ›´æ–°ã€‚éç‚¹ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p>
<p>ä»ä¸Šå›¾å¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬é€šè¿‡éšæœºæ¢¯åº¦ä¸‹é™åªæ˜¯åˆ°è¾¾å‡½æ•°çš„<strong>å±€éƒ¨æœ€ä¼˜</strong></p>
<h2 id="2ã€ä¼˜åŒ–ç®—æ³•æå‡º"><a href="#2ã€ä¼˜åŒ–ç®—æ³•æå‡º" class="headerlink" title="2ã€ä¼˜åŒ–ç®—æ³•æå‡º"></a>2ã€ä¼˜åŒ–ç®—æ³•æå‡º</h2><h3 id="2-1-æ¢¯åº¦ä¸‹é™ç®—æ³•"><a href="#2-1-æ¢¯åº¦ä¸‹é™ç®—æ³•" class="headerlink" title="2.1 æ¢¯åº¦ä¸‹é™ç®—æ³•"></a>2.1 æ¢¯åº¦ä¸‹é™ç®—æ³•</h3><p>åœ¨æˆ‘ä»¬å¹³æ—¶ç¼–ç¨‹è¿‡ç¨‹ä¸­ç»å¸¸æ‰€ä½¿ç”¨çš„æ˜¯éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œä½†æ˜¯ä¸€èˆ¬çš„æ¢¯åº¦ä¸‹é™ç®—æ³•åˆ†ä¸ºä¸‰ç±»ï¼š1ã€æ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼›2ã€éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•ï¼›3ã€å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•ã€‚</p>
<p><strong>1ã€éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•</strong></p>
<p>é¦–å…ˆSGDç®—æ³•è¿ç®—æµç¨‹å¦‚ä¸‹ï¼š</p>
<img data-src="https://s2.loli.net/2023/05/29/oa2PnzsWRwXNif7.png" alt="image-20230529201451914.png" style="zoom:67%;">

<p><strong>2ã€å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•</strong></p>
<p>åœ¨è®­ç»ƒæ·±åº¦ç¥ç»ç½‘ç»œæ—¶ï¼Œé¢å¯¹è¾ƒå¤§è§„æ¨¡çš„æ•°æ®é›†å¦‚æœç›´æ¥å¯¹æ•´ä¸ªè®­ç»ƒé›†çš„æ¢¯åº¦è¿›è¡Œè®¡ç®—ï¼Œæ˜¾ç„¶è¿™æ˜¯ä¸åˆé€‚çš„å¯¹èµ„æºçš„æ¶ˆè€—å¤ªå¤§ã€è®¡ç®—ä¹Ÿååˆ†å†—ä½™ã€‚å› æ­¤ï¼Œåœ¨è®­ç»ƒæ·±åº¦ç¥ç»ç½‘ç»œæ—¶ï¼Œç»å¸¸ä½¿ç”¨<strong>å°æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•ï¼ˆMini-Batch Gradient Descentï¼‰</strong></p>
<img data-src="https://s2.loli.net/2023/05/29/m8y7ueMvD4BdZR5.png" alt="image-20230529195427115.png" style="zoom:67%;">

<p>é€šè¿‡å¯¹æ¢¯åº¦ä¸‹é™ç®—æ³•è§‚å¯Ÿå‘ç°å­˜åœ¨ä¸¤ä¸ªå‚æ•°å¯ä»¥è¿›è¡Œä¼˜åŒ–ï¼š1ã€å­¦ä¹ ç‡$\alpha $</p>
<h2 id="2-2-å­¦ä¹ ç‡è°ƒæ•´"><a href="#2-2-å­¦ä¹ ç‡è°ƒæ•´" class="headerlink" title="2.2 å­¦ä¹ ç‡è°ƒæ•´"></a>2.2 å­¦ä¹ ç‡è°ƒæ•´</h2><h3 id="2-2-1-AdaGradç®—æ³•"><a href="#2-2-1-AdaGradç®—æ³•" class="headerlink" title="2.2.1 AdaGradç®—æ³•"></a>2.2.1 AdaGradç®—æ³•</h3><h3 id="2-2-2-RMSpropç®—æ³•"><a href="#2-2-2-RMSpropç®—æ³•" class="headerlink" title="2.2.2 RMSpropç®—æ³•"></a>2.2.2 RMSpropç®—æ³•</h3><h3 id="2-2-3-Adamç®—æ³•"><a href="#2-2-3-Adamç®—æ³•" class="headerlink" title="2.2.3 Adamç®—æ³•"></a>2.2.3 Adamç®—æ³•</h3><h1 id="nã€å‚è€ƒæ–‡çŒ®"><a href="#nã€å‚è€ƒæ–‡çŒ®" class="headerlink" title="nã€å‚è€ƒæ–‡çŒ®"></a>nã€å‚è€ƒæ–‡çŒ®</h1><p>1ã€<a href="https://www.deeplearningbook.org/">https://www.deeplearningbook.org/</a></p>
]]></content>
      <categories>
        <category>æ–‡çŒ®ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ·±åº¦å­¦ä¹ </tag>
        <tag>å›¾åƒè¯†åˆ«</tag>
      </tags>
  </entry>
  <entry>
    <title>è´å¶æ–¯åˆ†ç±»å™¨</title>
    <url>/posts/2045861030/</url>
    <content><![CDATA[<h1 id="æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨"><a href="#æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨" class="headerlink" title="æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨"></a>æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨</h1><span id="more"></span>

<h2 id="æ•°å­¦ç†è®º"><a href="#æ•°å­¦ç†è®º" class="headerlink" title="æ•°å­¦ç†è®º"></a>æ•°å­¦ç†è®º</h2><ul>
<li><strong>å…ˆéªŒæ¦‚ç‡</strong></li>
</ul>
<p>æ ¹æ®ä»¥å¾€ç»éªŒå’Œåˆ†æå¾—åˆ°çš„æ¦‚ç‡</p>
<ul>
<li><strong>æ¡ä»¶æ¦‚ç‡ï¼ˆåéªŒæ¦‚ç‡ï¼‰</strong></li>
</ul>
<p>åœ¨äº‹ä»¶Bå‘ç”Ÿçš„æ¡ä»¶ä¸‹Aåœ¨å‘ç”Ÿçš„æ¦‚ç‡</p>
<p>$$<br>P(A|B)&#x3D;\frac{P(AB)}{p(A)}<br>$$</p>
<ul>
<li><strong>æœ´ç´ è´å¶æ–¯å®šç†</strong><br>ç›´è§‚ç†è§£ï¼šæˆ‘ä»¬å‡è®¾Bæ˜¯æˆ‘ä»¬çš„ç‰¹å¾æ ‡ç­¾Aæ˜¯æˆ‘ä»¬çš„åˆ†ç±»æ ‡ç­¾ã€‚é‚£ä¹ˆå…¬å¼ç›´è§‚ä¸Šçš„ç†è§£å°±æ˜¯ï¼šæˆ‘ä»¬åœ¨å…·æœ‰Bè¿™ä¹ˆå¤šçš„ç‰¹å¾ä¹‹åä¸€ä¸ªæ ·æœ¬å±äºAçš„æ¦‚ç‡æœ‰å¤šå¤§</li>
</ul>
<p>$$<br>P(A|B)&#x3D;\frac{P(B_1|A)P(B_2|A)P(B_3|A)â€¦P(B_n|A)P(A)}{P(B)}\\text{å…¬å¼ä¸­}P(B_i|A)\text{ä»£è¡¨åœ¨è®­ç»ƒé›†ä¸­}B_iç‰¹å¾ä¸‹å±äºAçš„æ¦‚ç‡<br>$$</p>
<blockquote>
<p>æ­¤æ—¶é—®é¢˜æ¥äº†ï¼šå¦‚æœæˆ‘ä»¬çš„ç‰¹å¾æ˜¯éæ•°å­—æ•°æ®æ¯”å¦‚è¯´ï¼šç»¿è‰²ã€è“è‰²ç­‰é‚£ä¹ˆæˆ‘ä»¬å¾ˆå®¹æ˜“å°±å¯ä»¥è®¡ç®—å¾—åˆ°æ¦‚ç‡çš„è®¡ç®—ï¼Œä½†æ˜¯å¦‚æœæ˜¯å…·ä½“æ•°å­—å‘¢ï¼Ÿé‚£ä¹ˆåº”è¯¥æ€ä¹ˆè®¡ç®—å‘¢ï¼Ÿ</p>
</blockquote>
<ul>
<li><strong>é«˜æ–¯æœ´ç´ è´å¶æ–¯</strong></li>
</ul>
<blockquote>
<p>é«˜æ–¯åˆ†å¸ƒï¼šæ­£æ€åˆ†å¸ƒ</p>
</blockquote>
<p>$$<br>P(A|B)&#x3D;\frac{1}{\sqrt{2\pi\sigma_{B}^{2}}}e^{-\frac{(A-\mu)^2}{2\sigma_{B}^{2}}}\\mu:å‡å€¼ \sigma:æ–¹å·®<br>$$</p>
<blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/38361524">æ­£æ€åˆ†å¸ƒåˆ¤åˆ«</a></p>
</blockquote>
<h2 id="æœ´ç´ è´å¶æ–¯"><a href="#æœ´ç´ è´å¶æ–¯" class="headerlink" title="æœ´ç´ è´å¶æ–¯"></a>æœ´ç´ è´å¶æ–¯</h2><p>æˆ‘ä»¬å…ˆçœ‹å…³äºä»–çš„è§£é‡Šï¼šæœ´ç´ è´å¶æ–¯æ˜¯ä¸€ç§å»ºåˆ†ç±»å™¨çš„ç®€å•æ–¹æ³•ã€‚è¯¥åˆ†ç±»å™¨æ¨¡å‹ä¼šç»™é—®é¢˜å®ä¾‹åˆ†é…ç”¨ç‰¹å¾å€¼è¡¨ç¤ºçš„ç±»æ ‡ç­¾ï¼Œç±»æ ‡ç­¾å–è‡ªæœ‰é™é›†åˆã€‚å®ƒä¸æ˜¯è®­ç»ƒè¿™ç§åˆ†ç±»å™¨çš„å•ä¸€ç®—æ³•ï¼Œè€Œæ˜¯ä¸€ç³»åˆ—åŸºäºç›¸åŒåŸç†çš„ç®—æ³•ï¼šæ‰€æœ‰æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨éƒ½å‡å®šæ ·æœ¬æ¯ä¸ªç‰¹å¾ä¸å…¶ä»–ç‰¹å¾éƒ½ä¸ç›¸å…³ã€‚</p>
<blockquote>
<p><a href="https://zh.wikipedia.org/wiki/%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%88%86%E7%B1%BB%E5%99%A8">https://zh.wikipedia.org/wiki/%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%88%86%E7%B1%BB%E5%99%A8</a></p>
</blockquote>
<p>ä»å®šä¹‰ä¸Šçœ‹èµ·æ¥è§‰å¾—å¾ˆéº»çƒ¦ï¼Œå…¶å®æœ´ç´ è´å¶æ–¯ç®—æ³•çš„åŸç†ååˆ†ç®€å•ã€‚æˆ‘ä»¬ä»¥å¦‚ä¸‹ä¾‹å­ä¸ºä¾‹ï¼š</p>
<blockquote>
<p>å‡è®¾è®­ç»ƒé›†å¦‚ä¸‹</p>
<table>
<thead>
<tr>
<th>æ€§åˆ«</th>
<th>èº«é«˜ï¼ˆè‹±å°ºï¼‰</th>
<th>ä½“é‡ï¼ˆç£…ï¼‰</th>
<th>è„šçš„å°ºå¯¸ï¼ˆè‹±å¯¸ï¼‰</th>
</tr>
</thead>
<tbody><tr>
<td>ç”·</td>
<td>6</td>
<td>180</td>
<td>12</td>
</tr>
<tr>
<td>ç”·</td>
<td>5.92 (5â€™11â€)</td>
<td>190</td>
<td>11</td>
</tr>
<tr>
<td>ç”·</td>
<td>5.58 (5â€™7â€)</td>
<td>170</td>
<td>12</td>
</tr>
<tr>
<td>ç”·</td>
<td>5.92 (5â€™11â€)</td>
<td>165</td>
<td>10</td>
</tr>
<tr>
<td>å¥³</td>
<td>5</td>
<td>100</td>
<td>6</td>
</tr>
<tr>
<td>å¥³</td>
<td>5.5 (5â€™6â€)</td>
<td>150</td>
<td>8</td>
</tr>
<tr>
<td>å¥³</td>
<td>5.42 (5â€™5â€)</td>
<td>130</td>
<td>7</td>
</tr>
<tr>
<td>å¥³</td>
<td>5.75 (5â€™9â€)</td>
<td>150</td>
<td>9</td>
</tr>
</tbody></table>
<p>æˆ‘ä»¬å¯¹è®­ç»ƒé›†è®¡ç®—å¾—åˆ°ï¼š</p>
<table>
<thead>
<tr>
<th>æ€§åˆ«</th>
<th>å‡å€¼ï¼ˆèº«é«˜ï¼‰</th>
<th>æ–¹å·®ï¼ˆä½“é‡ï¼‰</th>
<th>å‡å€¼ï¼ˆä½“é‡ï¼‰</th>
<th>æ–¹å·®ï¼ˆä½“é‡ï¼‰</th>
<th>å‡å€¼ï¼ˆè„šçš„å°ºå¯¸ï¼‰</th>
<th>æ–¹å·®ï¼ˆè„šçš„å°ºå¯¸ï¼‰</th>
</tr>
</thead>
<tbody><tr>
<td>ç”·</td>
<td>5.855</td>
<td>3.5033e-02</td>
<td>176.25</td>
<td>1.2292e+02</td>
<td>11.25</td>
<td>9.1667e-01</td>
</tr>
<tr>
<td>å¥³</td>
<td>5.4175</td>
<td>9.7225e-02</td>
<td>132.5</td>
<td>5.5833e+02</td>
<td>7.5</td>
<td>1.6667e+00</td>
</tr>
</tbody></table>
<p>é‚£ä¹ˆåœ¨ç»™å®šå¦‚ä¸‹æ ·æœ¬è¿›è¡Œåˆ¤åˆ«ï¼š</p>
<ul>
<li><p>èº«é«˜ï¼š6 ä½“é‡ï¼š130 è„šçš„å°ºå¯¸ï¼š8<br>å¦‚ä½•è®¡ç®—å‘¢ï¼Ÿå¾ˆç®€å•ï¼ï¼ï¼æ¯”å¦‚è¯´æˆ‘ä»¬è®¡ç®—$P(èº«é«˜|ç”·æ€§)$æˆ‘ä»¬åªéœ€è¦å°†èº«é«˜6ä»£å…¥åˆ°æˆ‘ä»¬çš„<strong>é«˜æ–¯è´å¶æ–¯å…¬å¼</strong>é‡Œé¢å°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬çš„æ¦‚ç‡ã€‚æˆ‘ä»¬ä¾æ¬¡è®¡ç®—ä½“é‡ã€è„šçš„å°ºå¯¸å°±å¯ä»¥å¾—åˆ°ä¸€ç³»åˆ—çš„æ¦‚ç‡ï¼Œè€Œåæˆ‘ä»¬ä»£å…¥å…¬å¼ï¼š</p>
<p>$$<br>P(ç”·æ€§)&#x3D;\frac{P(ç”·æ€§)P(èº«é«˜|ç”·æ€§)â€¦.}{P(A)}\P(A)&#x3D;P(ç”·)*P(èº«é«˜|ç”·æ€§)â€¦.+P(å¥³æ€§)*P(èº«é«˜|å¥³æ€§)â€¦.\P(ç”·)&#x3D;0.5&#x3D;P(å¥³)<br>$$</p>
</li>
</ul>
<p>è€Œååˆ¤åˆ«ç”·å’Œå¥³çš„æ¦‚ç‡å¤§å°è¿›è€Œåˆ¤åˆ«æ˜¯ç”·æ€§è¿˜æ˜¯å¥³æ€§ï¼</p>
</blockquote>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>è´å¶æ–¯åˆ†ç±»å™¨</tag>
      </tags>
  </entry>
  <entry>
    <title>é€»è¾‘æ–¯è’‚å›å½’</title>
    <url>/posts/317190628/</url>
    <content><![CDATA[<p>ä»‹ç»é€»è¾‘æ–¯è’‚å›å½’åŸºæœ¬åŸç†</p>
<span id="more"></span>
<h1 id="Logisticå›å½’-é€»è¾‘æ–¯è’‚å›å½’"><a href="#Logisticå›å½’-é€»è¾‘æ–¯è’‚å›å½’" class="headerlink" title="Logisticå›å½’(é€»è¾‘æ–¯è’‚å›å½’)"></a>Logisticå›å½’(é€»è¾‘æ–¯è’‚å›å½’)</h1><p>[toc]</p>
<blockquote>
<p>é¦–å…ˆæ˜ç¡®ä¸€ç‚¹Logisticå›å½’è™½ç„¶å«å›å½’ï¼Œä½†æ˜¯<strong>ä¸€èˆ¬ç”¨äºäºŒåˆ†ç±»é—®é¢˜</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´è¿˜æ˜¯åˆ†ç±»ç®—æ³•çš„ä¸€ç§ï¼</p>
</blockquote>
<h2 id="æ•°å­¦ç†è®ºå‡†å¤‡"><a href="#æ•°å­¦ç†è®ºå‡†å¤‡" class="headerlink" title="æ•°å­¦ç†è®ºå‡†å¤‡"></a>æ•°å­¦ç†è®ºå‡†å¤‡</h2><ul>
<li><strong>çº¿æ€§å›å½’</strong><br>æ˜¯åˆ©ç”¨ç§°ä¸ºçº¿æ€§å›å½’æ–¹ç¨‹çš„æœ€å°äºŒä¹˜å‡½æ•°å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªè‡ªå˜é‡å’Œå› å˜é‡ä¹‹é—´å…³ç³»è¿›è¡Œå»ºæ¨¡çš„ä¸€ç§å›å½’åˆ†æ</li>
<li><strong>Sigmoidå‡½æ•°</strong><br>å› å…¶å‡½æ•°å›¾åƒå½¢çŠ¶åƒå­—æ¯Så¾—åã€‚å…¶å½¢çŠ¶æ›²çº¿è‡³å°‘æœ‰2ä¸ªç„¦ç‚¹ï¼Œä¹Ÿå«â€œäºŒç„¦ç‚¹æ›²çº¿å‡½æ•°â€ã€‚Så‹å‡½æ•°æ˜¯æœ‰ç•Œã€å¯å¾®çš„å®å‡½æ•°ï¼Œåœ¨å®æ•°èŒƒå›´å†…å‡æœ‰å–å€¼ï¼Œä¸”å¯¼æ•°æ’ä¸ºéè´Ÿ ï¼Œæœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‹ç‚¹ã€‚</li>
</ul>
<h2 id="é€»è¾‘æ–¯è’‚å›å½’"><a href="#é€»è¾‘æ–¯è’‚å›å½’" class="headerlink" title="é€»è¾‘æ–¯è’‚å›å½’"></a>é€»è¾‘æ–¯è’‚å›å½’</h2><p>æˆ‘ä»¬å…ˆçœ‹ç™¾åº¦ç™¾ç§‘å…³äºä»–çš„è§£é‡Šï¼šlogisticå›å½’æ˜¯ä¸€ç§å¹¿ä¹‰çº¿æ€§å›å½’ï¼ˆgeneralized linear modelï¼‰ï¼Œå› æ­¤ä¸å¤šé‡çº¿æ€§å›å½’åˆ†ææœ‰å¾ˆå¤šç›¸åŒä¹‹å¤„ã€‚<strong>å®ƒä»¬çš„æ¨¡å‹å½¢å¼åŸºæœ¬ä¸Šç›¸åŒ</strong>ï¼Œéƒ½å…·æœ‰ wx+bï¼Œå…¶ä¸­wå’Œbæ˜¯å¾…æ±‚å‚æ•°ï¼Œå…¶åŒºåˆ«åœ¨äºä»–ä»¬çš„å› å˜é‡çš„ä¸åŒï¼Œå¤šé‡çº¿æ€§å›å½’ç›´æ¥å°†wx+bä½œä¸ºå› å˜é‡ï¼Œå³y &#x3D;wx+bï¼Œè€Œlogisticå›å½’åˆ™é€šè¿‡<strong>å‡½æ•°L</strong>å°†wx+bå¯¹åº”ä¸€ä¸ªéšçŠ¶æ€pï¼Œp &#x3D;L(wx+b)ï¼Œç„¶åæ ¹æ®p ä¸1-pçš„å¤§å°å†³å®šå› å˜é‡çš„å€¼ã€‚å¦‚æœLæ˜¯logisticå‡½æ•°ï¼Œå°±æ˜¯logisticå›å½’ã€‚</p>
<blockquote>
<p><a href="https://baike.baidu.com/item/logistic%E5%9B%9E%E5%BD%92/2981575">logisticå›å½’_ç™¾åº¦ç™¾ç§‘ (baidu.com)</a></p>
</blockquote>
<p><strong>ä»€ä¹ˆæ„æ€</strong>ï¼Ÿå¬æˆ‘ç»™ä½ è§£é‡Šï¼é¦–å…ˆæˆ‘ä»¬ç›®çš„æ˜¯åˆ©ç”¨è¿™ä¸ªç®—æ³•åšä»€ä¹ˆï¼Ÿåˆ†ç±»ï¼æ²¡é”™æ—¢ç„¶æ˜¯åˆ†ç±»ç®—æ³•ï¼Œé‚£ä¹ˆæˆ‘å¿…é¡»å°±æœ‰ä¸€ä¸ªè¿›è¡Œåˆ†ç±»çš„æ ‡å‡†ï¼æ¯”å¦‚è¯´ï¼šKNN(Kè¿‘é‚»ç®—æ³•)æˆ‘ä»¬å°±æ˜¯ç›´æ¥è®¡ç®—æµ‹è¯•é›†ä¸è®­ç»ƒé›†ä¹‹é—´çš„è·ç¦»è€Œåè¿›è¡Œåˆ’åˆ†ã€‚è´å¶æ–¯åˆ†ç±»å™¨ï¼šå°±æ˜¯ç›´æ¥é€šè¿‡è®¡ç®—æ¦‚ç‡è€Œåè¿›è¡Œåˆ†ç±»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼šåˆ†ç±»ç®—æ³•æ¨¡å‹çš„å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A[æ•°æ®]---&gt;B&#123;æ¨¡å‹&#125;---&gt;c[ç»“æœ]</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>ç»“æœ</strong>ï¼šé€šè¿‡æ¨¡å‹æˆ‘ä»¬å¾—åˆ°çš„ç»“æœåº”è¯¥å¤§è‡´åœ¨ä¸€ä¸ªåŒºé—´å†…éƒ¨ï¼ˆæ¯”å¦‚ï¼š0-1ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å»ºç«‹ä¸€ä¸ªåˆ†ç±»çš„æ ‡å‡†ï¼Œæ¯”å¦‚ï¼š&gt;0.5çš„æ—¶å€™åˆ†ç±»ç»“æœä¸º1ï¼Œï¼œ0.5çš„æ—¶å€™åˆ†ç±»ç»“æœä¸º0</p>
</blockquote>
<p>æˆ‘ä»¬çŸ¥é“å¦‚æœä»…ä»…åªä½¿ç”¨$wx+b$æˆ‘ä»¬æ˜¯å¾—ä¸åˆ°ä¸Šè¿°<strong>ç»“æœ</strong>ï¼Œå› æ­¤æˆ‘ä»¬å€ŸåŠ©<strong>å‡½æ•°L</strong>ï¼Œå¯¹$wx+b$çš„ç»“æœè¿›è¡Œå¤„ç†ã€‚</p>
<h2 id="é€»è¾‘æ–¯è’‚å‡½æ•°"><a href="#é€»è¾‘æ–¯è’‚å‡½æ•°" class="headerlink" title="é€»è¾‘æ–¯è’‚å‡½æ•°"></a>é€»è¾‘æ–¯è’‚å‡½æ•°</h2><p>é€šè¿‡ä¸Šè¿°å¯¹é€»è¾‘æ–¯è’‚å›å½’å®šä¹‰çš„äº†è§£æˆ‘ä»¬å¾—çŸ¥ï¼Œä»…ä»…åªå€ŸåŠ©$wx+b$æ˜¯å¾—ä¸åˆ°æˆ‘ä»¬éœ€è¦çš„ç»“æœï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªå‡½æ•°å¯¹$wx+b$è¿›è¡Œå¤„ç†ï¼Œæ­¤å¤„æ‰€ç”¨çš„å‡½æ•°å°±æ˜¯<strong>é€»è¾‘æ–¯è’‚å‡½æ•°ï¼š</strong></p>
<p>$$<br>y&#x3D;\frac{1}{1+e^{-z}}\z&#x3D;wx+b,é‚£ä¹ˆå°†zä»£å…¥ä¸Šå¼å¾—åˆ°ï¼š\y&#x3D;\frac{1}{1+e^{-(wx+b)}}<br>$$</p>
<p>æˆ‘ä»¬ä¸Šå¼å˜å½¢å¯ä»¥å¾—åˆ°ï¼š</p>
<p>$$<br>y&#x3D;\frac{1}{1+e^{-(wx+b)}}åˆ™ï¼š\frac{1}{y}-1&#x3D;e^{-(wx+b)}åŒæ—¶å–å¯¹æ•°:ln(\frac{y}{1-y})&#x3D;wx+b<br>$$</p>
<p>æ­¤æ—¶æˆ‘ä»¬åªéœ€è¦æ±‚è§£å‚æ•°wå’Œbå°±å¯ä»¥è¿›è¡Œåˆ†ç±»äº†</p>
<h2 id="å‚æ•°æ±‚è§£"><a href="#å‚æ•°æ±‚è§£" class="headerlink" title="å‚æ•°æ±‚è§£"></a>å‚æ•°æ±‚è§£</h2><p>æ­¤å¤„ä»‹ç»ä¸¤ç§æ±‚è§£æ–¹æ³•ï¼šæ¢¯åº¦ä¸‹é™ç®—æ³•ã€ç‰›é¡¿è¿­ä»£ç®—æ³•</p>
<h3 id="æ¢¯åº¦ä¸Šå‡ç®—æ³•"><a href="#æ¢¯åº¦ä¸Šå‡ç®—æ³•" class="headerlink" title="æ¢¯åº¦ä¸Šå‡ç®—æ³•"></a>æ¢¯åº¦ä¸Šå‡ç®—æ³•</h3><p>$$<br>\theta&#x3D;\theta-\eta\nabla_Î¸ J(Î¸)\\eta:å­¦ä¹ ç‡ï¼Œ\nabla:æ±‚å¯¼<br>$$</p>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>é€»è¾‘æ–¯è’‚å›å½’</tag>
      </tags>
  </entry>
  <entry>
    <title>æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§--SHAP</title>
    <url>/posts/5bf8429/</url>
    <content><![CDATA[<center>A Unified Approach to Interpreting Model Predictions</center>

<center>trusting a prediction or trusting a model</center>

<p>å¦‚æœâ¼€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹è¿â¾è‰¯å¥½ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä»…ä»…ä¿¡ä»»è¯¥æ¨¡å‹â½½å¿½ç•¥ä¸ºä»€ä¹ˆåšå‡ºç‰¹å®šçš„å†³ç­–å‘¢ï¼Ÿ<br>è¯¸å¦‚åˆ†ç±»å‡†ç¡®æ€§ä¹‹ç±»çš„å•â¼€æŒ‡æ ‡â½†æ³•å®Œæ•´åœ°æè¿°â¼¤å¤šæ•°å®é™…ä»»åŠ¡ã€‚å½“æ¶‰åŠåˆ°é¢„æµ‹æ¨¡å‹æ—¶ï¼Œéœ€è¦ä½œå‡ºæƒè¡¡ï¼š<strong>ä½ æ˜¯åªæƒ³çŸ¥é“é¢„æµ‹æ˜¯ä»€ä¹ˆï¼Ÿ</strong>ä¾‹å¦‚ï¼Œå®¢æˆ·æµå¤±çš„æ¦‚ç‡æˆ–æŸç§è¯ç‰©å¯¹ç—…â¼ˆçš„ç–—æ•ˆã€‚<strong>è¿˜æ˜¯æƒ³çŸ¥é“ä¸ºä»€ä¹ˆåšå‡ºè¿™æ ·çš„é¢„æµ‹ï¼Ÿ</strong>è¿™ç§æƒ…å†µä¸‹å¯èƒ½ä¸ºäº†å¯è§£é‡Šæ€§ä»˜å‡ºé¢„æµ‹æ€§èƒ½ä¸‹é™çš„ä»£ä»·ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ ä¸å¿…å…³â¼¼ä¸ºä»€ä¹ˆè¦åšå‡ºè¿™æ ·çš„é¢„æµ‹ï¼Œåªè¦çŸ¥é“æ¨¡å‹åœ¨æµ‹è¯•æ•°æ®é›†çš„é¢„æµ‹æ€§èƒ½è‰¯å¥½å°±â¾œå¤Ÿäº†ã€‚ä½†æ˜¯åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œäº†è§£ â€œä¸ºä»€ä¹ˆâ€ å¯ä»¥å¸®åŠ©ä½ æ›´å¤šåœ°äº†è§£é—®é¢˜ã€æ•°æ®ä»¥åŠæ¨¡å‹å¯èƒ½å¤±è´¥çš„åŸå› ã€‚æœ‰äº›æ¨¡å‹å¯èƒ½ä¸éœ€è¦è§£é‡Šï¼Œå› ä¸ºå®ƒä»¬æ˜¯åœ¨ä½é£é™©çš„ç¯å¢ƒä¸­ä½¿â½¤çš„ï¼Œè¿™æ„å‘³ç€é”™è¯¯ä¸ä¼šé€ æˆä¸¥é‡åæœ (ä¾‹å¦‚ï¼Œç”µå½±æ¨èç³»ç»Ÿ)ï¼Œæˆ–è€…è¯¥â½…æ³•å·²ç»è¢«â¼´æ³›ç ”ç©¶å’Œè¯„ä¼° (ä¾‹å¦‚ï¼Œå…‰å­¦å­—ç¬¦è¯†åˆ« OCR)ã€‚å¯¹å¯è§£é‡Šæ€§çš„éœ€æ±‚æ¥â¾ƒé—®é¢˜å½¢å¼åŒ–çš„ä¸å®Œæ•´æ€§ï¼Œè¿™æ„å‘³ç€å¯¹äºæŸäº›é—®é¢˜æˆ–ä»»åŠ¡ï¼Œä»…ä»…è·å¾—é¢„æµ‹ç»“æœæ˜¯ä¸å¤Ÿçš„ã€‚è¯¥æ¨¡å‹è¿˜å¿…é¡»è§£é‡Šæ˜¯æ€ä¹ˆè·å¾—è¿™ä¸ªé¢„æµ‹çš„ï¼Œå› ä¸ºæ­£ç¡®çš„é¢„æµ‹åªéƒ¨åˆ†åœ°è§£å†³äº†ä½ çš„åŸå§‹é—®é¢˜ã€‚</p>
<span id="more"></span>

<h1 id="æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§"><a href="#æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§" class="headerlink" title="æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§"></a>æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§</h1><p>éœ€è¦å»ºç«‹ä¸€ä¸ªè§£é‡Šå™¨æ¥è§£é‡Šé»‘ç›’æ¨¡å‹ï¼Œå¹¶ä¸”è¿™ä¸ªè§£é‡Šå™¨å¿…é¡»æ»¡è¶³ä»¥ä¸‹ç‰¹å¾ï¼š<br><strong>å¯è§£é‡Šæ€§</strong><br>è¦æ±‚è§£é‡Šå™¨çš„æ¨¡å‹ä¸ç‰¹å¾éƒ½å¿…é¡»æ˜¯å¯è§£é‡Šçš„ï¼Œåƒå†³ç­–æ ‘ã€çº¿æ€§æ¨¡å‹éƒ½æ˜¯å¾ˆé€‚åˆæ‹¿æ¥è§£é‡Šçš„æ¨¡å‹ï¼›è€Œå¯è§£é‡Šçš„æ¨¡å‹å¿…é¡»æ­é…å¯è§£é‡Šçš„ç‰¹å¾ï¼Œæ‰æ˜¯çœŸæ­£çš„å¯è§£é‡Šæ€§ï¼Œè®©ä¸äº†è§£æœºå™¨å­¦ä¹ çš„äººä¹Ÿèƒ½é€šè¿‡è§£é‡Šå™¨ç†è§£æ¨¡å‹ã€‚<br><strong>å±€éƒ¨ä¿çœŸåº¦</strong><br>æ—¢ç„¶æˆ‘ä»¬å·²ç»ä½¿ç”¨äº†å¯è§£é‡Šçš„æ¨¡å‹ä¸ç‰¹å¾ï¼Œå°±ä¸å¯èƒ½æœŸæœ›ç®€å•çš„å¯è§£é‡Šæ¨¡å‹åœ¨æ•ˆæœä¸Šç­‰åŒäºå¤æ‚æ¨¡å‹ï¼ˆæ¯”å¦‚åŸå§‹CNNåˆ†ç±»å™¨ï¼‰ã€‚æ‰€ä»¥è§£é‡Šå™¨ä¸éœ€è¦åœ¨å…¨å±€ä¸Šè¾¾åˆ°å¤æ‚æ¨¡å‹çš„æ•ˆæœï¼Œä½†è‡³å°‘åœ¨å±€éƒ¨ä¸Šæ•ˆæœè¦å¾ˆæ¥è¿‘ï¼Œè€Œæ­¤å¤„çš„å±€éƒ¨ä»£è¡¨æˆ‘ä»¬æƒ³è§‚å¯Ÿçš„é‚£ä¸ªæ ·æœ¬çš„å‘¨å›´ã€‚<br><strong>ä¸æ¨¡å‹æ— å…³</strong><br>è¿™é‡Œæ‰€æŒ‡çš„æ˜¯ä¸å¤æ‚æ¨¡å‹æ— å…³ï¼Œæ¢å¥è¯è¯´æ— è®ºå¤šå¤æ‚çš„æ¨¡å‹ï¼Œåƒæ˜¯SVMæˆ–ç¥ç»ç½‘ç»œï¼Œè¯¥è§£é‡Šå™¨éƒ½å¯ä»¥å·¥ä½œã€‚<br>é™¤äº†ä¼ ç»Ÿçš„ç‰¹å¾é‡è¦æ€§æ’åºå¤–ï¼ŒICEã€PDPã€SDTã€LIMEã€SHAPéƒ½æ˜¯æ­å¼€æœºå™¨å­¦ä¹ æ¨¡å‹é»‘ç®±çš„æœ‰åŠ›å·¥å…·ã€‚</p>
<ul>
<li>ç‰¹å¾é‡è¦æ€§è®¡ç®—ä¾æ®æŸä¸ªç‰¹å¾è¿›è¡Œå†³ç­–æ ‘åˆ†è£‚æ—¶ï¼Œåˆ†è£‚å‰åçš„ä¿¡æ¯å¢ç›Šï¼ˆåŸºå°¼ç³»æ•°ï¼‰ï¼›</li>
<li>ICEå’ŒPDPè€ƒå¯ŸæŸé¡¹ç‰¹å¾çš„ä¸åŒå–å€¼å¯¹æ¨¡å‹è¾“å‡ºå€¼çš„å½±å“ï¼›</li>
<li>SDTç”¨å•æ£µå†³ç­–æ ‘è§£é‡Šå…¶å®ƒæ›´å¤æ‚çš„æœºå™¨å­¦ä¹ æ¨¡å‹ï¼›</li>
<li>LIMEçš„æ ¸å¿ƒæ€æƒ³æ˜¯å¯¹äºæ¯æ¡æ ·æœ¬ï¼Œå¯»æ‰¾ä¸€ä¸ªæ›´å®¹æ˜“è§£é‡Šçš„ä»£ç†æ¨¡å‹è§£é‡ŠåŸæ¨¡å‹ï¼›</li>
<li>SHAPçš„æ¦‚å¿µæºäºåšå¼ˆè®ºï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯è®¡ç®—ç‰¹å¾å¯¹æ¨¡å‹è¾“å‡ºçš„è¾¹é™…è´¡çŒ®ï¼›</li>
</ul>
<hr>
<p>1ã€<a href="https://hjezero.github.io/posts/cd6f0230/">æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§â€“LIME</a><br>2ã€<a href="https://hjezero.github.io/posts/5bf8429/">æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§â€“SHAP</a></p>
<h1 id="æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§â€“SHAP"><a href="#æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§â€“SHAP" class="headerlink" title="æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§â€“SHAP"></a>æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§â€“SHAP</h1><p>[toc]</p>
<h2 id="1ã€Shapley-Value"><a href="#1ã€Shapley-Value" class="headerlink" title="1ã€Shapley Value"></a>1ã€Shapley Value</h2><p><strong>æ²™æ™®åˆ©å€¼</strong><a href="https://github.com/MingchaoZhu/InterpretableMLBook">^1</a>ï¼ˆShapley valueï¼‰ï¼Œæ˜¯é€šè¿‡è€ƒè™‘å„ä¸ªä»£ç†ï¼ˆagentï¼‰åšå‡ºçš„è´¡çŒ®ï¼Œæ¥å…¬å¹³åœ°åˆ†é…åˆä½œæ”¶ç›Šã€‚ä»£ç†çš„æ²™æ™®åˆ©å€¼æ˜¯å¯¹äºä¸€ä¸ªåˆä½œé¡¹ç›®æ‰€æœŸæœ›çš„è´¡çŒ®é‡çš„å¹³å‡å€¼ã€‚è®¡ç®—å…¬å¼ï¼š<br>è®¾$I&#x3D;{1,2â€¦n}$ä¸º$n$ä¸ªäººçš„é›†åˆé‚£ä¹ˆ$i$çš„è´¡çŒ®ä¸ºï¼š</p>
<p>$$<br>\varphi_{i}&#x3D;\sum_{s\in S_{i}}w(|s|)[v(s)-v(s\i)]<br>$$</p>
<p>å…¶ä¸­$S_{i}$æ˜¯$I$ä¸­åŒ…å«æˆå‘˜$i$çš„æ‰€æœ‰å­é›†å½¢æˆçš„é›†åˆï¼Œ$w(|s|)$æ˜¯åŠ æƒå› å­ï¼Œ$s\i$è¡¨ç¤ºé›†åˆ$s$ä¸­å»æ‰å…ƒç´ $i$åçš„é›†åˆã€‚<br>$v(s)-v(s\i)$æˆå‘˜iåœ¨è”ç›Ÿä¸­çš„è´¡çŒ®ï¼Œå³æˆå‘˜içš„è¾¹é™…è´¡çŒ®ï¼›$w(|s|)$æƒé‡$w(|s|&#x3D;\frac{(|s|-1)!(n-|s|)!}{n!})$</p>
<blockquote>
<p>WiKiï¼š</p>
<p>ç©å®¶è”ç›Ÿåˆä½œï¼Œå¹¶ä»åˆä½œä¸­è·å¾—ä¸€å®šçš„æ•´ä½“æ”¶ç›Šã€‚ç”±äºä¸€äº›å‚ä¸è€…å¯èƒ½æ¯”å…¶ä»–å‚ä¸è€…å¯¹è”ç›Ÿè´¡çŒ®æ›´å¤šï¼Œæˆ–è€…å¯èƒ½æ‹¥æœ‰ä¸åŒçš„è®®ä»·èƒ½åŠ›ï¼ˆä¾‹å¦‚å¨èƒè¦æ‘§æ¯å…¨éƒ¨ç›ˆä½™ï¼‰ï¼Œå› æ­¤åœ¨ä»»ä½•ç‰¹å®šåšå¼ˆä¸­ï¼Œå‚ä¸è€…ä¹‹é—´äº§ç”Ÿçš„ç›ˆä½™çš„æœ€ç»ˆåˆ†é…åº”è¯¥æ˜¯ä»€ä¹ˆï¼Ÿæˆ–è€…æ¢å¥è¯è¯´ï¼šæ¯ä¸ªå‚ä¸è€…å¯¹æ•´ä½“åˆä½œæœ‰å¤šé‡è¦ï¼Œä»–æˆ–å¥¹å¯ä»¥åˆç†é¢„æœŸçš„å›æŠ¥æ˜¯ä»€ä¹ˆï¼ŸShapley å€¼ä¸ºè¿™ä¸ªé—®é¢˜æä¾›äº†ä¸€ä¸ªå¯èƒ½çš„ç­”æ¡ˆã€‚</p>
<p>1ã€<a href="https://en.wikipedia.org/wiki/Shapley_value">https://en.wikipedia.org/wiki/Shapley_value</a><br>ã€Šå¯è§£é‡Šçš„æœºå™¨å­¦ä¹ ã€‹<br>å¼€æºåœ°å€ï¼š<br>2ã€<a href="https://github.com/MingchaoZhu/InterpretableMLBook">https://github.com/MingchaoZhu/InterpretableMLBook</a><br>åœ¨çº¿é˜…è¯»ï¼š<br>3ã€<a href="https://hjezero.github.io/posts/32fedbdb/">https://hjezero.github.io/posts/32fedbdb/</a></p>
</blockquote>
<p>å€ŸåŠ©ã€Šå¯è§£é‡Šçš„æœºå™¨å­¦ä¹ ã€‹ä¸­ä¾‹å­ï¼Œå‡è®¾å‡†å¤‡è´­ä¹°ä¸€é—´å…¬å¯“ï¼Œå…¶ä¸­ä½ æ‰€æ„Ÿå…´è¶£çš„æ˜¯ï¼š1ã€æœ‰æ— å…¬å›­ï¼›2ã€å…¬å¯“é¢ç§¯ï¼›3ã€å…¬å¯“æ‰€ä½äºçš„æ¥¼å±‚ï¼›4ã€æ˜¯å¦èƒ½å…»çŒ«ã€‚è€Œåå¯¹å…¬å¯“ä»·æ ¼é¢„æµ‹ã€‚</p>
<img data-src="https://s2.loli.net/2023/06/07/cgknwhxlI9uJT4H.png" alt="202306071608311" style="zoom:80%;">
>â¼€å¥— 50 å¹³â½…â½¶çš„å…¬å¯“ï¼Œé™„è¿‘æœ‰å…¬å›­ä»¥åŠç¦â½ŒçŒ«â¼Šå†…ï¼Œé¢„è®¡ä»·æ ¼ä¸º 300,000 æ¬§å…ƒ

<p>é‚£ä¹ˆ1ã€å…¬å¯“é¢ç§¯ï¼›2ã€å…¬å¯“æ¥¼å±‚ï¼›3ã€å…»çŒ«ï¼Ÿ4ã€å…¬å›­ï¼Ÿè¿™4ä¸ªç‰¹å¾å¯¹<strong>é¢„æµ‹ä»·æ ¼</strong>300000æ¬§å…ƒçš„<strong>è´¡çŒ®</strong>æ˜¯æ€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</p>
<blockquote>
<p>æ¯”å¦‚è¯´<a href="https://www.zhihu.com/question/23180647">^2</a>ï¼šä¸€ä¸ªç¨‹åºC&#x3D;500è¡Œä»£ç éœ€è¦ç¼–å†™ï¼Œä»Šå¤©äº§å“ç»ç†æ‰¾äº†ä¸‰ä¸ªç¨‹åºçŒ¿æ¥å®Œæˆï¼ŒæŒ‰ç…§å®Œæˆé‡å‘å¥–é‡‘ï¼š<br>æ¡ä»¶ä¸€ï¼š$V_{1}&#x3D;100$ï¼Œ$V_{2}&#x3D;125$ï¼Œ$V_{3}&#x3D;50$<br>è§£é‡Šï¼š1å·å±Œä¸ç¨‹åºçŒ¿ç‹¬ç«‹èƒ½å†™100è¡Œï¼Œ2å·å¤§ç¥ç¨‹åºçŒ¿ç‹¬ç«‹èƒ½å†™125è¡Œï¼Œ3å·ç¾å¥³ç¨‹åºçŒ¿èƒ½å†™50è¡Œ<br>æ¡ä»¶äºŒï¼š$V_{12}&#x3D;270$ï¼Œ$V_{23}&#x3D;350$ï¼Œ$V_{13}&#x3D;375$<br>è§£é‡Šï¼š1,2å·åˆä½œèƒ½å†™270è¡Œï¼Œ2,3å·åˆä½œèƒ½å†™350è¡Œï¼Œ1,3å·åˆä½œèƒ½å†™375è¡Œ<br>æ¡ä»¶ä¸‰ï¼š$V_{123}&#x3D;500$<br>3ä¸ªäººå…±åŒèƒ½å®Œæˆ500è¡Œ<br>é‚£ä¹ˆæ ¹æ®3ç»„æ¡ä»¶ï¼Œåˆè®¡6ç§ç»„åˆåˆ†åˆ«å¦‚ä¸‹ï¼š<br>A.1å·ç¨‹åºçŒ¿é‚€è¯·2å·ç¨‹åºçŒ¿åŠ å…¥ä»–ç»„æˆSè”ç›Ÿï¼Œ1,2å·é‚€è¯·3å·åŠ å…¥å…±åŒç¼–å†™ã€‚<br>B.1å·é‚€è¯·3å·åŠ å…¥æˆä¸ºSå°ç»„ï¼Œ2å·åŠ å…¥Så°ç»„<br>C.2å·é‚€è¯·1å·åŠ å…¥æˆä¸ºSå°ç»„ï¼Œ3å·åŠ å…¥Så°ç»„<br>D.2å·é‚€è¯·3å·åŠ å…¥æˆä¸ºSå°ç»„ï¼Œ1å·åŠ å…¥Så°ç»„<br>E.3å·é‚€è¯·1å·åŠ å…¥æˆä¸ºSå°ç»„ï¼Œ2å·åŠ å…¥Så°ç»„<br>F.3å·é‚€è¯·2å·åŠ å…¥æˆä¸ºSå°ç»„ï¼Œ1å·åŠ å…¥Så°ç»„<br>è®¡ç®—è¾¹é™…è´¡çŒ®ï¼š</p>
</blockquote>
<blockquote>
<img data-src="https://pica.zhimg.com/450be1b5a2d5196399f6665086a728d2_r.jpg?source=1940ef5c" alt="202306071608311" style="zoom:80%;">
</blockquote>
<blockquote>
<p>æ ¹æ®å…¬å¼1å¾—åˆ°ï¼š<br>1çš„shapley valueï¼š<br>$\frac{1}{6}(100+100+145+150+325+150)&#x3D;\frac{970}{6}$</p>
<p>ä¾æ¬¡ç±»æ¨å¾—åˆ°å…¶ä»–äººçš„shapely value</p>
</blockquote>
<h2 id="2ã€A-Unified-Approach-to-Interpreting-Model-Predictions"><a href="#2ã€A-Unified-Approach-to-Interpreting-Model-Predictions" class="headerlink" title="2ã€A Unified Approach to Interpreting Model Predictions"></a>2ã€<a href="https://arxiv.org/pdf/1705.07874.pdf">A Unified Approach to Interpreting Model Predictions</a></h2><p>SHAP Valueä¸LIMEçš„æ–¹æ³•ç±»ä¼¼ï¼Œéƒ½æ˜¯é€šè¿‡å®šä¹‰ç®€å•æ¨¡å‹å»å¯¹å¤æ‚æ¨¡å‹è¿›è¡Œè§£é‡Šã€‚</p>
<blockquote>
<p>â€œwe must use a simpler explanation model, which we define as any interpretable approximation of the original model.â€ (Lundberg å’Œ Lee, 2017, p. 2)</p>
<p>æˆ‘ä»¬å¿…é¡»ä½¿ç”¨ä¸€ä¸ªæ›´ç®€å•çš„è§£é‡Šæ¨¡å‹ï¼Œæˆ‘ä»¬å°†å…¶å®šä¹‰ä¸ºå¯¹åŸæ¨¡å‹çš„ä»»ä½•å¯è§£é‡Šçš„è¿‘ä¼¼ã€‚</p>
</blockquote>
<p>å›é¡¾LIMEæ¨¡å‹ï¼Œåˆ©ç”¨ç®€å•å‡½æ•°$g$å»åœ¨$x$â€œå‘¨å›´â€å»å¯¹å¤æ‚å‡½æ•°$f$è¿›è¡Œå±€éƒ¨è¿‘ä¼¼ã€‚åœ¨æœ¬è®ºæ–‡ä½œè€…å°†éƒ¨åˆ†<strong>è§£é‡Šæ¨¡å‹å‡½æ•°</strong>ç§°ä¸º<em>Additive feature attribution methods</em>å…¶å½¢å¼å½¢å¦‚ï¼š</p>
<p>$$<br>g(z)&#x3D;\phi_{0}+\sum_{i&#x3D;1}^{M}\phi_{i}z_{i}<br>$$</p>
<p>å…¶ä¸­ï¼š$M$æ‰€æœ‰çš„ç®€å•è¾“å…¥ç‰¹å¾çš„ä¸ªæ•°ï¼›$\phi_{i}$æ¯ä¸€ç§ç‰¹å¾çš„<strong>è´¡çŒ®</strong>ï¼ˆå¯¹äºçš„shapelyå€¼ï¼‰ï¼›é€šè¿‡è®¡ç®—æ‰€æœ‰ç‰¹å¾çš„è´¡çŒ®å»è¿‘ä¼¼å¤æ‚å‡½æ•°$f(x)$</p>
<blockquote>
<p>è®ºæ–‡ä¸­éƒ¨åˆ†<strong>è§£é‡Šæ¨¡å‹å‡½æ•°</strong>æœ‰ï¼š</p>
<p>1ã€LIMEæ¨¡å‹å¯¹<strong>è´¡çŒ®</strong>è®¡ç®—ï¼š</p>
<p>$$<br>\xi(s)&#x3D; argmin_{g\in G} L(f,g,\pi_{x})+\Omega(g)<br>$$</p>
<p>2ã€DeepLIFTï¼ˆé¢å‘æ·±åº¦å­¦ä¹ çš„å¯è§£é‡Šæ–¹æ³•ï¼‰æ¨¡å‹å¯¹<strong>è´¡çŒ®</strong>è®¡ç®—ï¼š</p>
<p>$$<br>\sum_{i&#x3D;1}^{n}C_{\Delta x_{i}\Delta o}&#x3D;\Delta o<br>$$</p>
<p>è´¡çŒ®ä¸ºï¼š$C_{\Delta x_{i}\Delta o}$ï¼Œå…¶ä¸­$o&#x3D;f(x)$ä¸ºæ¨¡å‹çš„è¾“å‡ºï¼Œå…¶ä¸­$r$ä¸ºå‚è€ƒçš„æ ·æœ¬è¾“å…¥ï¼Œ$\Delta o&#x3D;f(x)-f(r)$ã€‚<br>3ã€ç»å…¸Shapley Valueè®¡ç®—ï¼š</p>
<ul>
<li>Shapley regression values</li>
</ul>
<blockquote>
<p>feature importances for linear models in the presence of multicollinearity.<br>æ­¤æ¨¡å‹è¦æ±‚è®¡ç®—æ¨¡å‹æ‰€æœ‰çš„ç‰¹å¾ï¼Œè®¤ä¸ºæ¯ä¸€ä¸ªç‰¹å¾åœ¨æ¨¡å‹ä¸­éƒ½èµ·åˆ°äº†ä½œç”¨ã€‚è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p>
</blockquote>
<img data-src="https://s2.loli.net/2023/06/08/LFq8k1WHQsghB4P.png" alt="202306081444642" style="zoom:60%;">

<blockquote>
<p>å°±æ˜¯ä¸Šé¢åˆ—å­ä¸­æåŠåˆ°çš„è®¡ç®—æ–¹æ³•</p>
</blockquote>
<ul>
<li>Shapley sampling values</li>
<li>Quantitative Input Influence</li>
</ul>
</blockquote>
<p>å¯¹äº<em>additive feature attribution methods</em> å­˜åœ¨å¦‚ä¸‹ä¸‰ç‚¹<a href="https://christophm.github.io/interpretable-ml-book/shap.html">æ€§è´¨</a>ï¼š<br>1ã€Local accuracy<br>2ã€Missingness<br>3ã€Consistency</p>
<h2 id="Kernel-SHAP-Linear-LIME-Shapley-values"><a href="#Kernel-SHAP-Linear-LIME-Shapley-values" class="headerlink" title="Kernel SHAP(Linear LIME + Shapley values)"></a><em>Kernel SHAP(Linear LIME + Shapley values)</em></h2><h3 id="Kernel-SHAPè®¡ç®—æ­¥éª¤ï¼š"><a href="#Kernel-SHAPè®¡ç®—æ­¥éª¤ï¼š" class="headerlink" title="Kernel SHAPè®¡ç®—æ­¥éª¤ï¼š"></a>Kernel SHAPè®¡ç®—æ­¥éª¤ï¼š</h3><p><strong>â€»<em>1. åˆå§‹åŒ–ä¸€äº›æ•°æ®, zâ€™, ä½œä¸ºSimplified Featuresï¼ˆéšæœºç”Ÿæˆï¼ˆ0,1,1,0ï¼‰,(1,0,1,1)ç­‰ï¼‰</em></strong></p>
<blockquote>
<p>å…¶ä¸­ï¼š$zâ€™_{k}\in{(0,1)}^{M}$ï¼ˆ0ï¼šç¼ºå¤±ç‰¹å¾ï¼›1ï¼šåˆå§‹åŒ–ä¸­å­˜åœ¨çš„ç‰¹å¾ï¼‰å…¶ä¸­$M$æ˜¯æˆ‘ä»¬çš„ç»´æ•°ï¼ˆç†è§£ä¸ºæ ·æœ¬ç‰¹å¾æ•°ç›®ï¼‰ï¼Œ$k\in{(1,â€¦K)}$ä»£è¡¨ç”Ÿæˆæ•°æ®ä¸ªæ•°</p>
</blockquote>
<p><strong>â€»<em>2. å°†ä¸Šé¢çš„Simplified Featuresè½¬æ¢åˆ°åŸå§‹æ•°æ®ç©ºé—´, å¹¶è®¡ç®—å¯¹åº”çš„é¢„æµ‹å€¼, f(h(zâ€™))</em></strong></p>
<blockquote>
<p>æ¯”å¦‚è¯´ä¸Šé¢å–æˆ¿å­ä¾‹å­ï¼Œæœ‰å››ä¸ªç‰¹å¾æ‰€ä»¥$M&#x3D;4$é‚£ä¹ˆå‡è®¾åˆå§‹åŒ–ä¸º$zâ€™_{1}&#x3D;(0,1,1,0)$é‚£ä¹ˆä¹Ÿå°±æ˜¯å­˜åœ¨ç¬¬äºŒå’Œç¬¬ä¸‰ä¸ªç‰¹å¾çš„è”ç›Ÿï¼Œé‚£ä¹ˆå¯¹äºç¬¬ä¸€ä¸ªå’Œç¬¬å››ä¸ªåˆ™é€šè¿‡$h$å‡½æ•°è¿›è¡Œè½¬æ¢</p>
<img data-src="https://s2.loli.net/2023/06/08/g3nWKHrlfB5Z79T.png" alt="202306082023949" style="zoom:60%;">
</blockquote>
<p><strong>â€»<em>3. å¯¹æ¯ä¸€ä¸ªzâ€™è®¡ç®—å¯¹åº”çš„æƒé‡</em></strong></p>
<blockquote>
<p><strong>Kernel SHAPçš„æƒé‡å‡½æ•°</strong>$\pi$ä¸ºï¼š$\pi_{x^{â€˜}}(z^{â€˜})&#x3D;\frac{M-1}{(M;choose;|z^{â€˜}|)(M-|z^{â€˜}|)}$ï¼Œå…¶ä¸­$M$ä¸ºç»´æ•°ï¼ˆæ‰€æœ‰ç‰¹å¾çš„ä¸ªæ•°ï¼‰ï¼Œ$|z^{â€˜}|$ä»£è¡¨æ ·æœ¬ä¸­1çš„ä¸ªæ•°ï¼Œ$M;choose;|z^{â€˜}|$ä»£è¡¨$C_{M}^{z^{â€˜}}|z^{â€˜}|$ã€‚å®¹æ˜“å¾—åˆ°ï¼šè‹¥æœ‰å¾ˆå¤š1æˆ–å¾ˆå¤š0åˆ™å–è¾ƒé«˜çš„æƒé‡ï¼Œè‹¥0å’Œ1æ•°é‡ç›¸è¿‘åˆ™å–è¾ƒä½çš„æƒé‡ã€‚</p>
<p><strong>LIMEåˆ™æ˜¯é€šè¿‡è·ç¦»è®¾ç½®æƒé‡</strong></p>
</blockquote>
<p><strong>â€»<em>4. æ‹Ÿåˆçº¿æ€§æ¨¡å‹</em></strong><br><strong>â€»<em>5. è®¡ç®—å‡ºæ¯ä¸€ä¸ªç‰¹å¾çš„Shapley Value, ä¹Ÿå°±æ˜¯çº¿æ€§æ¨¡å‹çš„ç³»æ•°</em></strong></p>
<h3 id="Kernel-SHAPè®¡ç®—"><a href="#Kernel-SHAPè®¡ç®—" class="headerlink" title="Kernel SHAPè®¡ç®—"></a>Kernel SHAPè®¡ç®—</h3><p>æŸå¤±å‡½æ•°ï¼š</p>
<p>$$<br>L(f,g,\pi_x^{â€˜})&#x3D;\sum_{z^{â€˜} \in Z}[f(h_{x}^{-1}(z^{â€˜}))-g(z^{â€˜})]^{2}\pi_{x}^{â€˜}(z^{â€˜})<br>$$</p>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p>1ã€<a href="https://github.com/MingchaoZhu/InterpretableMLBook">https://github.com/MingchaoZhu/InterpretableMLBook</a></p>
<p>2ã€<a href="https://www.zhihu.com/question/23180647">https://www.zhihu.com/question/23180647</a></p>
<p>3ã€[å…³äºShapley Valueï¼ˆå¤æ™®åˆ©å€¼ï¼‰çš„å…¬å¼ - çŸ¥ä¹ (zhihu.com)](<a href="https://zhuanlan.zhihu.com/p/483891565#:~:text=Shapley">https://zhuanlan.zhihu.com/p/483891565#:~:text=Shapley</a> Valueå…¬å¼å¦‚ä¸‹ï¼š è®° I%3D { 1%2C2%2Câ€¦%2Cn}ä¸ºnä¸ªåˆä½œäººçš„é›†åˆ varphi_i (upsilon),- upsilon (s backslash  { i })]})</p>
<p>4ã€<a href="https://e0hyl.github.io/BLOG-OF-E0/LIMEandSHAP/">https://e0hyl.github.io/BLOG-OF-E0/LIMEandSHAP/</a></p>
<p>5ã€<a href="https://mathpretty.com/10699.html">https://mathpretty.com/10699.html</a></p>
<h1 id="æ¨èé˜…è¯»"><a href="#æ¨èé˜…è¯»" class="headerlink" title="æ¨èé˜…è¯»"></a>æ¨èé˜…è¯»</h1><p>1ã€<a href="https://christophm.github.io/interpretable-ml-book">https://christophm.github.io/interpretable-ml-book</a></p>
<p>[^3]: [å…³äºShapley Valueï¼ˆå¤æ™®åˆ©å€¼ï¼‰çš„å…¬å¼ - çŸ¥ä¹ (zhihu.com)](<a href="https://zhuanlan.zhihu.com/p/483891565#:~:text=Shapley">https://zhuanlan.zhihu.com/p/483891565#:~:text=Shapley</a> Valueå…¬å¼å¦‚ä¸‹ï¼š è®° I%3D { 1%2C2%2Câ€¦%2Cn}ä¸ºnä¸ªåˆä½œäººçš„é›†åˆ varphi_i (upsilon),- upsilon (s backslash  { i })]})</p>
]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>æœºå™¨å­¦ä¹ </tag>
        <tag>æ–‡çŒ®ç¬”è®°</tag>
        <tag>æœºå™¨å­¦ä¹ å¯è§£é‡Šæ€§</tag>
      </tags>
  </entry>
</search>
