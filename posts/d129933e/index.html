<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="FcfBsHSYhe6V8WyKBbAUGEGJCXyaqgYY8zyol4Zizq8">
  <meta name="msvalidate.01" content="81407BB95B6B10326AFF04EEC297B4F2">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"hjiezero.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.17.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="未写完">
<meta property="og:type" content="article">
<meta property="og:title" content="贝叶斯优化">
<meta property="og:url" content="https://hjiezero.github.io/posts/d129933e/index.html">
<meta property="og:site_name" content="Hjie">
<meta property="og:description" content="未写完">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/06/10/cFwQxP2Doyfldtn.png">
<meta property="og:image" content="https://s2.loli.net/2023/06/10/RE2hpHuvJ5wWGnB.png">
<meta property="og:image" content="https://s2.loli.net/2023/06/10/k8b4stXOKJfA2Ya.png">
<meta property="og:image" content="https://s2.loli.net/2023/06/10/YTiR82Xsz4SHKxh.png">
<meta property="article:published_time" content="2023-06-10T12:07:05.576Z">
<meta property="article:modified_time" content="2023-06-10T13:00:55.551Z">
<meta property="article:author" content="hjie">
<meta property="article:tag" content="机器学习">
<meta property="article:tag" content="优化算法">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/06/10/cFwQxP2Doyfldtn.png">


<link rel="canonical" href="https://hjiezero.github.io/posts/d129933e/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hjiezero.github.io/posts/d129933e/","path":"posts/d129933e/","title":"贝叶斯优化"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>贝叶斯优化 | Hjie</title>
  







<link rel="dns-prefetch" href="waline-hjiezero.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hjie</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a></li><li class="menu-item menu-item-book"><a href="/books" rel="section"><i class="fa fa-book-open fa-fw"></i>book</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%B4%9D%E5%8F%B6%E6%96%AF%E4%BC%98%E5%8C%96"><span class="nav-number">1.</span> <span class="nav-text">贝叶斯优化</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%90%86%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.2.</span> <span class="nav-text">代理模型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2023-06-10-%E5%86%99%E5%88%B0%E8%BF%99%E5%84%BF%E4%BA%86"><span class="nav-number">2.</span> <span class="nav-text">2023.06.10 写到这儿了</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%87%E9%9B%86%E5%87%BD%E6%95%B0"><span class="nav-number">2.1.</span> <span class="nav-text">采集函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81"><span class="nav-number">2.2.</span> <span class="nav-text">代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">2.3.</span> <span class="nav-text">参考</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="hjie"
      src="/images/head.jpg">
  <p class="site-author-name" itemprop="name">hjie</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">15</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/shangxiaaabb" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;shangxiaaabb" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:hjie20011001@gmail.com" title="E-Mail → mailto:hjie20011001@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hjiezero.github.io/posts/d129933e/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.jpg">
      <meta itemprop="name" content="hjie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hjie">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="贝叶斯优化 | Hjie">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          贝叶斯优化
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2023-06-10 20:07:05 / 修改时间：21:00:55" itemprop="dateCreated datePublished" datetime="2023-06-10T20:07:05+08:00">2023-06-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">优化算法</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/posts/d129933e/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/posts/d129933e/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>未写完</p>
<span id="more"></span>

<h1 id="贝叶斯优化"><a href="#贝叶斯优化" class="headerlink" title="贝叶斯优化"></a>贝叶斯优化</h1><p>[toc]</p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>问题一：如果存在函数$y&#x3D;x^2$那么对于这个函数很容易就可以得到他的最小值$x&#x3D;0$时取到最小值，但是如果只告诉我们存在函数$y&#x3D;f(x)$（$f(x)$具体的表达式未知），我们如何找到他的最小值呢？</p>
<p>问题二：对于机器学习、深度学习模型都是由许多参数所决定的（比如说：深度学习中学习率、网络深度等），假如我们通过计算模型的$R^2$来选择我们的参数，那么如何选择参数的值使得$R^2$最大呢？</p>
<p><strong>Grid Search？Random Search？Bayesian optimization？</strong></p>
<blockquote>
<p>超参数优化</p>
<p>百度百科：</p>
<p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%B6%85%E5%8F%82%E6%95%B0/3101858">https://baike.baidu.com/item/%E8%B6%85%E5%8F%82%E6%95%B0/3101858</a></p>
<p>Wiki：</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Hyperparameter_optimization">https://en.wikipedia.org/wiki/Hyperparameter_optimization</a></p>
</blockquote>
<p>本文主要对<strong>Bayesian optimization</strong>进行解释。<strong>贝叶斯优化</strong>通过有限的步骤进行全局优化。定义我们的待优化函数：</p>
<p>$$<br>x^{*}&#x3D;\underset{x\in X}{argmin}f(x)<br>$$</p>
<blockquote>
<p>上式子中：$x$代表<strong>决策向量</strong>（直观理解为：深度学习中的学习率、网络深度等），$X$代表<strong>决策空间</strong>（直观理解为：以学习率为例，假设我们能从学习率集合$\alpha&#x3D;(0.01,0.02,0.03)$[&lt;–这就是决策空间] 选择最佳学习率[&lt;–这就是我们决策向量]，$f$则代表目标函数（比如上面提到的$R^2$或者机器学习模型$f$））</p>
</blockquote>
<p>许多机器学习中的优化问题都是<strong>黑盒优化</strong>问题，我们函数是一个黑盒函数<a target="_blank" rel="noopener" href="http://krasserm.github.io/2018/03/21/bayesian-optimization/">^1</a>。如何通过<strong>贝叶斯优化</strong>实现**(1)<strong>式子呢？贝叶斯优化的两板斧：（1）surrogate model（</strong>代理模型<strong>）；（2）acquisition function（</strong>采集函数**）。贝叶斯优化框架如下<a target="_blank" rel="noopener" href="https://doi.org/10.13328/j.cnki.jos.005607.">^3</a>：</p>
<img data-src="/images/loading/loading.gif" data-original="https://s2.loli.net/2023/06/10/cFwQxP2Doyfldtn.png" alt="202306101452451" style="zoom:80%;">

<p>贝叶斯优化框架应用在一维函数$f(x)&#x3D;(x-0.3)^2+0.2sin(20x)$上3次迭代的示例：</p>
<img data-src="/images/loading/loading.gif" data-original="https://s2.loli.net/2023/06/10/RE2hpHuvJ5wWGnB.png" alt="图一:贝叶斯优化示例" style="zoom:70%;">

<h2 id="代理模型"><a href="#代理模型" class="headerlink" title="代理模型"></a>代理模型</h2><p>上面提及到机器学习是一个黑盒子(black box)，即我们只知道input和output，所以很难确直接定存在什么样的函数关系<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/53826787">^2</a>。既然你的<strong>函数关系</strong>确定不了，那么我们就可以直接找到一个模型对你的函数进行<strong>替代</strong>（代理），这就是贝叶斯优化第一板斧：<strong>代理模型</strong>。（使用概率模型代理原始评估代价高昂的复杂目标函数）</p>
<p>这里主要解释<strong>高斯过程（Gaussian processes，GP）</strong><a target="_blank" rel="noopener" href="https://jgoertler.com/visual-exploration-gaussian-processes/">^4</a></p>
<blockquote>
<p>其他代理模型，感兴趣的可以阅读这篇<a target="_blank" rel="noopener" href="https://doi.org/10.13328/j.cnki.jos.005607">论文</a></p>
<p>WiKi：</p>
<p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B">高斯过程 - 维基百科，自由的百科全书 (wikipedia.org)</a></p>
<p>百度百科：</p>
<p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%AB%98%E6%96%AF%E8%BF%87%E7%A8%8B/4535435?structureClickId=4535435&structureId=56eafc20675c3e28256b410f&structureItemId=a46e4d355312e203fffb9c11">高斯过程_百度百科 (baidu.com)</a></p>
</blockquote>
<blockquote>
<p>解释高斯过程前了解<strong>高斯分布</strong>学过概率论的应该都了解，高斯分布其实就是<strong>正态分布</strong>平时所学的大多为一元正态分布，推广到$n$维的高斯分布：</p>
<p>$$<br>X&#x3D;\begin{bmatrix}X_1\X_2\…\X_n\end{bmatrix}∼N(\mu,\sum)<br>$$</p>
<p>其中$\mu$代表均值，$\sum$代表协方差。</p>
</blockquote>
<p>高斯过程：</p>
<p>$$<br>f(x)∼GP(m(x),k(x,x^{‘}))<br>$$</p>
<p>其中$m(x)$代表均值（为了方便令$m(x)&#x3D;0$），$k$代表协方差。</p>
<blockquote>
<img data-src="/images/loading/loading.gif" data-original="https://s2.loli.net/2023/06/10/k8b4stXOKJfA2Ya.png" alt="202306102048432" style="zoom:60%;">

<p>具有三个观测值的简单一维高斯过程。实线黑线是给定数据的目标函数的GP代理均值预测，阴影区域表示均值加减方差。</p>
<p>Simple 1D Gaussian process with three observations. The solid black line is the GP surrogate mean prediction of the objective function given the data, and the shaded area shows the mean plus and minus the variance. The superimposed Gaussians correspond to the GP mean and standard deviation ($μ(·) $and $σ(·)) $of prediction at the points, $x_{1:3}$.</p>
</blockquote>
<hr>
<h1 id="2023-06-10-写到这儿了"><a href="#2023-06-10-写到这儿了" class="headerlink" title="2023.06.10 写到这儿了"></a>2023.06.10 写到这儿了</h1><h2 id="采集函数"><a href="#采集函数" class="headerlink" title="采集函数"></a>采集函数</h2><p>上一节介绍了<strong>代理模型</strong>，去对我们的函数进行<strong>替代</strong>。如何选择下一个<strong>评估点</strong>，这就是贝叶斯优化第二板斧：<strong>采集函数</strong>。</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>代码参考：<a target="_blank" rel="noopener" href="https://github.com/bayesian-optimization/BayesianOptimization">https://github.com/bayesian-optimization/BayesianOptimization</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bayes_opt <span class="keyword">import</span> BayesianOptimization <span class="comment">#调用第三方库</span></span><br><span class="line"><span class="keyword">from</span> skelarn.svm <span class="keyword">import</span> SVR</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line"></span><br><span class="line"><span class="comment">#交叉验证贝叶斯优化</span></span><br><span class="line">X_train, X_test, Y_train, Y_test= train_test_split(x,y,test_size=<span class="number">0.2</span>,random_state=<span class="number">100</span>)</span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVR</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">svr_cv</span>(<span class="params">C, epsilon, gamma</span>):</span><br><span class="line">    kf = KFold(n_splits=<span class="number">5</span>, shuffle=<span class="literal">True</span>, random_state=<span class="number">100</span>)</span><br><span class="line">    svr = SVR(C=C, epsilon=epsilon, gamma=gamma)</span><br><span class="line">    <span class="keyword">for</span> i, (train_index, test_index) <span class="keyword">in</span> <span class="built_in">enumerate</span>(kf.split(X_train, Y_train.values)):</span><br><span class="line">        svr.fit(X_train[train_index], Y_train.values[train_index])</span><br><span class="line">        pred = svr.predict(X_train[test_index])</span><br><span class="line">        <span class="keyword">return</span> r2_score(pred, Y_train.values[test_index])</span><br><span class="line"></span><br><span class="line">svr_bo = BayesianOptimization(svr_cv,&#123;<span class="string">&#x27;C&#x27;</span>:(<span class="number">1</span>,<span class="number">16</span>), <span class="string">&#x27;epsilon&#x27;</span>:(<span class="number">0</span>,<span class="number">1</span>), <span class="string">&#x27;gamma&#x27;</span>:(<span class="number">0</span>,<span class="number">1</span>)&#125;)</span><br><span class="line"><span class="comment">#输入测试的函数，以及变量的范围</span></span><br><span class="line">svr_bo.maximize()</span><br></pre></td></tr></table></figure>

<img data-src="/images/loading/loading.gif" data-original="https://s2.loli.net/2023/06/10/YTiR82Xsz4SHKxh.png" alt="202306101944250" style="zoom:60%;">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">svr_bo.<span class="built_in">max</span> <span class="comment">#得到最佳参数</span></span><br><span class="line"><span class="comment">#&#123;&#x27;target&#x27;: 0.9875895309185105,</span></span><br><span class="line"><span class="comment"># &#x27;params&#x27;: &#123;&#x27;C&#x27;: 14.595794386042416,</span></span><br><span class="line"><span class="comment">#  &#x27;epsilon&#x27;: 0.09480102745231553,</span></span><br><span class="line"><span class="comment">#  &#x27;gamma&#x27;: 0.09251046201638335&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<p>通过最佳参数进行测试：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">svr1 =  SVR(C=<span class="number">14.595794386042416</span>, epsilon=<span class="number">0.09480102745231553</span>, gamma=<span class="number">0.09251046201638335</span>)</span><br><span class="line">svr1.fit(X_train, Y_train)</span><br><span class="line">r2_score(Y_test.values, svr1.predict(X_test))</span><br><span class="line"><span class="comment">#0.9945825852230629</span></span><br></pre></td></tr></table></figure>

<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>1、<a target="_blank" rel="noopener" href="http://krasserm.github.io/2018/03/21/bayesian-optimization/">http://krasserm.github.io/2018/03/21/bayesian-optimization/</a></p>
<p>2、<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/53826787">https://zhuanlan.zhihu.com/p/53826787</a></p>
<p>3、崔佳旭, 杨博. 贝叶斯优化方法和应用综述[J&#x2F;OL]. 软件学报, 2018, 29(10): 3068-3090. <a target="_blank" rel="noopener" href="https://doi.org/10.13328/j.cnki.jos.005607">https://doi.org/10.13328/j.cnki.jos.005607</a>.</p>
<p>4、<a target="_blank" rel="noopener" href="https://jgoertler.com/visual-exploration-gaussian-processes/">https://jgoertler.com/visual-exploration-gaussian-processes/</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag"># 机器学习</a>
              <a href="/tags/%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95/" rel="tag"># 优化算法</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/5bf8429/" rel="prev" title="机器学习可解释性--SHAP">
                  <i class="fa fa-chevron-left"></i> 机器学习可解释性--SHAP
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">hjie</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/code-unfold.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.2.11/pdfobject.min.js","integrity":"sha256-N6JtCNwaYm6kizuG92UtOOXamRHPwu+V1yF10g3bu/c="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js"></script>



  <script src="/js/third-party/fancybox.js"></script>



  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","cdn":"//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-hjiezero.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"请文明评论","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/posts/d129933e/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>


        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body>
</html>
