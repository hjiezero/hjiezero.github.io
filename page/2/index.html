<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.17.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Hjie">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Hjie">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="hjie">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/2/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hjie</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Hjie</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
    </div>
  </div>
</div>







</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">hjie</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">15</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/1904751086/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hjie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hjie">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hjie">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/1904751086/" class="post-title-link" itemprop="url">sklearn-çº¿æ€§æ¨¡å‹</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2023-06-04 14:13:06" itemprop="dateCreated datePublished" datetime="2023-06-04T14:13:06+08:00">2023-06-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">æœºå™¨å­¦ä¹ </span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/sklearn/" itemprop="url" rel="index"><span itemprop="name">sklearn</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="çº¿æ€§æ¨¡å‹"><a href="#çº¿æ€§æ¨¡å‹" class="headerlink" title="çº¿æ€§æ¨¡å‹"></a>çº¿æ€§æ¨¡å‹</h1><p>çº¿æ€§æ¨¡å‹è¡¨è¾¾å¼ï¼š$\hat{y}(w,x)&#x3D;w_0+w_1x_1+â€¦w_nx_n$ï¼Œå¾…ä¼°è®¡å‚æ•°ï¼š$w_0â€¦..w_n$</p>
<h1 id="1ã€åŸç†"><a href="#1ã€åŸç†" class="headerlink" title="1ã€åŸç†"></a>1ã€åŸç†</h1><h2 id="1-1ã€æœ€å°äºŒä¹˜æ³•"><a href="#1-1ã€æœ€å°äºŒä¹˜æ³•" class="headerlink" title="1.1ã€æœ€å°äºŒä¹˜æ³•"></a>1.1ã€æœ€å°äºŒä¹˜æ³•</h2><p><strong>åŸç†</strong>ï¼šè®¡ç®—ä¼°è®¡å€¼$\hat{y}$ä¸å®é™…å€¼$y$ä¹‹é—´æœ€å°å¹³æ–¹å’Œï¼Œå³æ®‹å·®æœ€å°</p>
<p>$$<br>\text{æ®‹å·®ï¼š}\hat{y}-y\<br>\text{æœ€å°æ®‹å·®å¹³æ–¹å’Œï¼š}min\sum_{i&#x3D;1}^{n}(\hat{y_i}-y_i)^2,å…¶ä¸­\hat{y}&#x3D;wx,wï¼šä¸ºç³»æ•°çŸ©é˜µ<br>$$</p>
<p>æ™®é€šæœ€å°äºŒä¹˜æ³•çš„ç³»æ•°ä¼°è®¡ä¾èµ–äºç‰¹å¾çš„ç‹¬ç«‹æ€§ï¼Œæœ€å°äºŒä¹˜æ³•ä¼°è®¡å€¼å¯¹è§‚å¯Ÿç›®æ ‡çš„éšæœºè¯¯å·®å˜å¾—éå¸¸æ•æ„Ÿï¼Œäº§ç”Ÿè¾ƒå¤§çš„æ–¹å·®ã€‚</p>
<h2 id="1-2ã€å²­å›å½’"><a href="#1-2ã€å²­å›å½’" class="headerlink" title="1.2ã€å²­å›å½’"></a>1.2ã€å²­å›å½’</h2><h3 id="1-2-1-å›å½’å¤„ç†"><a href="#1-2-1-å›å½’å¤„ç†" class="headerlink" title="1.2.1 å›å½’å¤„ç†"></a>1.2.1 å›å½’å¤„ç†</h3><p>å¯¹äºæœ€å°äºŒä¹˜æ³•æ·»åŠ â€œæƒ©ç½šå› å­â€é¿å…æœ€å°äºŒä¹˜æ³•è¿‡æ‹Ÿåˆå‡ºç°ï¼š</p>
<p>$$<br>æœ€å°äºŒä¹˜æ³•ï¼šmin\sum_{i&#x3D;1}^{n}(\hat{y_i}-y_i)^2,å…¶ä¸­\hat{y}&#x3D;wx,wï¼šä¸ºç³»æ•°çŸ©é˜µ\<br>æ·»åŠ â€œæƒ©ç½šå› å­â€ï¼šmin\sum_{i&#x3D;1}^{n}(\hat{y_i}-y_i)^2+\alpha||w||^2,å…¶ä¸­\hat{y}&#x3D;wx,wï¼šä¸ºç³»æ•°çŸ©é˜µ<br>$$</p>
<p>å…¶ä¸­å‚æ•°$\alpha$æ§åˆ¶æ”¶ç¼©ï¼Œæ”¶ç¼©é‡è¶Šå¤§ï¼Œå› æ­¤ç³»æ•°å¯¹å…±çº¿æ€§å˜å¾—è¶Šå¹³ç¨³<br><img src="/images/loading/loading.gif" data-original="/image/%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B/1683273841368.png" alt="1683273841368"></p>
<h3 id="1-2-2-åˆ†ç±»å¤„ç†"><a href="#1-2-2-åˆ†ç±»å¤„ç†" class="headerlink" title="1.2.2 åˆ†ç±»å¤„ç†"></a>1.2.2 åˆ†ç±»å¤„ç†</h3><h1 id="2ã€ä»£ç "><a href="#2ã€ä»£ç " class="headerlink" title="2ã€ä»£ç "></a>2ã€ä»£ç </h1><h2 id="2-1-çº¿æ€§æ¨¡å‹"><a href="#2-1-çº¿æ€§æ¨¡å‹" class="headerlink" title="2.1 çº¿æ€§æ¨¡å‹"></a>2.1 çº¿æ€§æ¨¡å‹</h2><h3 id="2-1-1-ğŸ•çº¿æ€§å›å½’"><a href="#2-1-1-ğŸ•çº¿æ€§å›å½’" class="headerlink" title="2.1.1 ğŸ•çº¿æ€§å›å½’"></a>2.1.1 ğŸ•çº¿æ€§å›å½’</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">form sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br></pre></td></tr></table></figure>

<p><strong>å‚æ•°è§£é‡Šï¼š</strong><br>1ã€fit_intercept:bool, default&#x3D;True</p>
<blockquote>
<p>æ˜¯å¦è®¡ç®—æˆªè·ï¼Œé»˜è®¤ï¼šTrue</p>
</blockquote>
<p>2ã€copy_X:bool, default&#x3D;True</p>
<blockquote>
<p>æ˜¯å¦è¦†ç›–xï¼Œé»˜è®¤ï¼šTrue<br><strong>æ–¹æ³•ï¼š</strong></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LinearRegression().fit(x,y) <span class="comment">#ä½¿ç”¨çº¿æ€§æ‹Ÿåˆå»æ‹Ÿåˆ(x,y)</span></span><br><span class="line">LinearRegression().get_params()<span class="comment">#è·å¾—å‚æ•°</span></span><br><span class="line">LinearRegression().predict()<span class="comment">#é¢„æµ‹</span></span><br><span class="line">LinearRegression().score(X, y, sample_weight=<span class="literal">None</span>)<span class="comment">#è¯„ä»·/å¾—åˆ†</span></span><br><span class="line">LinearRegression().set_params()</span><br></pre></td></tr></table></figure>

<p>$.score()å¾—åˆ°çš„è¯„åˆ†ä¸ºR^2$</p>
<p><strong>æ“ä½œ</strong>ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è®¾y=x1+2x2+3</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾ç½®x,y</span></span><br><span class="line">x = np.array([[<span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">2</span>], [<span class="number">2</span>, <span class="number">2</span>], [<span class="number">2</span>, <span class="number">3</span>]])</span><br><span class="line">y = np.dot(x, np.array([<span class="number">1</span>, <span class="number">2</span>])) + <span class="number">3</span></span><br><span class="line">reg = LinearRegression().fit(x,y1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ¨¡å‹R2ï¼š&#123;&#125;ï¼Œæ¨¡å‹é¢„æµ‹ï¼š&#123;&#125;&quot;</span>.<span class="built_in">format</span>(reg.score(x,y),reg.predict(np.array([[<span class="number">3</span>,<span class="number">3</span>]]))))</span><br><span class="line"><span class="comment">#y=array([ 6,  8,  9, 11])</span></span><br><span class="line">&gt;æ¨¡å‹R2ï¼š-<span class="number">2.846153846153845</span>ï¼Œæ¨¡å‹é¢„æµ‹ï¼š[<span class="number">10.</span>]</span><br></pre></td></tr></table></figure>

<h3 id="2-1-2-ğŸ•å²­å›å½’"><a href="#2-1-2-ğŸ•å²­å›å½’" class="headerlink" title="2.1.2 ğŸ•å²­å›å½’"></a>2.1.2 ğŸ•å²­å›å½’</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> Ridge</span><br></pre></td></tr></table></figure>

<p><strong>å‚æ•°è§£é‡Šï¼š</strong><br>1ã€alpha:{float, ndarray of shape (n_targets,)},default&#x3D;1.0</p>
<blockquote>
<p>æƒ©ç½šå› å­è®¾ç½®ï¼š$\alpha$</p>
</blockquote>
<p>2ã€fit_intercept:bool, default&#x3D;True</p>
<blockquote>
<p>æ˜¯å¦è®¾ç½®æˆªè·</p>
</blockquote>
<p>3ã€copy_X:ool, default&#x3D;True<br>4ã€solver:{â€˜autoâ€™, â€˜svdâ€™, â€˜choleskyâ€™, â€˜lsqrâ€™, â€˜sparse_cgâ€™, â€˜sagâ€™, â€˜sagaâ€™, â€˜lbfgsâ€™}, default&#x3D;â€™autoâ€™</p>
<blockquote>
<p><strong>å‡½æ•°æ±‚è§£å™¨ï¼šç†è§£ä¸ºå‚æ•°çš„æ±‚è§£æ–¹å¼</strong><br>â€œautoâ€æ ¹æ®æ•°æ®ç±»å‹è‡ªåŠ¨é€‰æ‹©æ±‚è§£å™¨ã€‚<br>â€œsvdâ€ä½¿ç”¨ X çš„å¥‡å¼‚å€¼åˆ†è§£æ¥è®¡ç®—å²­ç³»æ•°ã€‚å®ƒæ˜¯æœ€ç¨³å®šçš„æ±‚è§£å™¨ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¥‡å¼‚çŸ©é˜µæ¯”â€œcholeskyâ€æ›´ç¨³å®šï¼Œä½†ä»£ä»·æ˜¯æ›´æ…¢ã€‚<br>â€œcholeskyâ€ä½¿ç”¨æ ‡å‡†çš„ scipy.linalg.solve å‡½æ•°æ¥è·å¾—å°é—­å½¢å¼çš„è§£å†³æ–¹æ¡ˆã€‚<br>â€œsparse_cgâ€ä½¿ç”¨ scipy.sparse.linalg.cg ä¸­çš„å…±è½­æ¢¯åº¦æ±‚è§£å™¨ã€‚ä½œä¸ºè¿­ä»£ç®—æ³•ï¼Œæ­¤æ±‚è§£å™¨æ¯”â€œcholeskyâ€æ›´é€‚åˆå¤§è§„æ¨¡æ•°æ®ï¼ˆå¯ä»¥è®¾ç½® tol å’Œ max_iterï¼‰ã€‚<br>â€œlsqrâ€ä½¿ç”¨ä¸“ç”¨æ­£åˆ™åŒ–æœ€å°äºŒä¹˜ä¾‹ç¨‹ scipy.sparse.linalg.lsqrã€‚å®ƒæ˜¯æœ€å¿«çš„å¹¶ä¸”ä½¿ç”¨è¿­ä»£è¿‡ç¨‹ã€‚<br>â€œsagâ€ä½¿ç”¨éšæœºå¹³å‡æ¢¯åº¦ä¸‹é™ï¼Œâ€œsagaâ€ä½¿ç”¨å…¶æ”¹è¿›çš„æ— åç‰ˆæœ¬ï¼Œåä¸º SAGAã€‚è¿™ä¸¤ç§æ–¹æ³•ä¹Ÿä½¿ç”¨è¿­ä»£è¿‡ç¨‹ï¼Œå¹¶ä¸”å½“ n_samples å’Œ n_features éƒ½å¾ˆå¤§æ—¶é€šå¸¸æ¯”å…¶ä»–æ±‚è§£å™¨æ›´å¿«ã€‚è¯·æ³¨æ„ï¼Œâ€œsagâ€å’Œâ€œsagaâ€å¿«é€Ÿæ”¶æ•›åªèƒ½ä¿è¯å…·æœ‰å¤§è‡´ç›¸åŒæ¯”ä¾‹çš„ç‰¹å¾ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ sklearn.preprocessing ä¸­çš„ç¼©æ”¾å™¨é¢„å¤„ç†æ•°æ®ã€‚<br>â€˜lbfgsâ€™ ä½¿ç”¨åœ¨ scipy.optimize.minimize ä¸­å®ç°çš„L-BFGS-B ç®—æ³•ã€‚å®ƒåªèƒ½åœ¨ positive ä¸º True æ—¶ä½¿ç”¨ã€‚</p>
</blockquote>
<p><strong>æ–¹æ³•</strong>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Ridge().fit(x,y) <span class="comment">#ä½¿ç”¨çº¿æ€§æ‹Ÿåˆå»æ‹Ÿåˆ(x,y)</span></span><br><span class="line">Ridge().get_params()<span class="comment">#è·å¾—å‚æ•°</span></span><br><span class="line">Ridge().predict()<span class="comment">#é¢„æµ‹</span></span><br><span class="line">Ridge().score(X, y, sample_weight=<span class="literal">None</span>)<span class="comment">#è¯„ä»·/å¾—åˆ†</span></span><br><span class="line">Ridge().set_params()</span><br></pre></td></tr></table></figure>

<p><strong>æ“ä½œ</strong>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> Ridge</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.array([[<span class="number">1</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">2</span>], [<span class="number">2</span>, <span class="number">2</span>], [<span class="number">2</span>, <span class="number">3</span>]])</span><br><span class="line">y = np.dot(x, np.array([<span class="number">1</span>, <span class="number">2</span>])) + <span class="number">3</span></span><br><span class="line">rng = Ridge(alpha=<span class="number">0.5</span>).fit(x,y)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/1867073817/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hjie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hjie">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hjie">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/1867073817/" class="post-title-link" itemprop="url">æ·±åº¦å­¦ä¹ â€”â€”pytorchå­¦ä¹ </a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2023-06-04 14:13:05" itemprop="dateCreated datePublished" datetime="2023-06-04T14:13:05+08:00">2023-06-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">æ·±åº¦å­¦ä¹ </span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Pytorchå­¦ä¹ "><a href="#Pytorchå­¦ä¹ " class="headerlink" title="Pytorchå­¦ä¹ "></a>Pytorchå­¦ä¹ </h1><p>[toc]</p>
<h2 id="pytorchåŸºæœ¬æ“ä½œ"><a href="#pytorchåŸºæœ¬æ“ä½œ" class="headerlink" title="pytorchåŸºæœ¬æ“ä½œ"></a>pytorchåŸºæœ¬æ“ä½œ</h2><p>pytorchä½¿ç”¨å‰é¦–å…ˆäº†è§£ä¸€ä¸ªä¸€ä¸ªæ¦‚å¿µï¼šå¼ é‡ã€‚ä¸ªäººè§‰å¾—æ²¡å¿…è¦å»äº†è§£ä»–åˆ°åº•æ˜¯ä¸€ç§ä»€ä¹ˆä¸œè¥¿ï¼Œå¯ä»¥å°†å…¶ä¸æˆ‘ä»¬numpyä¸­æ•°ç»„ä¸€èµ·è¿›è¡Œäº†è§£</p>
<blockquote>
<p>å¼ é‡å¯ä»¥çœ‹ä½œæ˜¯â¼€ä¸ªå¤šç»´æ•°ç»„ã€‚æ ‡é‡å¯ä»¥çœ‹ä½œæ˜¯0ç»´å¼ é‡ï¼Œå‘é‡å¯ä»¥çœ‹ä½œ1ç»´å¼ é‡ï¼ŒçŸ©é˜µå¯ä»¥çœ‹ä½œæ˜¯â¼†ç»´å¼ é‡</p>
</blockquote>
<p>é‚£ä¹ˆæˆ‘ä»¬åç»­ä¹Ÿéƒ½æ˜¯å›´ç»•å¼ é‡è¿›è¡Œå±•å¼€äº†è§£</p>
<h3 id="æ•°æ®æ“ä½œ"><a href="#æ•°æ®æ“ä½œ" class="headerlink" title="æ•°æ®æ“ä½œ"></a>æ•°æ®æ“ä½œ</h3><h4 id="åˆ›å»ºå¼ é‡"><a href="#åˆ›å»ºå¼ é‡" class="headerlink" title="åˆ›å»ºå¼ é‡"></a>åˆ›å»ºå¼ é‡</h4><p><img src="/images/loading/loading.gif" data-original="/pytorch%E5%AD%A6%E4%B9%A0/1680163291680.png" alt="1680163291680"></p>
<blockquote>
<p>æ³¨æ„ä½¿ç”¨pytorchå°±ä¸å¾—ä¸äº†è§£ä¸€å¤§ç‰¹ç‚¹ï¼šåˆ©ç”¨GPUè®¡ç®—ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;a = torch.ones(<span class="number">5</span>,<span class="number">3</span>,device=<span class="string">&#x27;cuda&#x27;</span>,dtype=torch.float64)<span class="comment">#è®¾ç½®ç±»å‹ï¼Œgpu</span></span><br><span class="line">&gt;&gt;a</span><br><span class="line">tensor([[<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>]], device=<span class="string">&#x27;cuda:0&#x27;</span>, dtype=torch.float64)</span><br><span class="line">&gt;&gt;<span class="built_in">print</span>(a.size(),a.shape)</span><br><span class="line">torch.Size([<span class="number">5</span>, <span class="number">3</span>]) torch.Size([<span class="number">5</span>, <span class="number">3</span>])</span><br></pre></td></tr></table></figure>

<h4 id="æ“ä½œ"><a href="#æ“ä½œ" class="headerlink" title="æ“ä½œ"></a>æ“ä½œ</h4><ul>
<li><strong>åŠ æ³•è¿ç®—</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(x+y)</span><br><span class="line"><span class="built_in">print</span>(torch.add(x,y))</span><br><span class="line"><span class="built_in">print</span>(y.add(x))</span><br><span class="line">-&gt;tensor([[<span class="number">0.9841</span>, <span class="number">1.1514</span>, <span class="number">1.0982</span>],</span><br><span class="line">        [<span class="number">0.9974</span>, <span class="number">0.4662</span>, <span class="number">1.5250</span>],</span><br><span class="line">        [<span class="number">0.5120</span>, <span class="number">0.3424</span>, <span class="number">1.6973</span>],</span><br><span class="line">        [<span class="number">1.1808</span>, <span class="number">1.1172</span>, <span class="number">1.6786</span>],</span><br><span class="line">        [<span class="number">1.9113</span>, <span class="number">1.3679</span>, <span class="number">1.3846</span>]])</span><br><span class="line">ä¸‰ä¸ªç»“æœéƒ½ä¸€æ ·</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>ç´¢å¼•</strong><br>ç´¢å¼•å‡ºæ¥çš„ç»“æœä¸åŸæ•°æ®å…±äº«å†…å­˜ï¼Œä¹Ÿå³ä¿®æ”¹â¼€ä¸ªï¼Œå¦â¼€ä¸ªä¼šè·Ÿç€ä¿®æ”¹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">b = x[<span class="number">0</span>:<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line">-&gt;tensor([[<span class="number">0.6847</span>, <span class="number">0.9743</span>, <span class="number">0.9259</span>]])</span><br><span class="line">b +=<span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(x[<span class="number">0</span>,:])</span><br><span class="line">-&gt;tensor([<span class="number">2.6847</span>, <span class="number">2.9743</span>, <span class="number">2.9259</span>])</span><br></pre></td></tr></table></figure>

<p><img src="/images/loading/loading.gif" data-original="/pytorch%E5%AD%A6%E4%B9%A0/1680164219080.png" alt="1680164219080"></p>
</li>
<li><p><strong>æ”¹å˜å½¢çŠ¶</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">c = x.view(<span class="number">15</span>)</span><br><span class="line">c</span><br><span class="line">-&gt;tensor([<span class="number">2.6847</span>, <span class="number">2.9743</span>, <span class="number">2.9259</span>, <span class="number">0.7470</span>, <span class="number">0.2349</span>, <span class="number">0.6642</span>, <span class="number">0.3026</span>, <span class="number">0.1884</span>, <span class="number">0.9414</span>,</span><br><span class="line">        <span class="number">0.4747</span>, <span class="number">0.8469</span>, <span class="number">0.7788</span>, <span class="number">0.9762</span>, <span class="number">0.4373</span>, <span class="number">0.6214</span>])</span><br><span class="line">c +=<span class="number">1</span></span><br><span class="line">x</span><br><span class="line">-&gt;tensor([[<span class="number">3.6847</span>, <span class="number">3.9743</span>, <span class="number">3.9259</span>],</span><br><span class="line">        [<span class="number">1.7470</span>, <span class="number">1.2349</span>, <span class="number">1.6642</span>],</span><br><span class="line">        [<span class="number">1.3026</span>, <span class="number">1.1884</span>, <span class="number">1.9414</span>],</span><br><span class="line">        [<span class="number">1.4747</span>, <span class="number">1.8469</span>, <span class="number">1.7788</span>],</span><br><span class="line">        [<span class="number">1.9762</span>, <span class="number">1.4373</span>, <span class="number">1.6214</span>]])</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨view()å‡½æ•°è¿”å›çš„æ–°tensorä¸æºtensorå…±äº«å†…å­˜ï¼ˆå…¶å®æ˜¯åŒâ¼€ä¸ªtensorï¼‰ï¼Œä¹Ÿå³æ›´æ”¹å…¶ä¸­çš„â¼€ä¸ªï¼Œå¦<br>å¤–â¼€ä¸ªä¹Ÿä¼šè·Ÿç€æ”¹å˜ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³è¿”å›â¼€ä¸ªçœŸæ­£æ–°çš„å‰¯æœ¬ï¼ˆå³ä¸å…±äº«å†…å­˜ï¼‰è¯¥æ€ä¹ˆåŠå‘¢ï¼ŸPytorchè¿˜æä¾›äº†â¼€ä¸ªreshape()å¯ä»¥æ”¹å˜å½¢çŠ¶ï¼Œä½†æ˜¯æ­¤å‡½æ•°å¹¶ä¸èƒ½ä¿è¯è¿”å›çš„æ˜¯å…¶æ‹·â»‰ï¼Œæ‰€ä»¥ä¸æ¨èä½¿â½¤ã€‚æ¨èå…ˆ<br>â½¤ clone åˆ›é€ â¼€ä¸ªå‰¯æœ¬ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">x_clone = x.clone()</span><br><span class="line">x_clone +=<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(x_clone, <span class="string">&#x27;\n&#x27;</span>, x)</span><br><span class="line">-&gt;tensor([[<span class="number">4.6847</span>, <span class="number">4.9743</span>, <span class="number">4.9259</span>],</span><br><span class="line">        [<span class="number">2.7470</span>, <span class="number">2.2349</span>, <span class="number">2.6642</span>],</span><br><span class="line">        [<span class="number">2.3026</span>, <span class="number">2.1884</span>, <span class="number">2.9414</span>],</span><br><span class="line">        [<span class="number">2.4747</span>, <span class="number">2.8469</span>, <span class="number">2.7788</span>],</span><br><span class="line">        [<span class="number">2.9762</span>, <span class="number">2.4373</span>, <span class="number">2.6214</span>]]) </span><br><span class="line"> tensor([[<span class="number">3.6847</span>, <span class="number">3.9743</span>, <span class="number">3.9259</span>],</span><br><span class="line">        [<span class="number">1.7470</span>, <span class="number">1.2349</span>, <span class="number">1.6642</span>],</span><br><span class="line">        [<span class="number">1.3026</span>, <span class="number">1.1884</span>, <span class="number">1.9414</span>],</span><br><span class="line">        [<span class="number">1.4747</span>, <span class="number">1.8469</span>, <span class="number">1.7788</span>],</span><br><span class="line">        [<span class="number">1.9762</span>, <span class="number">1.4373</span>, <span class="number">1.6214</span>]])</span><br></pre></td></tr></table></figure></li>
<li><p><strong>çº¿æ€§ä»£æ•°</strong></p>
<p><img src="/images/loading/loading.gif" data-original="/pytorch%E5%AD%A6%E4%B9%A0/1680164657109.png" alt="1680164657109"></p>
<blockquote>
<p>å®˜æ–¹æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://pytorch.org/docs/stable/tensors.html">torch.Tensor â€” PyTorch 2.0 documentation</a></p>
</blockquote>
</li>
<li><p><strong>å¹¿æ’­æœºåˆ¶</strong><br>çº¿æ€§ä»£æ•°å‘Šè¯‰æˆ‘ä»¬ï¼Œè¦æ˜¯ä¸¤ä¸ªçŸ©é˜µå½¢çŠ¶ä¸åŒæ˜¯ä¸å¯ä»¥ç›´æ¥ç›¸åŠ çš„ï¼Œä½†æ˜¯pytorchçš„å¹¿æ’­æœºåˆ¶å¯ä»¥å®ç°æ­¤ç±»è®¡ç®—ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">x = torch.arange(<span class="number">1</span>, <span class="number">3</span>).view(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line">y = torch.arange(<span class="number">1</span>, <span class="number">4</span>).view(<span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="built_in">print</span>(x + y)</span><br><span class="line">-&gt;tensor([[<span class="number">1</span>, <span class="number">2</span>]])</span><br><span class="line">tensor([[<span class="number">1</span>],</span><br><span class="line">        [<span class="number">2</span>],</span><br><span class="line">        [<span class="number">3</span>]])</span><br><span class="line">tensor([[<span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">        [<span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">5</span>]])</span><br></pre></td></tr></table></figure>

<p>è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œç”±äºxï¼Œyçš„å½¢çŠ¶æ˜¯ä¸ç›¸åŒçš„ï¼Œé€šè¿‡å¹¿æ’­æœºåˆ¶ï¼Œä¼šå°†xè¿›è¡Œæ‹“å±•ï¼Œä¹Ÿå°±æ˜¯å°†xå˜æˆ3x2ï¼Œyå˜æˆ3x2è€Œåå†è¿›è¡Œè®¡ç®—ã€‚</p>
</li>
</ul>
<h3 id="tensorå’Œnumpyç›¸äº’è½¬æ¢"><a href="#tensorå’Œnumpyç›¸äº’è½¬æ¢" class="headerlink" title="tensorå’Œnumpyç›¸äº’è½¬æ¢"></a>tensorå’Œnumpyç›¸äº’è½¬æ¢</h3><p>æˆ‘ä»¬å¾ˆå®¹æ˜“â½¤ numpy() å’Œ from_numpy() å°† Tensor å’ŒNumPyä¸­çš„æ•°ç»„ç›¸äº’è½¬æ¢ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„â¼€<br>ç‚¹æ˜¯ï¼š <strong>è¿™ä¸¤ä¸ªå‡½æ•°æ‰€äº§â½£çš„çš„ Tensor å’ŒNumPyä¸­çš„æ•°ç»„å…±äº«ç›¸åŒçš„å†…å­˜ï¼ˆæ‰€ä»¥ä»–ä»¬ä¹‹é—´çš„è½¬æ¢å¾ˆ<br>å¿«ï¼‰ï¼Œæ”¹å˜å…¶ä¸­â¼€ä¸ªæ—¶å¦â¼€ä¸ªä¹Ÿä¼šæ”¹å˜ï¼ï¼ï¼</strong></p>
<blockquote>
<p>è¿˜æœ‰â¼€ä¸ªå¸¸â½¤çš„å°†NumPyä¸­çš„arrayè½¬æ¢æˆ Tensor çš„â½…æ³•å°±æ˜¯ torch.tensor() , éœ€è¦æ³¨æ„çš„<br>æ˜¯ï¼Œæ­¤â½…æ³•æ€»æ˜¯ä¼šè¿›â¾æ•°æ®æ‹·â»‰ï¼ˆå°±ä¼šæ¶ˆè€—æ›´å¤šçš„æ—¶é—´å’Œç©ºé—´ï¼‰ï¼Œæ‰€ä»¥è¿”å›çš„ Tensor å’ŒåŸæ¥çš„æ•°<br>æ®ä¸å†å…±äº«å†…</p>
</blockquote>
<ul>
<li>numpy()<br>å°†tensorè½¬æ¢ä¸ºnumpyå½¢å¼</li>
<li>torch.from_numpy()<br>å°†numpyè½¬æ¢ä¸ºtensor</li>
</ul>
<h2 id="è‡ªåŠ¨æ±‚æ¢¯åº¦"><a href="#è‡ªåŠ¨æ±‚æ¢¯åº¦" class="headerlink" title="è‡ªåŠ¨æ±‚æ¢¯åº¦"></a>è‡ªåŠ¨æ±‚æ¢¯åº¦</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://pytorch.org/tutorials/beginner/blitz/autograd_tutorial.html#sphx-glr-beginner-blitz-autograd-tutorial-py">A Gentle Introduction to torch.autograd â€” PyTorch Tutorials 2.0.0+cu117 documentation</a></p>
</blockquote>
<p>åœ¨ç”Ÿæˆtensoræ—¶å€™æˆ‘ä»¬æ·»åŠ å±æ€§ (requires_grad&#x3D;True )ï¼Œå®ƒå°†å¼€å§‹è¿½è¸ª(track)åœ¨å…¶ä¸Šçš„æ‰€æœ‰æ“ä½œï¼ˆè¿™æ ·å°±å¯ä»¥åˆ©â½¤é“¾å¼æ³•åˆ™è¿›â¾æ¢¯åº¦ä¼ æ’­äº†ï¼‰ã€‚å®Œæˆè®¡ç®—åï¼Œå¯ä»¥è°ƒâ½¤.backward() æ¥å®Œæˆæ‰€æœ‰æ¢¯åº¦è®¡ç®—ã€‚æ­¤Tensorçš„æ¢¯åº¦å°†ç´¯ç§¯åˆ°.grad å±æ€§ä¸­ã€‚</p>
<p>å¦‚æœä¸æƒ³è¦è¢«ç»§ç»­è¿½è¸ªï¼Œå¯ä»¥è°ƒâ½¤ .detach() å°†å…¶ä»è¿½è¸ªè®°å½•ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œè¿™æ ·å°±å¯ä»¥é˜²â½Œå°†æ¥çš„è®¡ç®—è¢«è¿½è¸ªï¼Œè¿™æ ·æ¢¯åº¦å°±ä¼ ä¸è¿‡å»äº†ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥â½¤ with torch.no_grad() å°†ä¸æƒ³è¢«è¿½è¸ªçš„æ“ä½œä»£ç å—åŒ…è£¹èµ·æ¥ï¼Œè¿™ç§â½…æ³•åœ¨è¯„ä¼°æ¨¡å‹çš„æ—¶å€™å¾ˆå¸¸â½¤ï¼Œå› ä¸ºåœ¨è¯„ä¼°æ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦è®¡ç®—å¯è®­ç»ƒå‚æ•°ï¼ˆrequires_grad&#x3D;Trueï¼‰çš„æ¢¯åº¦ã€‚</p>
<blockquote>
<p>é€šä¿—çš„æ¥è®²å°±æ˜¯æˆ‘ä»¬æ·»åŠ  requires_grad å¯ä»¥è®°å½•åœ¨å¼ é‡ä¸Šæ‰€è¿›è¡Œçš„æ‰€æœ‰çš„æ“ä½œ</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x = torch.ones(<span class="number">2</span>,<span class="number">2</span>,requires_grad=<span class="literal">True</span>)</span><br><span class="line">y = x+ <span class="number">2</span></span><br><span class="line">z = y*y*<span class="number">3</span></span><br><span class="line">p = z.mean()</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line">-&gt;tensor(<span class="number">27.</span>, grad_fn=&lt;MeanBackward0&gt;)</span><br><span class="line">p.backward()</span><br><span class="line"><span class="built_in">print</span>(x.grad)</span><br><span class="line">-&gt;tensor([[<span class="number">4.5000</span>, <span class="number">4.5000</span>],</span><br><span class="line">        [<span class="number">4.5000</span>, <span class="number">4.5000</span>]])</span><br></pre></td></tr></table></figure>

<p>è®¡ç®—ç»“æœæ€ä¹ˆæ¥çš„å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬çŸ¥é“pæ‰€è¿›è¡Œçš„è®¡ç®—å¦‚ä¸‹</p>
<p>$$<br>p&#x3D;\frac{1}{4}\sum3(x_i+2)^2<br>$$</p>
<p>$$<br>\dfrac{\partial p}{\partial x}|_{x_i&#x3D;1}&#x3D;\frac{9}{2}&#x3D;4.5<br>$$</p>
<p>ä¸è¿‡åœ¨æ­¤å¤„éœ€è¦ä¸€ä¸ª<strong>æ³¨æ„äº‹é¡¹</strong>ï¼Œæˆ‘ä»¬çš„på¿…é¡»æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œä¹Ÿå°±æ˜¯è¯´på¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œä¸ç„¶ç»“æœä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">x = torch.tensor([<span class="number">2.</span>, <span class="number">1.</span>], requires_grad=<span class="literal">True</span>)</span><br><span class="line">y = torch.tensor([[<span class="number">1.</span>, <span class="number">2.</span>], [<span class="number">3.</span>, <span class="number">4.</span>]], requires_grad=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">z = torch.mm(x.view(<span class="number">1</span>, <span class="number">2</span>), y)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;z:<span class="subst">&#123;z&#125;</span>&quot;</span>)</span><br><span class="line">z.backward(torch.Tensor([[<span class="number">1.</span>, <span class="number">0</span>]]), retain_graph=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x.grad: <span class="subst">&#123;x.grad&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;y.grad: <span class="subst">&#123;y.grad&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">--&gt;z:tensor([[<span class="number">5.</span>, <span class="number">8.</span>]], grad_fn=&lt;MmBackward&gt;)</span><br><span class="line">x.grad: tensor([[<span class="number">1.</span>, <span class="number">3.</span>]])</span><br><span class="line">y.grad: tensor([[<span class="number">2.</span>, <span class="number">0.</span>],</span><br><span class="line">        [<span class="number">1.</span>, <span class="number">0.</span>]])</span><br></pre></td></tr></table></figure>

<p>ç®—æ³•è§£é‡Šå¦‚ä¸‹ï¼š<br><img src="/images/loading/loading.gif" data-original="/pytorch%E5%AD%A6%E4%B9%A0/1680176521877.png" alt="1680176521877"><br>æˆ‘ä»¬åœ¨å¯¹zè¿›è¡Œæ±‚æ¢¯åº¦çš„æ—¶å€™ï¼ŒæŒ‡å®šäº†å‚æ•°[1,0]ä¹Ÿå°±æ˜¯ç›¸å¯¹äºè¿›è¡Œäº†åŠ æƒæ“ä½œ</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/article/9034837.html">https://www.w3cschool.cn/article/9034837.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39208832/article/details/117415229">https://blog.csdn.net/qq_39208832/article/details/117415229</a></p>
<p><a target="_blank" rel="noopener" href="https://pytorch.org/tutorials/beginner/blitz/autograd_tutorial.html#sphx-glr-beginner-blitz-autograd-tutorial-py">https://pytorch.org/tutorials/beginner/blitz/autograd_tutorial.html#sphx-glr-beginner-blitz-autograd-tutorial-py</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/3220359105/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hjie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hjie">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hjie">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/3220359105/" class="post-title-link" itemprop="url">pytorchå®ç°CNN</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2023-06-04 14:13:05" itemprop="dateCreated datePublished" datetime="2023-06-04T14:13:05+08:00">2023-06-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">æ·±åº¦å­¦ä¹ </span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="pytorchå®ç°CNN"><a href="#pytorchå®ç°CNN" class="headerlink" title="pytorchå®ç°CNN"></a>pytorchå®ç°CNN</h1><p>nn.Conv2d<br>torch.nn.Conv2d(in_channels, out_channels, kernel_size, stride&#x3D;1, padding&#x3D;0, dilation&#x3D;1, groups&#x3D;1, bias&#x3D;True, padding_mode&#x3D;â€™zerosâ€™, device&#x3D;None, dtype&#x3D;None)<br><strong>å‚æ•°è§£é‡Š</strong><br>1ã€in_channels (int) â€“ è¾“å…¥å›¾åƒä¸­çš„é€šé“æ•°<br>2ã€out_channels (int) â€“ å·ç§¯äº§ç”Ÿçš„é€šé“æ•°<br>3ã€kernel_size (int or tuple) â€“ å·ç§¯æ ¸çš„å¤§å°<br>4ã€stride (int or tuple, optional) â€“ å·ç§¯çš„æ­¥å¹…ï¼Œé»˜è®¤å€¼ï¼š1<br>5ã€padding (int, tuple or str, optional) â€“ æ·»åŠ åˆ°è¾“å…¥çš„æ‰€æœ‰å››ä¸ªè¾¹çš„å¡«å……ï¼Œé»˜è®¤å€¼ï¼š0<br>6ã€padding_mode (str, optional) â€“ â€˜zerosâ€™, â€˜reflectâ€™, â€˜replicateâ€™ or â€˜circularâ€™ï¼Œé»˜è®¤: â€˜zerosâ€™<br>6ã€dilation (int or tuple, optional) â€“ å†…æ ¸å…ƒç´ ä¹‹é—´çš„é—´è·ï¼Œé»˜è®¤å€¼ï¼š1<br>7ã€groups (int, optional) â€“ ä»è¾“å…¥é€šé“åˆ°è¾“å‡ºé€šé“çš„é˜»å¡è¿æ¥æ•°ï¼Œé»˜è®¤å€¼ï¼š1<br>8ã€bias (bool, optional) â€“ å¦‚æœæ˜¯ â€œçœŸâ€ï¼Œåˆ™åœ¨è¾“å‡ºä¸­å¢åŠ ä¸€ä¸ªå¯å­¦ä¹ çš„åç½®ï¼Œé»˜è®¤å€¼ï¼š çœŸ  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"></span><br><span class="line">torch.set_printoptions(edgeitems=<span class="number">2</span>)</span><br><span class="line">torch.manual_seed(<span class="number">123</span>)</span><br><span class="line">class_names = [<span class="string">&#x27;airplane&#x27;</span>,<span class="string">&#x27;automobile&#x27;</span>,<span class="string">&#x27;bird&#x27;</span>,<span class="string">&#x27;cat&#x27;</span>,<span class="string">&#x27;deer&#x27;</span>,<span class="string">&#x27;dog&#x27;</span>,<span class="string">&#x27;frog&#x27;</span>,<span class="string">&#x27;horse&#x27;</span>,<span class="string">&#x27;ship&#x27;</span>,<span class="string">&#x27;truck&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¸‹è½½æ•°æ®</span></span><br><span class="line"><span class="keyword">from</span> torchvision <span class="keyword">import</span> datasets, transforms</span><br><span class="line">data_path = <span class="string">&#x27;E:/CIFAR-10/&#x27;</span> </span><br><span class="line">cifar10 = datasets.CIFAR10(</span><br><span class="line">    data_path, train=<span class="literal">True</span>, download=<span class="literal">True</span>,</span><br><span class="line">    transform=transforms.Compose([</span><br><span class="line">        transforms.ToTensor(),</span><br><span class="line">        transforms.Normalize((<span class="number">0.4915</span>, <span class="number">0.4823</span>, <span class="number">0.4468</span>),</span><br><span class="line">                             (<span class="number">0.2470</span>, <span class="number">0.2435</span>, <span class="number">0.2616</span>))</span><br><span class="line">    ]))</span><br><span class="line">cifar10_val = datasets.CIFAR10(</span><br><span class="line">    data_path, train=<span class="literal">False</span>, download=<span class="literal">True</span>,</span><br><span class="line">    transform=transforms.Compose([</span><br><span class="line">        transforms.ToTensor(),</span><br><span class="line">        transforms.Normalize((<span class="number">0.4915</span>, <span class="number">0.4823</span>, <span class="number">0.4468</span>),</span><br><span class="line">                             (<span class="number">0.2470</span>, <span class="number">0.2435</span>, <span class="number">0.2616</span>))</span><br><span class="line">    ]))</span><br><span class="line"><span class="comment">#è¯†åˆ«é¸Ÿå’Œé£æœº</span></span><br><span class="line">label_map = &#123;<span class="number">0</span>: <span class="number">0</span>, <span class="number">2</span>: <span class="number">1</span>&#125;</span><br><span class="line">class_names = [<span class="string">&#x27;airplane&#x27;</span>, <span class="string">&#x27;bird&#x27;</span>]</span><br><span class="line">cifar2 = [(img, label_map[label]) <span class="keyword">for</span> img, label <span class="keyword">in</span> cifar10 <span class="keyword">if</span> label <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">2</span>]]</span><br><span class="line">cifar2_val = [(img, label_map[label]) <span class="keyword">for</span> img, label <span class="keyword">in</span> cifar10_val <span class="keyword">if</span> label <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">2</span>]]</span><br><span class="line"><span class="comment">#å®šä¹‰ç¥ç»ç½‘ç»œæ¨¡å‹</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Net</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.conv1 = nn.Conv2d(<span class="number">3</span>, <span class="number">16</span>, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>)</span><br><span class="line">        self.act1 = nn.Tanh()</span><br><span class="line">        self.pool1 = nn.MaxPool2d(<span class="number">2</span>)</span><br><span class="line">        self.conv2 = nn.Conv2d(<span class="number">16</span>, <span class="number">8</span>, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>)</span><br><span class="line">        self.act2 = nn.Tanh()</span><br><span class="line">        self.pool2 = nn.MaxPool2d(<span class="number">2</span>)</span><br><span class="line">        self.fc1 = nn.Linear(<span class="number">8</span> * <span class="number">8</span> * <span class="number">8</span>, <span class="number">32</span>)</span><br><span class="line">        self.act3 = nn.Tanh()</span><br><span class="line">        self.fc2 = nn.Linear(<span class="number">32</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        out = self.pool1(self.act1(self.conv1(x)))</span><br><span class="line">        out = self.pool2(self.act2(self.conv2(out)))</span><br><span class="line">        out = out.view(-<span class="number">1</span>, <span class="number">8</span> * <span class="number">8</span> * <span class="number">8</span>)</span><br><span class="line">        out = self.act3(self.fc1(out))</span><br><span class="line">        out = self.fc2(out)</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> datetime  </span><br><span class="line"><span class="comment">#å®šä¹‰æŸå¤±å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">training_loop</span>(<span class="params">n_epochs, optimizer, model, loss_fn, train_loader</span>):</span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n_epochs + <span class="number">1</span>): </span><br><span class="line">        loss_train = <span class="number">0.0</span></span><br><span class="line">        <span class="keyword">for</span> imgs, labels <span class="keyword">in</span> train_loader:</span><br><span class="line">            <span class="comment">#åˆ©ç”¨GPUè®¡ç®—</span></span><br><span class="line">            imgs = imgs.to(<span class="string">&quot;cuda:0&quot;</span>)</span><br><span class="line">            labels = labels.to(<span class="string">&quot;cuda:0&quot;</span>)</span><br><span class="line">            <span class="comment">#è®¡ç®—æŸå¤±å‡½æ•°</span></span><br><span class="line">            outputs = model(imgs)</span><br><span class="line">            loss = loss_fn(outputs, labels)</span><br><span class="line">            <span class="comment">#éšæœºæ¢¯åº¦ä¸‹é™æ›´æ–°å‚æ•°</span></span><br><span class="line">            optimizer.zero_grad()</span><br><span class="line">            loss.backward()</span><br><span class="line">            optimizer.step()</span><br><span class="line">            loss_train += loss.item()</span><br><span class="line">        <span class="keyword">if</span> epoch == <span class="number">1</span> <span class="keyword">or</span> epoch % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;&#123;&#125; Epoch &#123;&#125;, è®­ç»ƒæŸå¤±&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(datetime.datetime.now(), epoch,</span><br><span class="line">                loss_train / <span class="built_in">len</span>(train_loader))) </span><br></pre></td></tr></table></figure>

<p>è¿è¡Œ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">train_loader = torch.utils.data.DataLoader(cifar2, batch_size=<span class="number">64</span>,</span><br><span class="line">                                           shuffle=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">model = Net()</span><br><span class="line">model = model.to(<span class="string">&quot;cuda:0&quot;</span>)</span><br><span class="line">optimizer = optim.SGD(model.parameters(), lr=<span class="number">1e-2</span>)</span><br><span class="line">loss_fn = nn.CrossEntropyLoss()</span><br><span class="line"></span><br><span class="line">training_loop(</span><br><span class="line">    n_epochs = <span class="number">100</span>,</span><br><span class="line">    optimizer = optimizer,</span><br><span class="line">    model = model,</span><br><span class="line">    loss_fn = loss_fn,</span><br><span class="line">    train_loader = train_loader,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/1497842915/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hjie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hjie">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hjie">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/1497842915/" class="post-title-link" itemprop="url">å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2023-06-04 14:13:04" itemprop="dateCreated datePublished" datetime="2023-06-04T14:13:04+08:00">2023-06-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">æ·±åº¦å­¦ä¹ </span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰"><a href="#å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰" class="headerlink" title="å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰"></a>å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼‰</h1><blockquote>
<p><strong>æœ¬æ–‡ç« åŸºäº3Blue1Brownè§†é¢‘å¹¶ä¸”ç»“åˆè‡ªå·±å­¦ä¹ æ€»ç»“çš„ç¬”è®°</strong></p>
</blockquote>
<blockquote>
<p>è§†é¢‘é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=aircAruvnKk">https://www.youtube.com/watch?v=aircAruvnKk</a></p>
</blockquote>
<blockquote>
<p>æœ¬æ–‡åªèƒ½å¸®ä½ å¿«é€Ÿå»ºç«‹å¯¹çŸ¥è¯†ç†è§£ï¼Œå¦‚æœæƒ³ç»†å…¥äº†è§£çŸ¥è¯†â€”â€”è‡ªå·±æŸ¥é˜…æ–‡çŒ®ä»¥åŠä¹¦ç±</p>
<ul>
<li>è‡ªå·±ä¹Ÿåœ¨å­¦ä¹ æ·±åº¦å­¦ä¹ ï¼ˆèŠ±ä¹¦ï¼‰ï¼Œä¼šä¸æ–­æ›´æ–°æ­¤æ–‡ç« ï¼Œå°½å¯èƒ½çš„è®©è¿™ç¯‡æ–‡ç« å®Œç¾</li>
</ul>
</blockquote>
<h2 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h2><p>ä»¥<strong>æ‰‹å†™å­—ä½“è¯†åˆ«ä¸ºä¾‹</strong>ï¼Œæˆ‘ä»¬äººç±»å¯ä»¥å¾ˆå®¹æ˜“å¯¹ä¸€ä¸ªæ‰‹å†™å­—ä½“è¿›è¡Œè¯†åˆ«æ¯”å¦‚ä¸‹å›¾ï¼š<br><img src="/images/loading/loading.gif" data-original="/MLP(%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA)/1680678137054.png" alt="1680678137054"><br>æˆ‘ä»¬å¯ä»¥ååˆ†è‡ªä¿¡çš„è¯´ï¼šè¿™ä¸ªæ•°å­—æ˜¯3ï¼ä½†æ˜¯å¯¹äºè®¡ç®—æœºå¹¶éå¦‚æ­¤ï¼è®¡ç®—æœºå¹¶æ²¡æœ‰å¦‚åŒäººç±»ä¸€æ ·çš„è§†è§‰ç»†èƒï¼Œé‚£ä¹ˆæ€ä¹ˆè®©è®¡ç®—æœºè®¤è¯†è¿™æ•°å­—å‘¢ï¼Ÿæˆ‘ä»¬åœ¨<strong>Kè¿‘é‚»ç®—æ³•</strong>ä¸­æœ‰ä¸€ä¸ªæ‰‹å†™å­—ä½“è¯†åˆ«å®éªŒï¼Œæˆ‘ä»¬æ˜¯ç›´æ¥å°†æ•°å­—<strong>è¿›è¡Œ2å€¼åŒ–</strong></p>
<blockquote>
<p>å°†æ•°å­—è½¬åŒ–ä¸º0-1ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="/images/loading/loading.gif" data-original="/MLP(%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA)/1680678374250.png" alt="1680678374250"></p>
</blockquote>
<p>ç„¶åå°†32x32çš„å›¾åƒç›´æ¥è½¬åŒ–ä¸º1x1024ï¼Œè€Œååˆ©ç”¨Kè¿‘é‚»ç®—æ³•è¿›è¡Œåˆ¤åˆ«ã€‚è¿™ä¸å¦¨æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åŠæ³•ï¼Œä¸è¿‡åœ¨æ•°æ®é‡ååˆ†å¤§çš„æ—¶å€™ï¼Œè®¡ç®—ä¼šç‰¹åˆ«æ…¢ï¼Œå¦å¤–ä¸€ç§åŠæ³•ç›´æ¥å°†æ•°å­—è½¬åŒ–ä¸ºä¸åŒçš„<strong>ç°åº¦å€¼çŸ©é˜µ</strong>ï¼Œå¦‚ä¸‹ï¼š<img src="/images/loading/loading.gif" data-original="/MLP(%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA)/1680679926805.png" alt="1680679926805"></p>
<p>æˆ‘ä»¬åç»­ä»‹ç»å¤šå±‚æ„ŸçŸ¥æœºä¹Ÿæ˜¯ç°åº¦å€¼å˜æ¢åå›¾åƒè¿›è¡Œåˆ¤åˆ«ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯å¤šå±‚æ„ŸçŸ¥æœº"><a href="#ä»€ä¹ˆæ˜¯å¤šå±‚æ„ŸçŸ¥æœº" class="headerlink" title="ä»€ä¹ˆæ˜¯å¤šå±‚æ„ŸçŸ¥æœº"></a>ä»€ä¹ˆæ˜¯å¤šå±‚æ„ŸçŸ¥æœº</h2><p>åœ¨ä»‹ç»å¤šå±‚æ„ŸçŸ¥æœºå‰ï¼ˆä¸è§£é‡Šå®šä¹‰ä¹‹ç±»çš„ï¼Œéƒ½å¯ä»¥è‡ªè¡Œç™¾åº¦ï¼‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£<strong>å•å±‚ç¥ç»ç½‘ç»œ</strong>çš„åŸºæœ¬ç»“æ„ï¼Œ<strong>å•å±‚ç¥ç»ç½‘ç»œ</strong>ä¸€èˆ¬ç”±ï¼šè¾“å…¥å±‚ã€è¾“å‡ºå±‚æ„æˆã€‚å¦‚ä¸‹ï¼š</p>
<p><img src="/images/loading/loading.gif" data-original="/MLP(%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA)/1680679100906.png" alt="1680679100906"></p>
<p>å…ˆæš‚æ—¶ä¸è§£é‡Šå„ä¸ªå±‚çš„ä½œç”¨ï¼Œæˆ‘ä»¬ç»§ç»­ä»‹ç»<strong>å¤šå±‚æ„ŸçŸ¥æœº</strong>ï¼š</p>
<p><img src="/images/loading/loading.gif" data-original="/MLP(%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA)/1680679187931.png" alt="1680679187931"></p>
<p>å¯¹æ¯”ä¸¤å›¾æœ€æ˜æ˜¾çš„åŒºåˆ«å°±æ˜¯<strong>å¤šå±‚æ„ŸçŸ¥æœº</strong>ç›¸è¾ƒäº<strong>å•å±‚ç¥ç»ç½‘ç»œ</strong>é¢å¤–çš„å¤šäº†ä¸€ä¸ª<strong>éšè—å±‚</strong>ã€‚æ˜¯ä¸æ˜¯è¯¥è§£é‡Šä¸€ä¸‹1æ¯ä¸€å±‚çš„ä½œç”¨äº†å‘¢ï¼Ÿä¸ï¼ï¼ˆç›´æ¥å¯¹æ¦‚å¿µä¸‹å®šä¹‰æ˜¯å¾ˆéš¾ç†è§£çš„ï¼‰æˆ‘ä»¬å€ŸåŠ©æˆ‘ä»¬å¼•å…¥çš„ä¾‹å­æ¥å¯¹æ²¡ä¸€å±‚è¿›è¡Œè§£é‡Šã€‚æˆ‘ä»¬è®¾è®¡ä¸€ä¸ªå¤šå±‚æ„ŸçŸ¥æœºæ¨¡å‹å¦‚ä¸‹ï¼ˆä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡åç»­è§£é‡Šï¼Œä»å·¦è‡³å³ï¼š<strong>è¾“å…¥å±‚ï¼ˆ784ï¼‰â€“&gt;éšè—å±‚ï¼ˆnï¼‰â€“&gt;éšè—å±‚ï¼ˆnï¼‰â€“&gt;è¾“å‡ºå±‚ï¼ˆ10ï¼‰</strong>ï¼‰ï¼š</p>
<ul>
<li><strong>æ‹¬å·é‡Œé¢æ•°å­—ä»£è¡¨å±‚çš„æ•°ç›®</strong></li>
</ul>
<p><img src="/images/loading/loading.gif" data-original="/MLP(%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA)/1680679616132.png" alt="1680679616132"></p>
<p>å¼•å…¥ä¸­æˆ‘ä»¬å·²ç»æåˆ°æ‰‹å†™æ•°å­—å·²ç»è¢«æˆ‘ä»¬è½¬åŒ–ä¸ºä¸€ä¸ª<strong>28x28çš„ç°åº¦å€¼çŸ©é˜µ</strong>ï¼Œä¸‹é¢å¼€å§‹è§£é‡Šæ¯ä¸€å±‚éƒ½åœ¨å¹²äº›ä»€ä¹ˆäº‹æƒ…ï¼</p>
<hr>
<p><strong>è¾“å…¥å±‚</strong></p>
<p>æˆ‘ä»¬çŸ¥é“æ•°å­—å·²ç»è½¬åŒ–ä¸ºäº†ä¸€ä¸ª28x28çš„ç°åº¦å€¼çŸ©é˜µï¼Œæˆ‘ä»¬ç±»ä¼¼Kè¿‘é‚»ç®—æ³•å°†å…¶å†æ¬¡è½¬ä¸ºä¸º1x784çš„çŸ©é˜µï¼Œæˆ‘ä»¬å°†çŸ©é˜µä¸­çš„æ¯ä¸€ä¸ªæ•°å­—ï¼ˆç°åº¦å€¼ï¼‰ä½œä¸ºæˆ‘ä»¬çš„<strong>ç¥ç»å…ƒ</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ‹¥æœ‰784ä¸ªç¥ç»å…ƒï¼ˆä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆè¦è®¾è®¡è¾“å…¥å±‚çš„æ•°ç›®ä¸º784ï¼‰ã€‚</p>
<hr>
<p><strong>è¾“å‡ºå±‚</strong></p>
<p>æˆ‘ä»¬çŸ¥é“é˜¿æ‹‰ä¼¯æ•°å­—åªæœ‰0-9ï¼ˆåˆ«æŠ¬æ è¯´10ï¼Œéš¾é“ä¸æ˜¯ç”±0-1æ„æˆï¼‰ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯æˆ‘ä»¬æ•°æ®åœ¨ç»è¿‡å¤„ç†ä¹‹åè¿”å›çš„ç»“æœä¹Ÿåº”è¯¥æ˜¯0-9ï¼Œè¿™0-9ä¹Ÿå°±æ„æˆäº†æˆ‘ä»¬çš„è¾“å‡ºå±‚ï¼ˆä¹Ÿå°±è§£é‡Šäº†è¾“å‡ºå±‚ä¸ºä»€ä¹ˆæ˜¯10ï¼‰</p>
<hr>
<p><strong>éšè—å±‚</strong></p>
<p>è‡³äºéšè—å±‚ä¸ºä»€ä¹ˆè®¾è®¡ä¸¤å±‚ï¼Œè€Œä¸”æ¯å±‚çš„æ•°ç›®æ˜¯nã€‚å…¶å®å¾ˆå®¹æ˜“è§£é‡Šï¼Œé¦–å…ˆä½ ä¸å¦¨åœ¨çº¸ä¸Šå†™ä»»æ„å‡ ä¸ªæ•°å­—ï¼ˆå‡å¦‚ä½ å†™çš„æ˜¯æ•°å­—9ï¼‰ï¼Œæ‰‹å†™æ•°å­—9æ˜¯ä¸æ˜¯å¤§ä½“ä¸Šå¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š9çš„å¤´éƒ¨çš„åœ†ã€9çš„å°¾éƒ¨çš„ç«–çº¿ã€‚ä¾æ¬¡ç±»æ¨ä»»æ„æ•°å­—æˆ‘ä»¬éƒ½å¯ä»¥æ‰åˆ†æˆå‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼ˆå°½ç®¡ç”±ç›¸ä¼¼ä½†æ˜¯ä¸å½±å“æˆ‘ä»¬å¯¹æ•°å­—è¯†åˆ«ï¼‰ã€‚å¥½å•¦å‡è®¾æˆ‘ä»¬å·²ç»å¯¹æ•°å­—åˆ’åˆ†å®Œæ¯•ï¼Œå·²ç»åˆ’åˆ†è‹¥å¹²ç»„æˆæˆåˆ†â€”â€”æˆ‘ä»¬ä¹Ÿå°±æ„æˆäº†æˆ‘ä»¬<strong>ç¬¬äºŒå±‚éšè—å±‚</strong>ï¼Œä¾æ¬¡ç±»æ¨æ˜¯ä¸æ˜¯è¿˜å¯ä»¥ç»§ç»­ç»†åˆ†å‘¢ï¼Ÿ9çš„å¤´éƒ¨çš„åœ†ï¼ˆoï¼‰æ˜¯ä¸æ˜¯å¯ä»¥ç»†åˆ†å…¶ä»–æ ·å¼å‘¢ï¼Ÿâ€”â€”<strong>ç¬¬ä¸€å±‚éšè—å±‚</strong>ã€‚</p>
<hr>
<p>è§£é‡Šå®Œå„ä¸ªå±‚éƒ½åœ¨å¹²å˜›ï¼Œä½ ä¹Ÿæ²¡è§£é‡Šæˆ‘ä»¬æ€ä¹ˆè¯†åˆ«æ•°å­—å‘€ï¼åˆ«æ€¥ï¼æ¥ä¸‹æ¥å°±è§£é‡Šï¼æˆ‘ä»¬å‡è®¾æˆ‘ä»¬åœ¨<strong>ç¬¬äºŒå±‚éšè—å±‚</strong>å¾—åˆ°äº†ä¸€ä¸ªåœˆå’Œä¸€ä¸ªç«–çº¿é€šè¿‡ç»„åˆæ˜¯ä¸æ˜¯å¯ä»¥å¾—åˆ°æ•°å­—9ï¼Ÿä¸ºä»€ä¹ˆä¸æ˜¯æ•°å­—6å‘¢ï¼Ÿæˆ‘ä»¬å‡è®¾ç¬¬äºŒæ¬¡éšè—å±‚çš„æ•°ç›®æ˜¯$a_1â€¦..a_nï¼ˆæ¯ä¸€ä¸ªa_iä»£è¡¨ä¸åŒæ•°å­—ç»„æˆéƒ¨åˆ†ï¼‰$ï¼Œç»†å¿ƒçš„ä½ è‚¯å®šå·²ç»å‘ç°äº†ä¸åŒå±‚ä¹‹é—´æœ‰ç€è®¸å¤š<strong>çº¿è¿›è¡Œè¿æ¥</strong>ï¼Œä»–ä»¬æ˜¯å¹²å˜›çš„å‘¢ï¼Ÿ<strong>æƒé‡</strong>ï¼Œæ­£æ˜¯å› ä¸ºè¿™äº›æƒé‡æ‰èƒ½ä¿è¯æˆ‘ä»¬å¯ä»¥è¯†åˆ«æ•°å­—æ˜¯9è€Œä¸æ˜¯6ã€‚ä»¥æ­¤ç±»æ¨ç¬¬ä¸€åœºéšè—å±‚ä¹Ÿå¦‚æ­¤ï¼</p>
<p>ä»¥ä¸Šéƒ½æ˜¯ä¸€äº›å£è¯­åŒ–è§£é‡Šå¹¶æ²¡æœ‰æ¶‰åŠè¿‡å¤šçš„ä¸“ä¸šåè¯ï¼Œä¸‹é¢å¼€å§‹è§£é‡Šä¸€äº›ç†è®ºä¸Šçš„å†…å®¹ï¼</p>
<h2 id="æ¿€æ´»å‡½æ•°"><a href="#æ¿€æ´»å‡½æ•°" class="headerlink" title="æ¿€æ´»å‡½æ•°"></a>æ¿€æ´»å‡½æ•°</h2><p>æ¿€æ´»å‡½æ•°åˆ¤åˆ«æ¥ç¡®å®šç¥ç»å…ƒæ˜¯å¦åº”è¯¥è¢«æ¿€æ´»ï¼Œå¸¸è§ä¸‰ç±»æ¿€æ´»å‡½æ•°å¦‚ä¸‹ï¼š</p>
<h3 id="sigmoidå‡½æ•°"><a href="#sigmoidå‡½æ•°" class="headerlink" title="sigmoidå‡½æ•°"></a>sigmoidå‡½æ•°</h3><p>$$<br>sigmoid(x)&#x3D;\frac{1}{1+exp(-z)}<br>$$</p>
<p>$$<br>z&#x3D;w_1a_1â€¦â€¦w_na_n+b_0<br>$$</p>
<p>$b_0$ä»£è¡¨åç½®ï¼Œç”¨äºåˆ¤åˆ«æ¿€æ´»å‡½æ•°ä¸ºå¤šå°‘æƒ…å†µä¸‹ç¥ç»å…ƒæ˜¯å¦è¢«æ¿€æ´»<br>å‡½æ•°å›¾åƒå¦‚ä¸‹ï¼š<br><img src="/images/loading/loading.gif" data-original="/MLP(%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA)/1680682161756.png" alt="1680682161756"></p>
<h3 id="Reluå‡½æ•°"><a href="#Reluå‡½æ•°" class="headerlink" title="Reluå‡½æ•°"></a>Reluå‡½æ•°</h3><p>$$<br>Relu(z)&#x3D;max(x,0)<br>$$</p>
<p>å‡½æ•°å›¾åƒå¦‚ä¸‹ï¼š<br><img src="/images/loading/loading.gif" data-original="/MLP(%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA)/1680682133055.png" alt="1680682133055"></p>
<p>æ‰€æœ‰å°äº0çš„æ•°å­—éƒ½å¤„ç†ä¸º0</p>
<h3 id="tanhå‡½æ•°"><a href="#tanhå‡½æ•°" class="headerlink" title="tanhå‡½æ•°"></a>tanhå‡½æ•°</h3><p>$$<br>tanh(z)&#x3D;\frac{1+exp(-2z)}{1+exp(-2z)}<br>$$</p>
<p>å‡½æ•°å›¾åƒå¦‚ä¸‹ï¼š<br><img src="/images/loading/loading.gif" data-original="/MLP(%E5%A4%9A%E5%B1%82%E6%84%9F%E7%9F%A5%E6%9C%BA)/1680682185279.png" alt="1680682185279"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/posts/16107/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hjie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hjie">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hjie">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/posts/16107/" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2023-06-04 14:10:39" itemprop="dateCreated datePublished" datetime="2023-06-04T14:10:39+08:00">2023-06-04</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="ä¸Šä¸€é¡µ" aria-label="ä¸Šä¸€é¡µ" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">hjie</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  






        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body>
</html>
